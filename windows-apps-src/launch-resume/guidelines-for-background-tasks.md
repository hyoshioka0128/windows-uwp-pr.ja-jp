---
title: バックグラウンド タスクのガイドライン
description: アプリがバックグラウンド タスクを実行するための要件を満たしていることを確認します。
ms.assetid: 18FF1104-1F73-47E1-9C7B-E2AA036C18ED
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10、uwp、バック グラウンド タスク
ms.localizationpriority: medium
ms.openlocfilehash: 31c0c272ae8ef2818ff1f26dc15dfb803c93e30b
ms.sourcegitcommit: ac7f3422f8d83618f9b6b5615a37f8e5c115b3c4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/29/2019
ms.locfileid: "66360916"
---
# <a name="guidelines-for-background-tasks"></a><span data-ttu-id="67ea6-104">バックグラウンド タスクのガイドライン</span><span class="sxs-lookup"><span data-stu-id="67ea6-104">Guidelines for background tasks</span></span>


<span data-ttu-id="67ea6-105">アプリがバックグラウンド タスクを実行するための要件を満たしていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-105">Ensure your app meets the requirements for running background tasks.</span></span>

## <a name="background-task-guidance"></a><span data-ttu-id="67ea6-106">バックグラウンド タスクのガイダンス</span><span class="sxs-lookup"><span data-stu-id="67ea6-106">Background task guidance</span></span>

<span data-ttu-id="67ea6-107">バックグラウンド タスクの開発時とアプリの公開前に、次のガイダンスについて検討します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-107">Consider the following guidance when developing your background task, and before publishing your app.</span></span>

<span data-ttu-id="67ea6-108">バックグラウンド タスクを使ってバックグラウンドでメディアを再生する場合、Windows 10 バージョン 1607 で簡単に行うことができる機能強化について、「[バックグラウンドでのメディアの再生](https://docs.microsoft.com/windows/uwp/audio-video-camera/background-audio)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-108">If you use a background task to play media in the background, see [Play media in the background](https://docs.microsoft.com/windows/uwp/audio-video-camera/background-audio) for information about improvements in Windows 10, version 1607, that make it much easier.</span></span>

<span data-ttu-id="67ea6-109">**プロセス内とプロセス外のバック グラウンド タスク。** Windows 10 version 1607 で導入された[プロセス内のバック グラウンド タスク](create-and-register-an-inproc-background-task.md)フォア グラウンド アプリと同じプロセス内でバック グラウンドのコードを実行できます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-109">**In-process versus out-of-process background tasks:** Windows 10, version 1607, introduced [in-process background tasks](create-and-register-an-inproc-background-task.md) which allows you to run background code in the same process as your foreground app.</span></span> <span data-ttu-id="67ea6-110">インプロセス バックグラウンド タスクとアウトプロセス バックグラウンド タスクのどちらを使用するかを決定するときは、以下の事項を検討してください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-110">Consider the following factors when deciding whether to have in-process vs. out-of-process background tasks:</span></span>

|<span data-ttu-id="67ea6-111">考慮事項</span><span class="sxs-lookup"><span data-stu-id="67ea6-111">Consideration</span></span> | <span data-ttu-id="67ea6-112">影響</span><span class="sxs-lookup"><span data-stu-id="67ea6-112">Impact</span></span> |
|--------------|--------|
|<span data-ttu-id="67ea6-113">復元性</span><span class="sxs-lookup"><span data-stu-id="67ea6-113">Resilience</span></span>   | <span data-ttu-id="67ea6-114">バックグラウンド プロセスが別のプロセスで実行されている場合、バックグラウンド プロセスでクラッシュが発生してもフォアグラウンド アプリケーションがダウンしません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-114">If your background process is running in another process, a crash in your background process won't take down your foreground application.</span></span> <span data-ttu-id="67ea6-115">さらに、実行時間制限を過ぎて実行された場合、アプリ内からでもバックグラウンド アクティビティを終了できます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-115">Also, background activity can be terminated, even within your app, if it runs past execution time limits.</span></span> <span data-ttu-id="67ea6-116">フォアグラウンド プロセスとバックグラウンド プロセスが互いに通信する必要がない場合は、バックグラウンド処理をフォアグラウンド アプリとは別のタスクに分離することをお勧めします (インプロセス バックグラウンド タスクの主な利点の 1 つは、プロセス間通信が不要になることであるためです)。</span><span class="sxs-lookup"><span data-stu-id="67ea6-116">Separating background work into a task separate from the foreground app may be a better choice when it isn't necessary for the foreground and background processes to communicate with each other (since one of the main advantages of in-process background tasks are that they remove the need for inter-process communication).</span></span> |
|<span data-ttu-id="67ea6-117">シンプルさ</span><span class="sxs-lookup"><span data-stu-id="67ea6-117">Simplicity</span></span>    | <span data-ttu-id="67ea6-118">インプロセス バックグラウンド タスクでは、プロセス間通信が不要のため、記述内容は複雑になりません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-118">In-process background tasks don't require cross-process communication and are less complex to write.</span></span>  |
|<span data-ttu-id="67ea6-119">使用可能なトリガー</span><span class="sxs-lookup"><span data-stu-id="67ea6-119">Available triggers</span></span> | <span data-ttu-id="67ea6-120">プロセス内のバック グラウンド タスクは、次のトリガーをサポートしません。[DeviceUseTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.deviceusetrigger?f=255&MSPPError=-2147217396)、 [DeviceServicingTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.deviceservicingtrigger)と**IoTStartupTask**します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-120">In-process background tasks don't support the following triggers: [DeviceUseTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.deviceusetrigger?f=255&MSPPError=-2147217396), [DeviceServicingTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.deviceservicingtrigger) and **IoTStartupTask**.</span></span> |
|<span data-ttu-id="67ea6-121">VoIP</span><span class="sxs-lookup"><span data-stu-id="67ea6-121">VoIP</span></span> | <span data-ttu-id="67ea6-122">インプロセス バックグラウンド タスクでは、アプリケーション内での VoIP バックグラウンド タスクのアクティブ化がサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-122">In-process background tasks don't support activating a VoIP background task within your application.</span></span> |  

<span data-ttu-id="67ea6-123">**トリガーのインスタンスの数の制限:** アプリを登録できるいくつかのトリガーのインスタンスの数の制限があります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-123">**Limits on the number of trigger instances:** There are limits to how many instances of some triggers an app can register.</span></span> <span data-ttu-id="67ea6-124">アプリが [ApplicationTrigger](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.ApplicationTrigger)、[MediaProcessingTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.mediaprocessingtrigger)、および [DeviceUseTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.deviceusetrigger?f=255&MSPPError=-2147217396) を登録できるのは、アプリのインスタンスごとに 1 回のみです。</span><span class="sxs-lookup"><span data-stu-id="67ea6-124">An app can only register   [ApplicationTrigger](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.ApplicationTrigger), [MediaProcessingTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.mediaprocessingtrigger) and [DeviceUseTrigger](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.deviceusetrigger?f=255&MSPPError=-2147217396) once per instance of the app.</span></span> <span data-ttu-id="67ea6-125">アプリでこの制限を超えると、登録で例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-125">If an app goes over this limit, registration will throw an exception.</span></span>

<span data-ttu-id="67ea6-126">**CPU クォータ:** バック グラウンド タスクは、トリガーの種類に基づいて、取得、ウォール クロック使用時間の量によって制限されます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-126">**CPU quotas:** Background tasks are limited by the amount of wall-clock usage time they get based on trigger type.</span></span> <span data-ttu-id="67ea6-127">ほとんどのトリガーは、使用時間がウォールクロック時間で 30 秒に制限されますが、負荷の高いタスクを完了するために最大 10 分実行できるトリガーもあります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-127">Most triggers are limited to 30 seconds of wall-clock usage, while some have the ability to run up to 10 minutes in order to complete intensive tasks.</span></span> <span data-ttu-id="67ea6-128">バッテリの寿命を長くし、フォアグラウンド アプリのユーザー エクスペリエンスを高めるため、バックグラウンド タスクは軽量にしてください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-128">Background tasks should be lightweight to save battery life and provide a better user experience for foreground apps.</span></span> <span data-ttu-id="67ea6-129">バックグラウンド タスクに適用されるリソースの制約については、「[バックグラウンド タスクによるアプリのサポート](support-your-app-with-background-tasks.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-129">See [Support your app with background tasks](support-your-app-with-background-tasks.md) for the resource constraints applied to background tasks.</span></span>

<span data-ttu-id="67ea6-130">**バック グラウンド タスクを管理するには。** アプリでは、登録されているバック グラウンド タスクの一覧を取得、進行状況と完了ハンドラーの登録、およびそれらのイベントを適切に処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-130">**Manage background tasks:** Your app should get a list of registered background tasks, register for progress and completion handlers, and handle those events appropriately.</span></span> <span data-ttu-id="67ea6-131">バックグラウンド タスク クラスでは、進行状況、キャンセル、完了を報告する必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-131">Your background task classes should report progress, cancellation, and completion.</span></span> <span data-ttu-id="67ea6-132">詳しくは、「[取り消されたバックグラウンド タスクの処理](handle-a-cancelled-background-task.md)」と「[バックグラウンド タスクの進捗状況と完了の監視](monitor-background-task-progress-and-completion.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-132">For more info see [Handle a cancelled background task](handle-a-cancelled-background-task.md), and [Monitor background task progress and completion](monitor-background-task-progress-and-completion.md).</span></span>

<span data-ttu-id="67ea6-133">**使用[BackgroundTaskDeferral](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.BackgroundTaskDeferral):** バック グラウンド タスク クラスは、非同期コードを実行する場合は、遅延を使用して確認します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-133">**Use [BackgroundTaskDeferral](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.BackgroundTaskDeferral):** If your background task class runs asynchronous code, make sure to use deferrals.</span></span> <span data-ttu-id="67ea6-134">それ以外の場合、バック グラウンド タスクが途中で終了するときに、[実行](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run)メソッドを返します。 (または[OnBackgroundActivated](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application.onbackgroundactivated)メソッドは、インプロセスのバック グラウンド タスクの場合)。</span><span class="sxs-lookup"><span data-stu-id="67ea6-134">Otherwise your background task may be terminated prematurely when the [Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) method returns (or the [OnBackgroundActivated](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application.onbackgroundactivated) method in the case of in-process background tasks).</span></span> <span data-ttu-id="67ea6-135">詳しくは、「[アウトプロセス バックグラウンド タスクの作成と登録](create-and-register-a-background-task.md)」をご覧ください</span><span class="sxs-lookup"><span data-stu-id="67ea6-135">For more information, see [Create and register an out-of-process background task](create-and-register-a-background-task.md).</span></span>

<span data-ttu-id="67ea6-136">別の方法として、保留を 1 回要求し、**async/await** を使って、非同期メソッドの呼び出しを完了させることもできます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-136">Alternatively, request one deferral, and use **async/await** to complete asynchronous method calls.</span></span> <span data-ttu-id="67ea6-137">**await** メソッドを呼び出した後、保留を閉じます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-137">Close the deferral after the **await** method calls.</span></span>

<span data-ttu-id="67ea6-138">**アプリケーション マニフェストを更新します。** アウト プロセスを実行するバック グラウンド タスクと共に使用するトリガーの種類と共に、アプリケーション マニフェスト内の各バック グラウンド タスクを宣言します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-138">**Update the app manifest:**  For background tasks that run out-of-process, declare each background task in the application manifest, along with the type of triggers it is used with.</span></span> <span data-ttu-id="67ea6-139">この宣言がないと、アプリでは実行時にバックグラウンド タスクを登録できません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-139">Otherwise your app will not be able to register the background task at runtime.</span></span>

<span data-ttu-id="67ea6-140">複数のバック グラウンド タスクがある場合は、同じホスト プロセスで実行する必要があるか、または別のホスト プロセスに分離する必要があるかどうかを検討してください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-140">If you have multiple background tasks, consider whether they should run in the same host process or be separated into different host processes.</span></span> <span data-ttu-id="67ea6-141">1 つのバック グラウンド タスクでエラーが発生したときに別のバック グラウンド タスクが停止することが心配な場合は、別のホスト プロセスに配置します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-141">Put them in separate host processes if you are concerned that a failure in one background task could bring down other background tasks.</span></span>  <span data-ttu-id="67ea6-142">マニフェスト デザイナーの **リソース グループ** エントリを使用してバックグラウンド タスクを別のホスト プロセスにグループ化します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-142">Use the **Resource group** entry in the manifest designer to group background tasks into different host processes.</span></span> 

<span data-ttu-id="67ea6-143">**リソース グループ**を設定するには、Package.appxmanifest デザイナーを開き、 **[宣言]** を選択し、 **[アプリ サービス]** 宣言を追加します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-143">To set the **Resource group**, open the Package.appxmanifest designer, choose **Declarations**, and add an **App Service** declaration:</span></span>

![リソース グループの設定](images/resourcegroup.png)

<span data-ttu-id="67ea6-145">リソース グループの設定の詳細については、「[アプリケーション スキーマ リファレンス](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-application)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-145">See the [application schema reference](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-application) for more information about the resource group setting.</span></span>

<span data-ttu-id="67ea6-146">フォアグラウンド アプリと同じプロセスで実行されるバックグラウンド タスクは、アプリケーション マニフェストでの自身を宣言する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-146">Background tasks that run in the same process as the foreground app do not need to declare themselves in the application manifest.</span></span> <span data-ttu-id="67ea6-147">アウトプロセスで実行されるバックグラウンド タスクをマニフェストで宣言する方法について詳しくは、「[アプリケーション マニフェストでのバックグラウンド タスクの宣言](declare-background-tasks-in-the-application-manifest.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-147">For more information about declaring background tasks that run out-of-process in the manifest, see [Declare background tasks in the application manifest](declare-background-tasks-in-the-application-manifest.md).</span></span>

<span data-ttu-id="67ea6-148">**アプリの更新プログラムを準備します。** 作成し、登録、アプリを更新する場合、 **ServicingComplete**バック グラウンド タスク (を参照してください[SystemTriggerType](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.SystemTriggerType))、アプリの以前のバージョンのバック グラウンド タスクを登録解除と登録、新しいバージョンのバック グラウンド タスク。</span><span class="sxs-lookup"><span data-stu-id="67ea6-148">**Prepare for app updates:** If your app will be updated, create and register a **ServicingComplete** background task (see [SystemTriggerType](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.SystemTriggerType)) to unregister background tasks for the previous version of the app, and register the background tasks for the new version.</span></span> <span data-ttu-id="67ea6-149">これは、フォアグラウンドで実行中のコンテキストの外で必要となる可能性があるアプリの更新を実行するのに適したタイミングです。</span><span class="sxs-lookup"><span data-stu-id="67ea6-149">This is also an appropriate time to perform app updates that may be necessary outside the context of running in the foreground.</span></span>

<span data-ttu-id="67ea6-150">**バック グラウンド タスクを実行する要求:**</span><span class="sxs-lookup"><span data-stu-id="67ea6-150">**Request to execute background tasks:**</span></span>

> <span data-ttu-id="67ea6-151">**重要な**  以降 Windows 10 では、アプリが不要にバック グラウンド タスクを実行する前提条件として、ロック画面上にします。</span><span class="sxs-lookup"><span data-stu-id="67ea6-151">**Important**  Starting in Windows 10, apps are no longer required to be on the lock screen as a prerequisite to run background tasks.</span></span>

<span data-ttu-id="67ea6-152">ユニバーサル Windows プラットフォーム (UWP) アプリは、ロック画面にピン留めしなくても、サポートされているすべての種類のタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-152">Universal Windows Platform (UWP) apps can run all supported task types without being pinned to the lock screen.</span></span> <span data-ttu-id="67ea6-153">ただし、どの種類のバックグラウンド タスクを登録する場合でも、その前にアプリが [**RequestAccessAsync**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.backgroundexecutionmanager.requestaccessasync) を呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-153">However, apps must call [**RequestAccessAsync**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.backgroundexecutionmanager.requestaccessasync) before registering any type of background task.</span></span> <span data-ttu-id="67ea6-154">ユーザーがデバイス設定でバックグラウンド タスクに対するアプリのアクセス許可を明示的に拒否した場合、このメソッドは [**BackgroundAccessStatus.DeniedByUser**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.BackgroundAccessStatus) を返します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-154">This method will return [**BackgroundAccessStatus.DeniedByUser**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Background.BackgroundAccessStatus) if the user has explicitly denied background task permissions for your app in the device's settings.</span></span> <span data-ttu-id="67ea6-155">バックグラウンド アクティビティとバッテリー節約機能についてのユーザーの選択について詳しくは、「[バックグラウンド アクティビティの最適化](https://docs.microsoft.com/windows/uwp/debug-test-perf/optimize-background-activity)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-155">For more information on user choice around background activity and Battery Saver, see [Optimize Background Activity](https://docs.microsoft.com/windows/uwp/debug-test-perf/optimize-background-activity).</span></span> 
## <a name="background-task-checklist"></a><span data-ttu-id="67ea6-156">バックグラウンド タスクのチェック リスト</span><span class="sxs-lookup"><span data-stu-id="67ea6-156">Background task checklist</span></span>

<span data-ttu-id="67ea6-157">*両方のインプロセスおよびアウト プロセスのバック グラウンド タスクに適用されます。*</span><span class="sxs-lookup"><span data-stu-id="67ea6-157">*Applies to both in-process and out-of-process background tasks*</span></span>

-   <span data-ttu-id="67ea6-158">バックグラウンド タスクを適切なトリガーに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-158">Associate your background task with the correct trigger.</span></span>
-   <span data-ttu-id="67ea6-159">条件を追加して、バックグラウンド タスクが適切に実行されるようにします。</span><span class="sxs-lookup"><span data-stu-id="67ea6-159">Add conditions to help ensure your background task runs successfully.</span></span>
-   <span data-ttu-id="67ea6-160">バックグラウンド タスクの進行、完了、取り消しを処理します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-160">Handle background task progress, completion, and cancellation.</span></span>
-   <span data-ttu-id="67ea6-161">アプリ起動時にバックグラウンド タスクを再登録します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-161">Re-register your background tasks during app launch.</span></span> <span data-ttu-id="67ea6-162">これにより、初めてアプリを起動したときにそれらが登録されるようになります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-162">This ensures that they are registered the first time the app is launched.</span></span> <span data-ttu-id="67ea6-163">また、ユーザーがバックグラウンド タスク実行機能を無効にしたかどうかを検出する方法も提供されます (登録に失敗した場合)。</span><span class="sxs-lookup"><span data-stu-id="67ea6-163">It also provides a way to detect whether the user has disabled your app's background execution capabilities (in the event registration fails).</span></span>
-   <span data-ttu-id="67ea6-164">バックグラウンド タスクの登録エラーを確認します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-164">Check for background task registration errors.</span></span> <span data-ttu-id="67ea6-165">必要に応じて、別のパラメーター値でバックグラウンド タスクをもう一度登録してみます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-165">If appropriate, attempt to register the background task again with different parameter values.</span></span>
-   <span data-ttu-id="67ea6-166">デスクトップ以外のすべてのデバイス ファミリでは、デバイスのメモリが少なくなった場合、バックグラウンド タスクが終了することがあります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-166">For all device families except desktop, if the device becomes low on memory, background tasks may be terminated.</span></span> <span data-ttu-id="67ea6-167">メモリ不足の例外が検出されないか、検出されてもアプリによって処理されない場合、バックグラウンド タスクは、警告や OnCanceled イベントの発生なしに終了します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-167">If an out of memory exception is not surfaced, or the app does not handle it, then the background task will be terminated without warning and without raising the OnCanceled event.</span></span> <span data-ttu-id="67ea6-168">こうすることで、フォアグラウンドのアプリのユーザー エクスペリエンスが保証されます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-168">This helps to ensure the user experience of the app in the foreground.</span></span> <span data-ttu-id="67ea6-169">バックグラウンド タスクは、このシナリオを処理できるように設計する必要があります。</span><span class="sxs-lookup"><span data-stu-id="67ea6-169">Your background task should be designed to handle this scenario.</span></span>

<span data-ttu-id="67ea6-170">*プロセス外のバック グラウンド タスクにのみ適用されます。*</span><span class="sxs-lookup"><span data-stu-id="67ea6-170">*Applies only to out-of-process background tasks*</span></span>

-   <span data-ttu-id="67ea6-171">Windows ランタイム コンポーネントでバックグラウンド タスクを作成します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-171">Create your background task in a Windows Runtime Component.</span></span>
-   <span data-ttu-id="67ea6-172">バックグラウンド タスクでは、トースト、タイル、バッジの更新以外の UI は表示しません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-172">Do not display UI other than toasts, tiles, and badge updates from the background task.</span></span>
-   <span data-ttu-id="67ea6-173">[Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) メソッドでは、各非同期メソッド呼び出しに対して保留を要求し、メソッドが終了した時点で閉じます。</span><span class="sxs-lookup"><span data-stu-id="67ea6-173">In the [Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) method, request deferrals for each asynchronous method call, and close them when the method is done.</span></span> <span data-ttu-id="67ea6-174">または、**async/await** で保留を 1 回使用します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-174">Or, use one deferral with **async/await**.</span></span>
-   <span data-ttu-id="67ea6-175">固定ストレージを使って、バックグラウンド タスクとアプリ間でデータを共有します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-175">Use persistent storage to share data between the background task and the app.</span></span>
-   <span data-ttu-id="67ea6-176">アプリケーション マニフェストで、各バックグラウンド タスクと共に、バックグラウンド タスクで使うトリガーの種類を宣言します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-176">Declare each background task in the application manifest, along with the type of triggers it is used with.</span></span> <span data-ttu-id="67ea6-177">エントリ ポイントとトリガーの種類が正しいことを確認します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-177">Make sure the entry point and trigger types are correct.</span></span>
-   <span data-ttu-id="67ea6-178">アプリと同じコンテキストで実行する必要があるトリガー ([**ControlChannelTrigger**](https://docs.microsoft.com/uwp/api/Windows.Networking.Sockets.ControlChannelTrigger) など) を使う場合を除き、マニフェストでは Executable 要素を指定しないでください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-178">Do not specify an Executable element in the manifest unless you are using a trigger that should be run in the same context as the app (such as the [**ControlChannelTrigger**](https://docs.microsoft.com/uwp/api/Windows.Networking.Sockets.ControlChannelTrigger)).</span></span>

<span data-ttu-id="67ea6-179">*プロセス内のバック グラウンド タスクにのみ適用されます。*</span><span class="sxs-lookup"><span data-stu-id="67ea6-179">*Applies only to in-process background tasks*</span></span>

- <span data-ttu-id="67ea6-180">タスクをキャンセルするとき、キャンセルが発生するか、プロセス全体が終了する前に `BackgroundActivated` イベント ハンドラーが終了したことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="67ea6-180">When cancelling a task, ensure that the `BackgroundActivated` event handler exits before the cancellation occurs or the whole process will be terminated.</span></span>
-   <span data-ttu-id="67ea6-181">バックグラウンド タスクの存続期間は短くします。</span><span class="sxs-lookup"><span data-stu-id="67ea6-181">Write background tasks that are short-lived.</span></span> <span data-ttu-id="67ea6-182">バックグラウンド タスクに使用できる時間は、ウォールクロック時間で 30 秒間に制限されています。</span><span class="sxs-lookup"><span data-stu-id="67ea6-182">Background tasks are limited to 30 seconds of wall-clock usage.</span></span>
-   <span data-ttu-id="67ea6-183">バックグラウンド タスクでのユーザー操作に依存することはできません。</span><span class="sxs-lookup"><span data-stu-id="67ea6-183">Do not rely on user interaction in background tasks.</span></span>

## <a name="related-topics"></a><span data-ttu-id="67ea6-184">関連トピック</span><span class="sxs-lookup"><span data-stu-id="67ea6-184">Related topics</span></span>

* <span data-ttu-id="67ea6-185">[インプロセス バックグラウンド タスクの作成と登録](create-and-register-an-inproc-background-task.md)</span><span class="sxs-lookup"><span data-stu-id="67ea6-185">[Create and register an in-process background task](create-and-register-an-inproc-background-task.md).</span></span>
* [<span data-ttu-id="67ea6-186">アウトプロセス バックグラウンド タスクの作成と登録</span><span class="sxs-lookup"><span data-stu-id="67ea6-186">Create and register an out-of-process background task</span></span>](create-and-register-a-background-task.md)
* [<span data-ttu-id="67ea6-187">アプリケーション マニフェストでのバックグラウンド タスクの宣言</span><span class="sxs-lookup"><span data-stu-id="67ea6-187">Declare background tasks in the application manifest</span></span>](declare-background-tasks-in-the-application-manifest.md)
* [<span data-ttu-id="67ea6-188">バック グラウンドでメディアを再生します。</span><span class="sxs-lookup"><span data-stu-id="67ea6-188">Play media in the background</span></span>](https://docs.microsoft.com/windows/uwp/audio-video-camera/background-audio)
* [<span data-ttu-id="67ea6-189">取り消されたバックグラウンド タスクの処理</span><span class="sxs-lookup"><span data-stu-id="67ea6-189">Handle a cancelled background task</span></span>](handle-a-cancelled-background-task.md)
* [<span data-ttu-id="67ea6-190">バックグラウンド タスクの進捗状況と完了の監視</span><span class="sxs-lookup"><span data-stu-id="67ea6-190">Monitor background task progress and completion</span></span>](monitor-background-task-progress-and-completion.md)
* [<span data-ttu-id="67ea6-191">バックグラウンド タスクの登録</span><span class="sxs-lookup"><span data-stu-id="67ea6-191">Register a background task</span></span>](register-a-background-task.md)
* [<span data-ttu-id="67ea6-192">バックグラウンド タスクによるシステム イベントへの応答</span><span class="sxs-lookup"><span data-stu-id="67ea6-192">Respond to system events with background tasks</span></span>](respond-to-system-events-with-background-tasks.md)
* [<span data-ttu-id="67ea6-193">バックグラウンド タスクを実行するための条件の設定</span><span class="sxs-lookup"><span data-stu-id="67ea6-193">Set conditions for running a background task</span></span>](set-conditions-for-running-a-background-task.md)
* [<span data-ttu-id="67ea6-194">バックグラウンド タスクのライブ タイルの更新</span><span class="sxs-lookup"><span data-stu-id="67ea6-194">Update a live tile from a background task</span></span>](update-a-live-tile-from-a-background-task.md)
* [<span data-ttu-id="67ea6-195">メンテナンス トリガーの使用</span><span class="sxs-lookup"><span data-stu-id="67ea6-195">Use a maintenance trigger</span></span>](use-a-maintenance-trigger.md)
* [<span data-ttu-id="67ea6-196">タイマーでのバックグラウンド タスクの実行</span><span class="sxs-lookup"><span data-stu-id="67ea6-196">Run a background task on a timer</span></span>](run-a-background-task-on-a-timer-.md)
* [<span data-ttu-id="67ea6-197">バックグラウンド タスクのデバッグ</span><span class="sxs-lookup"><span data-stu-id="67ea6-197">Debug a background task</span></span>](debug-a-background-task.md)
* [<span data-ttu-id="67ea6-198">トリガーする方法を中断、再開、および (デバッグ) 場合は、UWP アプリでイベントをバック グラウンド</span><span class="sxs-lookup"><span data-stu-id="67ea6-198">How to trigger suspend, resume, and background events in UWP apps (when debugging)</span></span>](https://go.microsoft.com/fwlink/p/?linkid=254345)

 

 
