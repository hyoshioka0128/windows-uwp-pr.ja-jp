---
author: muhsinking
title: バックグラウンド タスクからのセンサーやデバイスへのアクセス
description: DeviceUseTrigger を使うと、フォアグラウンド アプリが中断しているときにも、バックグラウンドでユニバーサル Windows アプリからセンサーや周辺機器にアクセスできます。
ms.assetid: B540200D-9FF2-49AF-A224-50877705156B
ms.author: mukin
ms.date: 02/08/2017
ms.topic: article
keywords: バック グラウンド タスクの windows 10, uwp,
ms.localizationpriority: medium
ms.openlocfilehash: 1666d64c26c8ccfecda142e50f2e672d0f4c8864
ms.sourcegitcommit: e814a13978f33654d8e995584f4b047cb53e0aef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/05/2018
ms.locfileid: "6040517"
---
# <a name="access-sensors-and-devices-from-a-background-task"></a><span data-ttu-id="5f912-104">バックグラウンド タスクからのセンサーやデバイスへのアクセス</span><span class="sxs-lookup"><span data-stu-id="5f912-104">Access sensors and devices from a background task</span></span>




<span data-ttu-id="5f912-105">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) を使うと、フォアグラウンド アプリが中断しているときにも、バックグラウンドでユニバーサル Windows アプリからセンサーや周辺機器にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="5f912-105">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) lets your Universal Windows app access sensors and peripheral devices in the background, even when your foreground app is suspended.</span></span> <span data-ttu-id="5f912-106">たとえば、アプリが実行されている場所によっては、バックグラウンド タスクを使ってデバイスまたはモニターのセンサーとデータを同期することができます。</span><span class="sxs-lookup"><span data-stu-id="5f912-106">For example, depending on where your app is running, it could use a background task to synchronize data with devices or monitor sensors.</span></span> <span data-ttu-id="5f912-107">バッテリ残量を維持し、適切なユーザーの同意を得るために、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) の使用にはこのトピックで説明するポリシーが適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-107">To help preserve battery life and ensure the appropriate user consent, the use of [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) is subject to policies that are described in this topic.</span></span>

<span data-ttu-id="5f912-108">バックグラウンドでセンサーまたは周辺機器にアクセスするには、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) を使うバックグラウンド タスクを作成します。</span><span class="sxs-lookup"><span data-stu-id="5f912-108">To access sensors or peripheral devices in the background, create a background task that uses the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337).</span></span> <span data-ttu-id="5f912-109">PC でこれを実行する方法を示す例については、[カスタム USB デバイスのサンプルに関するページ](http://go.microsoft.com/fwlink/p/?LinkId=301975 ) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-109">For an example that shows how this is done on a PC, see the [Custom USB device sample](http://go.microsoft.com/fwlink/p/?LinkId=301975 ).</span></span> <span data-ttu-id="5f912-110">電話の例は、[バックグラウンド センサーのサンプル](http://go.microsoft.com/fwlink/p/?LinkId=393307)に関するページをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-110">For an example on a phone, see the [Background Sensors sample](http://go.microsoft.com/fwlink/p/?LinkId=393307).</span></span>

> [!Important]
> <span data-ttu-id="5f912-111">**DeviceUseTrigger** は、インプロセスのバックグラウンド タスクで使うことはできません。</span><span class="sxs-lookup"><span data-stu-id="5f912-111">**DeviceUseTrigger** cannot be used with in-process background tasks.</span></span> <span data-ttu-id="5f912-112">このトピックの情報は、アウトプロセスで実行されるバックグラウンド タスクにのみ当てはまります。</span><span class="sxs-lookup"><span data-stu-id="5f912-112">The info in this topic only applies to background tasks that run out-of-process.</span></span>

## <a name="device-background-task-overview"></a><span data-ttu-id="5f912-113">デバイス バックグラウンド タスクの概要</span><span class="sxs-lookup"><span data-stu-id="5f912-113">Device background task overview</span></span>

<span data-ttu-id="5f912-114">アプリがユーザーに表示されなくなると、Windows はメモリと CPU リソースを解放するためにそのアプリを中断または終了します。</span><span class="sxs-lookup"><span data-stu-id="5f912-114">When your app is no longer visible to the user, Windows will suspend or terminate your app to reclaim memory and CPU resources.</span></span> <span data-ttu-id="5f912-115">こうすることで、他のアプリがフォアグラウンドで実行できるようにし、バッテリの消費量を減らします。</span><span class="sxs-lookup"><span data-stu-id="5f912-115">This allows other apps to run in the foreground and reduces battery consumption.</span></span> <span data-ttu-id="5f912-116">このとき、バックグラウンド タスクの助けがないと、進行中のデータ イベントが失われます。</span><span class="sxs-lookup"><span data-stu-id="5f912-116">When this happens, without the help of a background task, any ongoing data events will be lost.</span></span> <span data-ttu-id="5f912-117">Windows には、バックグラウンド タスク トリガー [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) があり、アプリが中断状態になっても、各種のデバイスやセンサーでの時間のかかる同期操作や監視操作をバックグラウンドで安全に実行できるようにします。</span><span class="sxs-lookup"><span data-stu-id="5f912-117">Windows provides the background task trigger, [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337), to let your app perform long running sync and monitoring operations on devices and sensors safely in the background, even if your app is suspended.</span></span> <span data-ttu-id="5f912-118">アプリのライフサイクルについて詳しくは、「[起動、再開、バックグラウンド タスク](index.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-118">For more info about app lifecycle, see [Launching, resuming, and background tasks](index.md).</span></span> <span data-ttu-id="5f912-119">バックグラウンド タスクについて詳しくは、「[バックグラウンド タスクによるアプリのサポート](support-your-app-with-background-tasks.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-119">For more about background tasks, see [Support your app with background tasks](support-your-app-with-background-tasks.md).</span></span>

<span data-ttu-id="5f912-120">**注:** ユニバーサル Windows アプリでは、バック グラウンドでデバイスの同期、ユーザーが承認されていること、アプリによるバック グラウンド同期が必要です。</span><span class="sxs-lookup"><span data-stu-id="5f912-120">**Note**In a Universal Windows app, syncing a device in the background requires that your user has approved background syncing by your app.</span></span> <span data-ttu-id="5f912-121">さらに、デバイスを PC に接続して I/O をアクティブにし、最長 10 分のバックグラウンド処理を実行できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-121">The device must also be connected to or paired with the PC, with active I/O, and is allowed a maximum of 10 minutes of background activity.</span></span> <span data-ttu-id="5f912-122">ポリシーの適用については、このトピックの後半で詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="5f912-122">More detail on policy enforcement is described later in this topic.</span></span>

### <a name="limitation-critical-device-operations"></a><span data-ttu-id="5f912-123">制限: 重要なデバイス操作</span><span class="sxs-lookup"><span data-stu-id="5f912-123">Limitation: critical device operations</span></span>

<span data-ttu-id="5f912-124">時間がかかるファームウェア更新など、一部の重要なデバイス操作は、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) では実行できません。</span><span class="sxs-lookup"><span data-stu-id="5f912-124">Some critical device operations, such as long running firmware updates, cannot be performed with the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337).</span></span> <span data-ttu-id="5f912-125">このような操作は PC でのみ、[**DeviceServicingTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297315) を使う特権アプリによってのみ実行できます。</span><span class="sxs-lookup"><span data-stu-id="5f912-125">Such operations can be performed only on the PC, and only by a privileged app that uses the [**DeviceServicingTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297315).</span></span> <span data-ttu-id="5f912-126">*特権アプリ*とは、これらの操作を実行する権限をデバイス製造元から与えられているアプリです。</span><span class="sxs-lookup"><span data-stu-id="5f912-126">A *privileged app* is an app that the device's manufacturer has authorized to perform those operations.</span></span> <span data-ttu-id="5f912-127">デバイス メタデータを使って、どのアプリがデバイスの特権アプリであるか (存在する場合) を指定します。</span><span class="sxs-lookup"><span data-stu-id="5f912-127">Device metadata is used to specify which app, if any, has been designated as the privileged app for a device.</span></span> <span data-ttu-id="5f912-128">詳しくは、「[Microsoft Store デバイス アプリによるデバイスの同期と更新](http://go.microsoft.com/fwlink/p/?LinkId=306619)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-128">For more info, see [Device sync and update for Microsoft Store device apps](http://go.microsoft.com/fwlink/p/?LinkId=306619).</span></span>

## <a name="protocolsapis-supported-in-a-deviceusetrigger-background-task"></a><span data-ttu-id="5f912-129">DeviceUseTrigger バックグラウンド タスクでサポートされているプロトコル/API</span><span class="sxs-lookup"><span data-stu-id="5f912-129">Protocols/APIs supported in a DeviceUseTrigger background task</span></span>

<span data-ttu-id="5f912-130">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) を使うバックグラウンド タスクは、システム トリガーのバックグラウンド タスクでサポートされない多くの API またはプロトコルを使うやり取りを、アプリでできるようにします。</span><span class="sxs-lookup"><span data-stu-id="5f912-130">Background tasks that use [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) let your app communicate over many protocols/APIs, most of which aren't supported by system-triggered background tasks.</span></span> <span data-ttu-id="5f912-131">ユニバーサル Windows アプリでは、次のプロトコルがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="5f912-131">The following are supported on a Universal Windows app.</span></span>

| <span data-ttu-id="5f912-132">プロトコル</span><span class="sxs-lookup"><span data-stu-id="5f912-132">Protocol</span></span>         | <span data-ttu-id="5f912-133">ユニバーサル Windows アプリの DeviceUseTrigger</span><span class="sxs-lookup"><span data-stu-id="5f912-133">DeviceUseTrigger in a Universal Windows app</span></span>                                                                                                                                                    |
|------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
| <span data-ttu-id="5f912-134">USB</span><span class="sxs-lookup"><span data-stu-id="5f912-134">USB</span></span>              | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-136">HID</span><span class="sxs-lookup"><span data-stu-id="5f912-136">HID</span></span>              | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-138">Bluetooth RFCOMM</span><span class="sxs-lookup"><span data-stu-id="5f912-138">Bluetooth RFCOMM</span></span> | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-140">Bluetooth GATT</span><span class="sxs-lookup"><span data-stu-id="5f912-140">Bluetooth GATT</span></span>   | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-142">MTP</span><span class="sxs-lookup"><span data-stu-id="5f912-142">MTP</span></span>              | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-144">ネットワーク (有線)</span><span class="sxs-lookup"><span data-stu-id="5f912-144">Network wired</span></span>    | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-146">ネットワーク (Wi-Fi)</span><span class="sxs-lookup"><span data-stu-id="5f912-146">Network Wi-Fi</span></span>    | ![このプロトコルはサポートされています。](images/ap-tools.png)                                                                                                                                            |
| <span data-ttu-id="5f912-148">IDeviceIOControl</span><span class="sxs-lookup"><span data-stu-id="5f912-148">IDeviceIOControl</span></span> | ![DeviceServicingTrigger でサポートされています。](images/ap-tools.png)                                                                                                                       |
| <span data-ttu-id="5f912-150">センサー API</span><span class="sxs-lookup"><span data-stu-id="5f912-150">Sensors API</span></span>      | ![<span data-ttu-id="5f912-151">DeviceServicingTrigger でサポートされています](images/ap-tools.png) ([ユニバーサル デバイス ファミリ](https://msdn.microsoft.com/library/windows/apps/dn894631)のセンサーのみ)。</span><span class="sxs-lookup"><span data-stu-id="5f912-151">deviceservicingtrigger supports universal sensors apis](images/ap-tools.png) (limited to sensors in the [universal device family](https://msdn.microsoft.com/library/windows/apps/dn894631))</span></span> |

## <a name="registering-background-tasks-in-the-app-package-manifest"></a><span data-ttu-id="5f912-152">バックグラウンド タスクをアプリ パッケージ マニフェストに登録する</span><span class="sxs-lookup"><span data-stu-id="5f912-152">Registering background tasks in the app package manifest</span></span>

<span data-ttu-id="5f912-153">アプリは、バックグランド タスクの一部として動作するコードで同期操作と更新操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="5f912-153">Your app will perform sync and update operations in code that runs as part of a background task.</span></span> <span data-ttu-id="5f912-154">このコードは、[**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794) を実装する Windows ランタイム クラス (または JavaScript アプリ専用の JavaScript ページ) に埋め込まれます。</span><span class="sxs-lookup"><span data-stu-id="5f912-154">This code is embedded in a Windows Runtime class that implements [**IBackgroundTask**](https://msdn.microsoft.com/library/windows/apps/br224794) (or in a dedicated JavaScript page for JavaScript apps).</span></span> <span data-ttu-id="5f912-155">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを使用するには、システム トリガーのバックグラウンド タスクと同じように、フォアグラウンド アプリのマニフェスト ファイルでそれを宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-155">To use a [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task, your app must declare it in the app manifest file of a foreground app, like it does for system-triggered background tasks.</span></span>

<span data-ttu-id="5f912-156">この例のアプリ パッケージ マニフェスト ファイルでは、**DeviceLibrary.SyncContent** が、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) を使うバックグラウンド タスクのエントリ ポイントとなります。</span><span class="sxs-lookup"><span data-stu-id="5f912-156">In this example of an app package manifest file, **DeviceLibrary.SyncContent** is the entry point for a background task that uses the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337).</span></span>

```xml
<Extensions>
  <Extension Category="windows.backgroundTasks" EntryPoint="DeviceLibrary.SyncContent">
    <BackgroundTasks>
      <m2:Task Type="deviceUse" />
    </BackgroundTasks>
  </Extension>
</Extensions>
```

## <a name="introduction-to-using-deviceusetrigger"></a><span data-ttu-id="5f912-157">DeviceUseTrigger の使用について</span><span class="sxs-lookup"><span data-stu-id="5f912-157">Introduction to using DeviceUseTrigger</span></span>

<span data-ttu-id="5f912-158">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) を使うには、次の基本的な手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="5f912-158">To use the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337), follow these basic steps.</span></span> <span data-ttu-id="5f912-159">バックグラウンド タスクについて詳しくは、「[バックグラウンド タスクによるアプリのサポート](support-your-app-with-background-tasks.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-159">For more info about background tasks, see [Support your app with background tasks](support-your-app-with-background-tasks.md).</span></span>

1.  <span data-ttu-id="5f912-160">アプリ マニフェストにバックグラウンド タスクを登録し、IBackgroundTask を実装する Windows ランタイム クラスまたは JavaScript アプリ専用の JavaScript ページにバックグラウンド タスク コードを埋め込みます。</span><span class="sxs-lookup"><span data-stu-id="5f912-160">Your app registers its background task in the app manifest and embeds the background task code in a Windows Runtime class that implements IBackgroundTask or in a dedicated JavaScript page for JavaScript apps.</span></span>
2.  <span data-ttu-id="5f912-161">アプリが起動されると、タイプ [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) のトリガー オブジェクトを作成および構成し、後で使用できるようにトリガー インスタンスを格納します。</span><span class="sxs-lookup"><span data-stu-id="5f912-161">When your app starts, it will create and configure a trigger object of type [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337), and store the trigger instance for future use.</span></span>
3.  <span data-ttu-id="5f912-162">バックグラウンド タスクが前に登録されているかどうかをチェックし、登録されていない場合は、トリガーに対してバックグラウンド タスクを登録します。</span><span class="sxs-lookup"><span data-stu-id="5f912-162">Your app checks whether the background task has been previously registered and, if not, registers it against the trigger.</span></span> <span data-ttu-id="5f912-163">このトリガーに関連付けられているタスクには条件を設定できないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="5f912-163">Note that your app isn't allowed to set conditions on the task associated with this trigger.</span></span>
4.  <span data-ttu-id="5f912-164">アプリからバックグラウンド タスクをトリガーする必要がある場合は、最初に [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) を呼び出して、アプリがバックグラウンド タスクを要求できるかどうかを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-164">When your app needs to trigger the background task, it must first call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) to check if the app is able to request a background task.</span></span>
5.  <span data-ttu-id="5f912-165">バックグラウンド タスクを要求できる場合は、デバイス トリガー オブジェクトの [**RequestAsync**](https://msdn.microsoft.com/library/windows/apps/dn297341) アクティブ化メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="5f912-165">If the app can request the background task, it calls the [**RequestAsync**](https://msdn.microsoft.com/library/windows/apps/dn297341) activation method on the device trigger object.</span></span>
6.  <span data-ttu-id="5f912-166">バックグラウンド タスクは、(CPU 時間が割り当てられない) 他のシステム バックグラウンド タスクのように抑制されません。ただし、フォアグラウンド アプリの応答性を維持するため、低い優先順位で実行されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-166">Your background task isn’t throttled like other system background tasks (there's no CPU time quota) but will run with reduced priority to keep foreground apps responsive.</span></span>
7.  <span data-ttu-id="5f912-167">次に Windows は、トリガー タイプに応じて、必要なポリシー (バックラウンド タスクを開始する前にユーザーの許可を得るなど) に準拠しているかどうかを検証します。</span><span class="sxs-lookup"><span data-stu-id="5f912-167">Windows will then validate, based on the trigger type, that the necessary policies have been met, including requesting user consent for the operation before starting the background task.</span></span>
8.  <span data-ttu-id="5f912-168">Windows はシステム条件とタスクの実行時間を監視し、必要な条件を満たさなくなった場合はタスクを中止します。</span><span class="sxs-lookup"><span data-stu-id="5f912-168">Windows monitors system conditions and task runtime and, if necessary, cancels the task if the required conditions are no longer met.</span></span>
9.  <span data-ttu-id="5f912-169">バックグラウンド タスクが進捗状況や完了を報告する際、登録タスクの進捗状況イベントまたは完了イベントとしてアプリに渡されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-169">When the background tasks reports progress or completion, your app will receive these events through progress and completed events on the registered task.</span></span>

<span data-ttu-id="5f912-170">**重要な** [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337)を使用する場合は、これらの重要な点を検討してください。</span><span class="sxs-lookup"><span data-stu-id="5f912-170">**Important** Consider these important points when using the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337):</span></span>

-   <span data-ttu-id="5f912-171">プログラムで[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337)を使うバック グラウンド タスクをトリガーする機能はまず Windows8.1 と Windows Phone 8.1 で導入されました。</span><span class="sxs-lookup"><span data-stu-id="5f912-171">The ability to programmatically trigger background tasks that use the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) was first introduced in Windows8.1 and Windows Phone 8.1.</span></span>

-   <span data-ttu-id="5f912-172">PC で周辺機器を更新するとき、ユーザーの許可を得るためのポリシーが Windows によって適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-172">Certain policies are enforced by Windows to ensure user consent when updating peripheral devices on the PC.</span></span>

-   <span data-ttu-id="5f912-173">周辺機器を同期および更新する際、バッテリ残量を維持するためのポリシーも適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-173">Additional polices are enforced to preserve user battery life when syncing and updating peripheral devices.</span></span>

-   <span data-ttu-id="5f912-174">最大バックグラウンド時間 (実時間) など、所定のポリシー要件を満たさなくなった場合、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) を使用するバクグラウンド タスクが Windows によって中止される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-174">Background tasks that use [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) might be canceled by Windows when certain policy requirements are no longer met, including a maximum amount of background time (wall clock time).</span></span> <span data-ttu-id="5f912-175">バックグラウンド タスクを使って周辺機器を操作するときは、これらのポリシー要件を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-175">It's important to consider these policy requirements when using these background tasks to interact with your peripheral device.</span></span>

<span data-ttu-id="5f912-176">**ヒント:** これらのバック グラウンド タスクの動作を確認するには、サンプルをダウンロードします。</span><span class="sxs-lookup"><span data-stu-id="5f912-176">**Tip**To see how these background tasks work, download a sample.</span></span> <span data-ttu-id="5f912-177">PC でこれを実行する方法を示す例については、[カスタム USB デバイスのサンプルに関するページ](http://go.microsoft.com/fwlink/p/?LinkId=301975 ) をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-177">For an example that shows how this is done on a PC, see the [Custom USB device sample](http://go.microsoft.com/fwlink/p/?LinkId=301975 ).</span></span> <span data-ttu-id="5f912-178">電話の例は、[バックグラウンド センサーのサンプル](http://go.microsoft.com/fwlink/p/?LinkId=393307) に関するページをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-178">For an example on a phone, see the [Background Sensors sample](http://go.microsoft.com/fwlink/p/?LinkId=393307).</span></span>
 
## <a name="frequency-and-foreground-restrictions"></a><span data-ttu-id="5f912-179">頻度とフォアグランドの制限</span><span class="sxs-lookup"><span data-stu-id="5f912-179">Frequency and foreground restrictions</span></span>

<span data-ttu-id="5f912-180">アプリが操作を実行する頻度に制限はありません。ただし、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスク操作は一度に 1 つしか実行できません (他の種類のバックグラウンド タスクには影響しません)。また、バックグラウンド タスクを開始できるのは、アプリがフォアグラウンドで動作しているときだけです。</span><span class="sxs-lookup"><span data-stu-id="5f912-180">There is no restriction on the frequency with which your app can initiate operations, but your app can run only one [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task operation at a time (this does not affect other types of background tasks), and can initiate a background task only while your app is in the foreground.</span></span> <span data-ttu-id="5f912-181">アプリがフォアグラウンドにない場合は、**DeviceUseTrigger** を使うバックグラウンド タスクを開始することはできません。</span><span class="sxs-lookup"><span data-stu-id="5f912-181">When your app isn't in the foreground, it is unable to initiate a background task with **DeviceUseTrigger**.</span></span> <span data-ttu-id="5f912-182">実行中のバックグラウンド タスクが完了した後でなければ、次の **DeviceUseTrigger** バックグラウンド タスクを開始できません。</span><span class="sxs-lookup"><span data-stu-id="5f912-182">Your app can't initiate a second **DeviceUseTrigger** background task before the first background task has completed.</span></span>

## <a name="device-restrictions"></a><span data-ttu-id="5f912-183">デバイスの制限</span><span class="sxs-lookup"><span data-stu-id="5f912-183">Device restrictions</span></span>

<span data-ttu-id="5f912-184">各アプリは [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクの登録と実行は 1 つのみに制限されていますが、(アプリが実行される) デバイスでは、複数のアプリに複数の **DeviceUseTrigger** バックグラウンド タスクの登録と実行が許可されている場合があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-184">While each app is limited to registering and running only one [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task, the device (on which your app is running) may allow multiple apps to register and run **DeviceUseTrigger** background tasks.</span></span> <span data-ttu-id="5f912-185">デバイスによっては、すべてのアプリの **DeviceUseTrigger** バックグラウンド タスクの合計数に制限があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-185">Depending on the device, there may be a limit on the total number of **DeviceUseTrigger** background tasks from all apps.</span></span> <span data-ttu-id="5f912-186">これにより、リソースに制約のあるデバイスでバッテリを節約できます。</span><span class="sxs-lookup"><span data-stu-id="5f912-186">This helps preserve battery on resource-constrained devices.</span></span> <span data-ttu-id="5f912-187">詳しくは、次の表をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-187">See the following table for more details.</span></span>

<span data-ttu-id="5f912-188">1 つの [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクから、アプリは周辺機器またはセンサーに数の制限なくアクセスできます。唯一の制限は、前の表に記載されているサポートされるプロトコルと API によるものです。</span><span class="sxs-lookup"><span data-stu-id="5f912-188">From a single [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task, your app can access an unlimited number of peripheral devices or sensors - limited only by the supported APIs and protocols that were listed in the previous table.</span></span>

## <a name="background-task-policies"></a><span data-ttu-id="5f912-189">バックグラウンド タスクのポリシー</span><span class="sxs-lookup"><span data-stu-id="5f912-189">Background task policies</span></span>

<span data-ttu-id="5f912-190">アプリが [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを使うときは Windows のポリシーが適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-190">Windows enforces policies when your app uses a [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task.</span></span> <span data-ttu-id="5f912-191">これらのポリシーが満たされない場合は、バックグラウンド タスクが中止される場合があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-191">If these policies aren't met, the background task might be canceled.</span></span> <span data-ttu-id="5f912-192">このようなバックグラウンド タスクを使ってデバイスやセンサーを操作するときは、これらのポリシー要件を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-192">It's important to consider these policy requirements when using this type of background task to interact with devices or sensors.</span></span>

### <a name="task-initiation-policies"></a><span data-ttu-id="5f912-193">タスク開始のポリシー</span><span class="sxs-lookup"><span data-stu-id="5f912-193">Task initiation policies</span></span>

<span data-ttu-id="5f912-194">次の表は、ユニバーサル Windows アプリに適用されるタスク開始ポリシーを示しています。</span><span class="sxs-lookup"><span data-stu-id="5f912-194">This table indicates which task initiation policies apply to a Universal Windows app.</span></span>

| <span data-ttu-id="5f912-195">ポリシー</span><span class="sxs-lookup"><span data-stu-id="5f912-195">Policy</span></span> | <span data-ttu-id="5f912-196">ユニバーサル Windows アプリの DeviceUseTrigger</span><span class="sxs-lookup"><span data-stu-id="5f912-196">DeviceUseTrigger in a Universal Windows app</span></span> |
|--------|---------------------------------------------|
| <span data-ttu-id="5f912-197">バックグラウンド タスクを開始するとき、アプリがフォアグラウンドで動作している。</span><span class="sxs-lookup"><span data-stu-id="5f912-197">Your app is in the foreground when triggering the background task.</span></span> | ![ポリシーが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-199">対象デバイスがシステムに接続されている (ワイヤレス デバイスの場合は、接続範囲内にある)。</span><span class="sxs-lookup"><span data-stu-id="5f912-199">The device is attached to the system (or in range for a wireless device).</span></span> | ![ポリシーが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-201">サポートされているデバイスの周辺機器用 API (USB、HID、Bluetooth、センサーなどでは Windows ランタイム API) を使って、アプリが対象デバイスにアクセスできる。</span><span class="sxs-lookup"><span data-stu-id="5f912-201">The device is accessible to the app using the supported device peripheral APIs (the Windows Runtime APIs for USB, HID, Bluetooth, Sensors, and so on).</span></span> <span data-ttu-id="5f912-202">アプリがデバイスまたはセンサーにアクセスできない場合、バックグラウンド タスクへのアクセスが拒否されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-202">If your app can't access the device or sensor, access to the background task is denied.</span></span> | ![ポリシーが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-204">アプリで指定されているバックグラウンド タスクのエントリ ポイントがアプリ パッケージ マニフェストに登録されている。</span><span class="sxs-lookup"><span data-stu-id="5f912-204">Background task entry point provided by the app is registered in the app package manifest.</span></span> | ![ポリシーが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-206">アプリごとに [DeviceUseTrigger](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクが 1 つのみ実行されている。</span><span class="sxs-lookup"><span data-stu-id="5f912-206">Only one [DeviceUseTrigger](https://msdn.microsoft.com/library/windows/apps/dn297337) background task is running per app.</span></span> | ![ポリシーが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-208">(アプリが実行されている) デバイスの [DeviceUseTrigger](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクの最大数に達していない。</span><span class="sxs-lookup"><span data-stu-id="5f912-208">The maximum number of [DeviceUseTrigger](https://msdn.microsoft.com/library/windows/apps/dn297337) background tasks has not yet been reached on the device (on which your app is running).</span></span> | <span data-ttu-id="5f912-209">**デスクトップ デバイス ファミリ**: 同時に登録して実行できるタスク数に制限なし。</span><span class="sxs-lookup"><span data-stu-id="5f912-209">**Desktop device family**: An unlimited number of tasks can be registered and run in parallel.</span></span> <span data-ttu-id="5f912-210">**モバイル デバイス ファミリ**: 512 MB デバイスでは 1 タスク。それ以外のデバイスでは 2 タスクを同時に登録して実行可能。</span><span class="sxs-lookup"><span data-stu-id="5f912-210">**Mobile device family**: 1 task on a 512 MB device; otherwise, 2 tasks can be registered and run in parallel.</span></span> |
| <span data-ttu-id="5f912-211">サポートされている API とプロトコルを使う場合は、アプリが 1 つの [DeviceUseTrigger](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクからアクセスできる周辺機器またはセンサーの最大数。</span><span class="sxs-lookup"><span data-stu-id="5f912-211">The maximum number of peripheral devices or sensors that your app can access from a single [DeviceUseTrigger](https://msdn.microsoft.com/library/windows/apps/dn297337) background task, when using the supported APIs/protocols.</span></span> | <span data-ttu-id="5f912-212">無制限</span><span class="sxs-lookup"><span data-stu-id="5f912-212">unlimited</span></span> |
| <span data-ttu-id="5f912-213">バックグラウンド タスクは、400 ミリ秒の CPU 時間を、画面がロックされている場合は 1 分ごとに消費し (1 GHz CPU の場合)、画面がロックされていない場合は 5 分ごとに消費する。</span><span class="sxs-lookup"><span data-stu-id="5f912-213">Your background task consumes 400ms of CPU time (assuming a 1GHz CPU) every minute when the screen is locked, or every 5 minutes when the screen is not locked.</span></span> <span data-ttu-id="5f912-214">このポリシーを満たさない場合、タスクが取り消される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-214">Failure to meet this policy can result in cancellation of your task.</span></span> | ![ポリシーが適用される](images/ap-tools.png) |

### <a name="runtime-policy-checks"></a><span data-ttu-id="5f912-216">実行時のポリシー チェック</span><span class="sxs-lookup"><span data-stu-id="5f912-216">Runtime policy checks</span></span>

<span data-ttu-id="5f912-217">タスクがバックグラウンドで実行されるとき、Windows によって次の実行時ポリシー要件が適用されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-217">Windows enforces the following runtime policy requirements while your task is running in the background.</span></span> <span data-ttu-id="5f912-218">いずれかの実行時要件が満たされなくなった時点で、デバイス バックグラウンド タスクが中止されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-218">If any of the runtime requirements stops being true, Windows will cancel your device background task.</span></span>

<span data-ttu-id="5f912-219">次の表は、ユニバーサル Windows アプリに適用される実行時ポリシーを示しています。</span><span class="sxs-lookup"><span data-stu-id="5f912-219">This table indicates which runtime policies apply to a Universal Windows app.</span></span>

| <span data-ttu-id="5f912-220">ポリシー チェック</span><span class="sxs-lookup"><span data-stu-id="5f912-220">Policy check</span></span> | <span data-ttu-id="5f912-221">ユニバーサル Windows アプリの DeviceUseTrigger</span><span class="sxs-lookup"><span data-stu-id="5f912-221">DeviceUseTrigger in a Universal Windows app</span></span> |
|--------------|:-------------------------------------------:|
| <span data-ttu-id="5f912-222">対象デバイスがシステムに接続されている (ワイヤレス デバイスの場合は、接続範囲内にある)。</span><span class="sxs-lookup"><span data-stu-id="5f912-222">The device is attached to the system (or in range for a wireless device).</span></span> | ![ポリシー チェックが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-224">デバイスに対して標準的な I/O を実行する (5 秒ごとに 1 I/O)。</span><span class="sxs-lookup"><span data-stu-id="5f912-224">Task is performing regular I/O to the device (1 I/O every 5 seconds).</span></span> | ![ポリシー チェックが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-226">アプリがタスクを中止していない。</span><span class="sxs-lookup"><span data-stu-id="5f912-226">App has not canceled the task.</span></span> | ![ポリシー チェックが適用される](images/ap-tools.png) |
| <span data-ttu-id="5f912-228">実時間の制限 (アプリがバックグラウンドでタスクを実行できる最長時間)。</span><span class="sxs-lookup"><span data-stu-id="5f912-228">Wall-clock time limit – the total amount of time your app’s task can run in the background.</span></span> | <span data-ttu-id="5f912-229">**デスクトップ デバイス ファミリ**: : 10 分。</span><span class="sxs-lookup"><span data-stu-id="5f912-229">**Desktop device family**: 10 minutes.</span></span> <span data-ttu-id="5f912-230">**モバイル デバイス ファミリ** : 時間制限なし。</span><span class="sxs-lookup"><span data-stu-id="5f912-230">**Mobile device family**: No time limit.</span></span> <span data-ttu-id="5f912-231">リソースを節約するには、同時に実行できるタスクを 1 つか 2 つに制限。</span><span class="sxs-lookup"><span data-stu-id="5f912-231">To conserve resources, no more than 1 or 2 tasks can execute at once.</span></span> |
| <span data-ttu-id="5f912-232">アプリが終了していない。</span><span class="sxs-lookup"><span data-stu-id="5f912-232">App has not exited.</span></span> | ![ポリシー チェックが適用される](images/ap-tools.png) |

## <a name="best-practices"></a><span data-ttu-id="5f912-234">ベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="5f912-234">Best practices</span></span>

<span data-ttu-id="5f912-235">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを使うアプリのベスト プラクティスを次に示します。</span><span class="sxs-lookup"><span data-stu-id="5f912-235">The following are best practices for apps that use the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background tasks.</span></span>

### <a name="programming-a-background-task"></a><span data-ttu-id="5f912-236">バックグラウンド タスクのプログラミング</span><span class="sxs-lookup"><span data-stu-id="5f912-236">Programming a background task</span></span>

<span data-ttu-id="5f912-237">アプリで [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを使うと、ユーザーがアプリを切り替え、フォアグラウンド アプリが Windows によって中断状態になったとき、フォアグラウンド アプリで開始された同期操作や監視操作をバックグラウンドに引き継ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="5f912-237">Using the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task from your app ensures that any sync or monitoring operations started from your foreground app continue to run in the background if your users switch apps and your foreground app is suspended by Windows.</span></span> <span data-ttu-id="5f912-238">このモデルに従って、バックグラウンド タスクを登録、実行、登録解除することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5f912-238">We recommend that you follow this overall model for registering, triggering, and unregistering your background tasks:</span></span>

1.  <span data-ttu-id="5f912-239">[**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) を呼び出して、アプリがバックグラウンド タスクを要求できるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="5f912-239">Call [**RequestAccessAsync**](https://msdn.microsoft.com/library/windows/apps/hh700485) to check if the app is able to request a background task.</span></span> <span data-ttu-id="5f912-240">この手順は、バックグラウンド タスクを登録する前に実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-240">This must be done before registering a background task.</span></span>

2.  <span data-ttu-id="5f912-241">トリガーを要求する前にバックグランド タスクを登録します。</span><span class="sxs-lookup"><span data-stu-id="5f912-241">Register the background task before requesting the trigger.</span></span>

3.  <span data-ttu-id="5f912-242">進捗状況と完了のイベント ハンドラーをトリガーに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="5f912-242">Connect progress and completion event handlers to your trigger.</span></span> <span data-ttu-id="5f912-243">アプリが中断状態から復帰すると、待機中の進捗イベントまたは完了イベントが渡されます。アプリはこれらのイベントを使用して、バックグラウンド タスクの状態を判断します。</span><span class="sxs-lookup"><span data-stu-id="5f912-243">When your app returns from suspension, Windows will provide your app with any queued progress or completion events that can be used to determine the status of your background tasks.</span></span>

4.  <span data-ttu-id="5f912-244">[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを開始するときは、オープンしているデバイスまたはセンサー オブジェクトを閉じます。それらのデバイスまたはセンサーが解放され、バックグラウンド タスクで使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="5f912-244">Close any open device or sensor objects when you trigger your [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task so that those devices or sensors are free to be opened and used by your background task.</span></span>

5.  <span data-ttu-id="5f912-245">トリガーを登録します。</span><span class="sxs-lookup"><span data-stu-id="5f912-245">Register the trigger.</span></span>

6.  <span data-ttu-id="5f912-246">バックグラウンド タスクからデバイスまたはファイルにアクセスすることでバッテリに与える影響について、慎重に検討します。</span><span class="sxs-lookup"><span data-stu-id="5f912-246">Carefully consider the battery impact of accessing a device or senor from a background task.</span></span> <span data-ttu-id="5f912-247">たとえば、センサーのレポート間隔を頻繁に設定しすぎると、電話のバッテリをすぐに消費するほど頻繁にタスクを実行することになります。</span><span class="sxs-lookup"><span data-stu-id="5f912-247">For example, having the report interval of a sensor run too frequently could cause the task to run so often that it quickly drains a phone's battery.</span></span>

7.  <span data-ttu-id="5f912-248">バックグラウンド タスクが完了したら、登録を解除します。</span><span class="sxs-lookup"><span data-stu-id="5f912-248">When your background task completes, unregister it.</span></span>

8.  <span data-ttu-id="5f912-249">バックグラウンド タスク クラスの中止イベントを登録します。</span><span class="sxs-lookup"><span data-stu-id="5f912-249">Register for cancellation events from your background task class.</span></span> <span data-ttu-id="5f912-250">中止イベントを登録しておけば、Windows またはフォアグラウンド アプリによってバックグランド タスクが中止されたとき、バックグラウンド タスクコードからそのタスクを適切に中止できます。</span><span class="sxs-lookup"><span data-stu-id="5f912-250">Registering for cancellation events will allow your background task code to cleanly stop your running background task when canceled by Windows or your foreground app.</span></span>

9.  <span data-ttu-id="5f912-251">アプリが (中断状態ではなく) 終了した時点で登録を解除し、実行中のタスクを中止します (タスクが不要な場合)。</span><span class="sxs-lookup"><span data-stu-id="5f912-251">On app exit (not suspension), unregister and cancel any running tasks if your app no longer needs them.</span></span> <span data-ttu-id="5f912-252">メモリの少ない電話などリソースに制約のあるシステムでは、この手順を実行することで、他のアプリが [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを使えるようになります。</span><span class="sxs-lookup"><span data-stu-id="5f912-252">On resource-constrained systems, such as low-memory phones, this will allow other apps to use a [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task.</span></span>

    -   <span data-ttu-id="5f912-253">アプリが終了したら、登録を解除して実行中のタスクを中止します。</span><span class="sxs-lookup"><span data-stu-id="5f912-253">When your app exits, unregister and cancel any running tasks.</span></span>

    -   <span data-ttu-id="5f912-254">アプリが終了すると、バックグラウンド タスクが取り消され、既存のイベント ハンドラーが既存のバックグラウンド タスクから切断されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-254">When your app exits, your background tasks will be canceled and any existing event handlers will be disconnected from your existing background tasks.</span></span> <span data-ttu-id="5f912-255">これによって、バックグラウンド タスクの状態を判断できなくなります。</span><span class="sxs-lookup"><span data-stu-id="5f912-255">This prevents you from determining the state of your background tasks.</span></span> <span data-ttu-id="5f912-256">バックグラウンド タスクを登録解除して取り消すことで、キャンセル コードがバックグランド タスクを適切に中止できます。</span><span class="sxs-lookup"><span data-stu-id="5f912-256">Unregistering and canceling the background task will allow your cancellation code to cleanly stop your background tasks.</span></span>

### <a name="cancelling-a-background-task"></a><span data-ttu-id="5f912-257">バックグラウンド タスクの中止</span><span class="sxs-lookup"><span data-stu-id="5f912-257">Cancelling a background task</span></span>

<span data-ttu-id="5f912-258">フォアグラウンド アプリからバックグラウンドで実行中のタスクを中止するには、[**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) バックグラウンド タスクを登録するためにアプリで使っている [**BackgroundTaskRegistration**](https://msdn.microsoft.com/library/windows/apps/br224786) オブジェクトの Unregister メソッドを使います。</span><span class="sxs-lookup"><span data-stu-id="5f912-258">To cancel a task running in the background from your foreground app, use the Unregister method on the [**BackgroundTaskRegistration**](https://msdn.microsoft.com/library/windows/apps/br224786) object you use in your app to register the [**DeviceUseTrigger**](https://msdn.microsoft.com/library/windows/apps/dn297337) background task.</span></span> <span data-ttu-id="5f912-259">**BackgroundTaskRegistration** の [**Unregister**](https://msdn.microsoft.com/library/windows/apps/br229869) メソッドを使ってバックグラウンド タスクを登録解除すると、バックグラウンド タスク インフラストラクチャによってバックグラウンド タスクが取り消されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-259">Unregistering your background task by using the [**Unregister**](https://msdn.microsoft.com/library/windows/apps/br229869) method on **BackgroundTaskRegistration** will cause the background task infrastructure to cancel your background task.</span></span>

<span data-ttu-id="5f912-260">また、[**Unregister**](https://msdn.microsoft.com/library/windows/apps/br229869) メソッドには、現在実行中のバックグラウンド タスク インスタンスを (完了前に) 中断するかどうかを示すブール値 (true または false) が指定されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-260">The [**Unregister**](https://msdn.microsoft.com/library/windows/apps/br229869) method additionally takes a Boolean true or false value to indicate if currently running instances of your background task should be canceled without allowing them to finish.</span></span> <span data-ttu-id="5f912-261">詳しくは、**Unregister** の API リファレンスをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5f912-261">For more info, see the API reference for **Unregister**.</span></span>

<span data-ttu-id="5f912-262">[**Unregister**](https://msdn.microsoft.com/library/windows/apps/br229869) に加え、[**BackgroundTaskDeferral.Complete**](https://msdn.microsoft.com/library/windows/apps/hh700504) も呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="5f912-262">In addition to [**Unregister**](https://msdn.microsoft.com/library/windows/apps/br229869), your app will also need to call [**BackgroundTaskDeferral.Complete**](https://msdn.microsoft.com/library/windows/apps/hh700504).</span></span> <span data-ttu-id="5f912-263">こうすることで、バックグラウンド タスクに関連付けられた非同期操作が終了したことがシステムに通知されます。</span><span class="sxs-lookup"><span data-stu-id="5f912-263">This informs the system that the asynchronous operation associated with a background task has finished.</span></span>
