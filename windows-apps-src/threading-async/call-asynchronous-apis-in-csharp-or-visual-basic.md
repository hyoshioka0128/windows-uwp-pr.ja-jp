---
author: normesta
ms.assetid: 066711E0-D5C4-467E-8683-3CC64EDBCC83
title: C# または Visual Basic での非同期 API の呼び出し
description: ユニバーサル Windows プラットフォーム (UWP) には、時間がかかる可能性がある操作を実行しているときでも、アプリの応答性を保つために、さまざまな非同期 API が用意されています。
ms.author: normesta
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10、UWP、C#、Visual Basic、非同期
ms.localizationpriority: medium
ms.openlocfilehash: 2d9bd5265d72a7a478de8c094cd900072e46a143
ms.sourcegitcommit: cd00bb829306871e5103db481cf224ea7fb613f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/31/2018
ms.locfileid: "5876552"
---
# <a name="call-asynchronous-apis-in-c-or-visual-basic"></a><span data-ttu-id="a64e7-104">C# または Visual Basic での非同期 API の呼び出し</span><span class="sxs-lookup"><span data-stu-id="a64e7-104">Call asynchronous APIs in C# or Visual Basic</span></span>



<span data-ttu-id="a64e7-105">ユニバーサル Windows プラットフォーム (UWP) には、時間がかかる可能性がある操作を実行しているときでも、アプリの応答性を保つために、さまざまな非同期 API が用意されています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-105">The Universal Windows Platform (UWP) includes many asynchronous APIs to ensure that your app remains responsive when it does work that might take an extended amount of time.</span></span> <span data-ttu-id="a64e7-106">このトピックでは、C# または Microsoft Visual Basic で UWP の非同期メソッドを使う方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-106">This topic discusses how to use asynchronous methods from the UWP in C# or Microsoft Visual Basic.</span></span>

<span data-ttu-id="a64e7-107">非同期 API を使うと、アプリは、大量の操作が完了するのを待たずに実行を継続できます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-107">Asynchronous APIs keep your app from waiting for large operations to complete before continuing execution.</span></span> <span data-ttu-id="a64e7-108">たとえば、インターネットから情報をダウンロードするアプリは、情報が到着するまで数秒待機する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-108">For example, an app that downloads info from the Internet might spend several seconds waiting for the info to arrive.</span></span> <span data-ttu-id="a64e7-109">同期メソッドを使って情報を取得すると、アプリはメソッドから制御が返されるまでブロックされます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-109">If you use a synchronous method to retrieve the info, the app is blocked until the method returns.</span></span> <span data-ttu-id="a64e7-110">アプリが操作に応答せず、応答していないと思ったユーザーが苛立ちを感じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-110">The app won't respond to user interaction and because it seems non-responsive, the user might become frustrated.</span></span> <span data-ttu-id="a64e7-111">非同期 API を提供することによって、時間のかかる操作の実行時に、UWP でアプリの応答性を保つことができます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-111">By providing asynchronous APIs, the UWP helps to ensure that your app stays responsive to the user when it's performing long operations.</span></span>

<span data-ttu-id="a64e7-112">ユニバーサル Windows プラットフォーム (UWP) のほとんどの非同期 API には、対応する同期 API がありません。そのため、UWP アプリで C# または Visual Basic を使って非同期 API を利用する方法を理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-112">Most of the asynchronous APIs in the UWP don't have synchronous counterparts, so you need to be sure to understand how to use the asynchronous APIs with C# or Visual Basic in your Universal Windows Platform (UWP) app.</span></span> <span data-ttu-id="a64e7-113">次に、UWP の非同期 API を呼び出す方法を示します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-113">Here we show how to call asynchronous APIs of the UWP.</span></span>

## <a name="using-asynchronous-apis"></a><span data-ttu-id="a64e7-114">非同期 API の使用</span><span class="sxs-lookup"><span data-stu-id="a64e7-114">Using asynchronous APIs</span></span>


<span data-ttu-id="a64e7-115">非同期メソッドには、表記の規則により "Async" で終わる名前が付いています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-115">By convention, asynchronous methods are given names that end in "Async".</span></span> <span data-ttu-id="a64e7-116">通常、非同期 API は、ユーザーがボタンをクリックしたときなど、ユーザーの操作に応じて呼び出します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-116">You typically call asynchronous APIs in response to a user's action, such as when the user clicks a button.</span></span> <span data-ttu-id="a64e7-117">イベント ハンドラーでの非同期メソッドの呼び出しは、最も簡単な非同期 API の使用方法の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="a64e7-117">Calling an asynchronous method in an event handler is one of the simplest ways of using asynchronous APIs.</span></span> <span data-ttu-id="a64e7-118">ここでは、例として **await** 演算子を使います。</span><span class="sxs-lookup"><span data-stu-id="a64e7-118">Here we use the **await** operator as an example.</span></span>

<span data-ttu-id="a64e7-119">たとえば、ブログ記事の特定の場所にあるタイトルを一覧表示するアプリがあるとします。</span><span class="sxs-lookup"><span data-stu-id="a64e7-119">Suppose that you have an app that lists the titles of blog posts from a certain location.</span></span> <span data-ttu-id="a64e7-120">このアプリには、タイトルを取得する際にユーザーがクリックする [**Button**](https://msdn.microsoft.com/library/windows/apps/BR209265) があります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-120">The app has a [**Button**](https://msdn.microsoft.com/library/windows/apps/BR209265) that the user clicks to get the titles.</span></span> <span data-ttu-id="a64e7-121">タイトルは [**TextBlock**](https://msdn.microsoft.com/library/windows/apps/BR209652) に表示します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-121">The titles are displayed in a [**TextBlock**](https://msdn.microsoft.com/library/windows/apps/BR209652).</span></span> <span data-ttu-id="a64e7-122">ユーザーがボタンをクリックし、ブログの Web サイトからの情報を待っている間、アプリの応答性を保つことが重要です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-122">When the user clicks the button, it is important that the app remains responsive while it waits for the info from the blog's website.</span></span> <span data-ttu-id="a64e7-123">この応答性を保つために、UWP では、フィードをダウンロードするための非同期メソッド [**SyndicationClient.RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460) を提供しています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-123">To ensure this responsiveness, the UWP provides an asynchronous method, [**SyndicationClient.RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460), to download the feed.</span></span>

<span data-ttu-id="a64e7-124">この例では、非同期メソッド [**SyndicationClient.RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460) を呼び出して、その結果を待機し、ブログから記事の一覧を取得します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-124">The example here gets the lists of blog posts from a blog by calling the asynchronous method, [**SyndicationClient.RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460), and awaiting the result.</span></span>

> [!div class="tabbedCodeSnippets" data-resources="OutlookServices.Calendar"]
[!code-csharp[Main](./AsyncSnippets/csharp/MainPage.xaml.cs#SnippetDownloadRSS)]
[!code-vb[Main](./AsyncSnippets/vbnet/MainPage.xaml.vb#SnippetDownloadRSS)]

<span data-ttu-id="a64e7-125">この例には、いくつかの重要なポイントがあります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-125">There are a couple of important things about this example.</span></span> <span data-ttu-id="a64e7-126">まず、`SyndicationFeed feed = await client.RetrieveFeedAsync(feedUri)` の行では、非同期メソッド [**RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460) を呼び出す際に、**await** 演算子が使われています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-126">First, the line, `SyndicationFeed feed = await client.RetrieveFeedAsync(feedUri)` uses the **await** operator with the call to the asynchronous method, [**RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460).</span></span> <span data-ttu-id="a64e7-127">**await** 演算子は、非同期メソッドを呼び出していることをコンパイラに伝えていると考えることができます。これにより、コンパイラが追加作業を行うようになります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-127">You can think of the **await** operator as telling the compiler that you are calling an asynchronous method, which causes the compiler to do some extra work so you don’t have to.</span></span> <span data-ttu-id="a64e7-128">もう 1 つは、イベント ハンドラーの宣言に **async** というキーワードが含まれている点です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-128">Next, the declaration of the event handler includes the keyword **async**.</span></span> <span data-ttu-id="a64e7-129">**await** 演算子を使うメソッドのメソッド宣言には、このキーワードを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-129">You must include this keyword in the method declaration of any method in which you use the **await** operator.</span></span>

<span data-ttu-id="a64e7-130">このトピックでは、コンパイラでの **await** 演算子の処理方法については詳しく取り上げませんが、非同期で応答性を保つためにアプリが何を行っているか説明していきます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-130">In this topic, we won't go into a lot of the details of what the compiler does with the **await** operator, but let's examine what your app does so that it is asynchronous and responsive.</span></span> <span data-ttu-id="a64e7-131">同期コードを使った場合はどうなるか考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="a64e7-131">Consider what happens when you use synchronous code.</span></span> <span data-ttu-id="a64e7-132">たとえば、同期の `SyndicationClient.RetrieveFeed` というメソッドがあるとします </span><span class="sxs-lookup"><span data-stu-id="a64e7-132">For example, suppose that there is a method called `SyndicationClient.RetrieveFeed` that is synchronous.</span></span> <span data-ttu-id="a64e7-133">(このようなメソッドは存在しませんが、ここではあると仮定します)。アプリに `SyndicationFeed feed = await client.RetrieveFeedAsync(feedUri)` という行ではなく `SyndicationFeed feed = client.RetrieveFeed(feedUri)` という行が含まれている場合は、`RetrieveFeed` の戻り値が使用可能になるまで、アプリの実行が停止します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-133">(There is no such method, but imagine that there is.) If your app included the line `SyndicationFeed feed = client.RetrieveFeed(feedUri)`, instead of `SyndicationFeed feed = await client.RetrieveFeedAsync(feedUri)`, execution of the app would stop until the return value of `RetrieveFeed` is available.</span></span> <span data-ttu-id="a64e7-134">アプリは、このメソッドが完了するのを待機している間、他のイベント (別の [**Click**](https://msdn.microsoft.com/library/windows/apps/BR227737) イベントなど) には応答できません。</span><span class="sxs-lookup"><span data-stu-id="a64e7-134">And while your app waits for the method to complete, it can't respond to any other events, such another [**Click**](https://msdn.microsoft.com/library/windows/apps/BR227737) event.</span></span> <span data-ttu-id="a64e7-135">つまり、`RetrieveFeed` が戻るまで、アプリはブロックされます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-135">That is, your app would be blocked until `RetrieveFeed` returns.</span></span>

<span data-ttu-id="a64e7-136">しかし、`client.RetrieveFeedAsync` メソッドは、呼び出されると、取得を開始して直ちに戻ります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-136">But if you call `client.RetrieveFeedAsync`, the method initiates the retrieval and immediately returns.</span></span> <span data-ttu-id="a64e7-137">[**RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460) と一緒に **await** を使うと、アプリが一時的にイベント ハンドラーを終了します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-137">When you use **await** with [**RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460), the app temporarily exits the event handler.</span></span> <span data-ttu-id="a64e7-138">このとき、**RetrieveFeedAsync** を非同期で実行しながら、他のイベントを処理することができます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-138">Then it can process other events while **RetrieveFeedAsync** executes asynchronously.</span></span> <span data-ttu-id="a64e7-139">これにより、アプリの応答性が維持されます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-139">This keeps the app responsive to the user.</span></span> <span data-ttu-id="a64e7-140">**RetrieveFeedAsync** が完了し、[**SyndicationFeed**](https://msdn.microsoft.com/library/windows/apps/BR243485) が使用可能になると、アプリは、実質的に中断したイベント ハンドラーに戻り、`SyndicationFeed feed = await client.RetrieveFeedAsync(feedUri)` の後の残りのメソッドを完了します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-140">When **RetrieveFeedAsync** completes and the [**SyndicationFeed**](https://msdn.microsoft.com/library/windows/apps/BR243485) is available, the app essentially reenters the event handler where it left off, after `SyndicationFeed feed = await client.RetrieveFeedAsync(feedUri)`, and finishes the rest of the method.</span></span>

<span data-ttu-id="a64e7-141">**await** 演算子を使うメリットは、架空の `RetrieveFeed` メソッドを使った場合のコードとそれほど違いがないという点です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-141">The nice thing about using the **await** operator is that the code doesn't look much different from how the code looks if you used the imaginary `RetrieveFeed` method.</span></span> <span data-ttu-id="a64e7-142">C# または Visual Basic で **await** 演算子を使わずに非同期コードを記述する方法もありますが、このようなコードでは、非同期で実行するしくみに重点が置かれる傾向があります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-142">There are ways to write asynchronous code in C# or Visual Basic without the **await** operator, but the resulting code tends to emphasize the mechanics of executing asynchronously.</span></span> <span data-ttu-id="a64e7-143">これにより、非同期コードが記述しづらく、わかりにくく、保守しにくいものになります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-143">This makes asynchronous code hard to write, hard to understand, and hard to maintain.</span></span> <span data-ttu-id="a64e7-144">**await** 演算子を使うことによって、コードが複雑になることなく、非同期アプリのメリットを享受できます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-144">By using the **await** operator, you get the benefits of an asynchronous app without making your code complex.</span></span>

## <a name="return-types-and-results-of-asynchronous-apis"></a><span data-ttu-id="a64e7-145">戻り値の型と非同期 API の結果</span><span class="sxs-lookup"><span data-stu-id="a64e7-145">Return types and results of asynchronous APIs</span></span>


<span data-ttu-id="a64e7-146">[**RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460) へのリンクをたどると、**RetrieveFeedAsync** の戻り値の型が [**SyndicationFeed**](https://msdn.microsoft.com/library/windows/apps/BR243485) ではないことがわかると思います。</span><span class="sxs-lookup"><span data-stu-id="a64e7-146">If you followed the link to [**RetrieveFeedAsync**](https://msdn.microsoft.com/library/windows/apps/BR243460), you might have noticed that the return type of **RetrieveFeedAsync** is not a [**SyndicationFeed**](https://msdn.microsoft.com/library/windows/apps/BR243485).</span></span> <span data-ttu-id="a64e7-147">戻り値の型は、`IAsyncOperationWithProgress<SyndicationFeed, RetrievalProgress>` になります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-147">Instead, the return type is `IAsyncOperationWithProgress<SyndicationFeed, RetrievalProgress>`.</span></span> <span data-ttu-id="a64e7-148">構文そのものを見ると、非同期 API は結果を含むオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-148">Viewed from the raw syntax, an asynchronous API returns an object that contains the result within it.</span></span> <span data-ttu-id="a64e7-149">非同期メソッドが待機可能であると考えることは一般的であり、有用な場合もありますが、**await** 演算子は、実際にはメソッドではなくメソッドの戻り値を制御します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-149">While it is common, and sometimes useful, to think of an asynchronous method as being awaitable, the **await** operator actually operates on the method’s return value, not on the method.</span></span> <span data-ttu-id="a64e7-150">**await** 演算子を適用すると、メソッドによって返されるオブジェクトの **GetResult** を呼び出した結果が取得されます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-150">When you apply the **await** operator, what you get back is the result of calling **GetResult** on the object returned by the method.</span></span> <span data-ttu-id="a64e7-151">この例では、**SyndicationFeed** は **RetrieveFeedAsync.GetResult()** の結果です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-151">In the example, the **SyndicationFeed** is the result of **RetrieveFeedAsync.GetResult()**.</span></span>

<span data-ttu-id="a64e7-152">非同期メソッドを使うと、シグネチャを調べて、メソッドから返される値を待機した後でどのようなデータを取得したかを確認することができます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-152">When you use an asynchronous method, you can examine the signature to see what you’ll get back after awaiting the value returned from the method.</span></span> <span data-ttu-id="a64e7-153">UWP の各非同期 API は、次のいずれかの型を返します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-153">All asynchronous APIs in the UWP return one of the following types:</span></span>

-   [**<span data-ttu-id="a64e7-154">IAsyncOperation&lt;TResult&gt;</span><span class="sxs-lookup"><span data-stu-id="a64e7-154">IAsyncOperation&lt;TResult&gt;</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR206598)
-   [**<span data-ttu-id="a64e7-155">IAsyncOperationWithProgress&lt;TResult, TProgress&gt;</span><span class="sxs-lookup"><span data-stu-id="a64e7-155">IAsyncOperationWithProgress&lt;TResult, TProgress&gt;</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR206594)
-   [**<span data-ttu-id="a64e7-156">IAsyncAction</span><span class="sxs-lookup"><span data-stu-id="a64e7-156">IAsyncAction</span></span>**](https://msdn.microsoft.com/library/windows/apps/windows.foundation.iasyncaction.aspx)
-   [**<span data-ttu-id="a64e7-157">IAsyncActionWithProgress&lt;TProgress&gt;</span><span class="sxs-lookup"><span data-stu-id="a64e7-157">IAsyncActionWithProgress&lt;TProgress&gt;</span></span>**](https://msdn.microsoft.com/library/windows/apps/br206581.aspx)

<span data-ttu-id="a64e7-158">非同期メソッドの結果の型は、`      TResult` 型パラメーターと同じです。</span><span class="sxs-lookup"><span data-stu-id="a64e7-158">The result type of an asynchronous method is the same as the `      TResult` type parameter.</span></span> <span data-ttu-id="a64e7-159">`TResult` のない型には結果がありません。</span><span class="sxs-lookup"><span data-stu-id="a64e7-159">Types without a `TResult` don't have a result.</span></span> <span data-ttu-id="a64e7-160">その場合の結果は **void** と見なすことができます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-160">You can think of the result as being **void**.</span></span> <span data-ttu-id="a64e7-161">Visual Basic の [Sub](https://msdn.microsoft.com/library/windows/apps/xaml/831f9wka.aspx) プロシージャは、戻り値の型が **void** のメソッドと同じです。</span><span class="sxs-lookup"><span data-stu-id="a64e7-161">In Visual Basic, a [Sub](https://msdn.microsoft.com/library/windows/apps/xaml/831f9wka.aspx) procedure is equivalent to a method with a **void** return type.</span></span>

<span data-ttu-id="a64e7-162">次の表に、非同期メソッドの例と、それぞれの戻り値と結果の型を示します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-162">The table here gives examples of asynchronous methods and lists the return type and result type of each.</span></span>

| <span data-ttu-id="a64e7-163">非同期メソッド</span><span class="sxs-lookup"><span data-stu-id="a64e7-163">Asynchronous method</span></span>                                                                           | <span data-ttu-id="a64e7-164">戻り値の型</span><span class="sxs-lookup"><span data-stu-id="a64e7-164">Return type</span></span>                                                                                                                                        | <span data-ttu-id="a64e7-165">結果の型</span><span class="sxs-lookup"><span data-stu-id="a64e7-165">Result type</span></span>                                       |
|-----------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
| [**<span data-ttu-id="a64e7-166">SyndicationClient.RetrieveFeedAsync</span><span class="sxs-lookup"><span data-stu-id="a64e7-166">SyndicationClient.RetrieveFeedAsync</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR243460)     | [**<span data-ttu-id="a64e7-167">IAsyncOperationWithProgress&lt;SyndicationFeed, RetrievalProgress&gt;</span><span class="sxs-lookup"><span data-stu-id="a64e7-167">IAsyncOperationWithProgress&lt;SyndicationFeed, RetrievalProgress&gt;</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR206594)                                 | [**<span data-ttu-id="a64e7-168">SyndicationFeed</span><span class="sxs-lookup"><span data-stu-id="a64e7-168">SyndicationFeed</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR243485) |
| [**<span data-ttu-id="a64e7-169">FileOpenPicker.PickSingleFileAsync</span><span class="sxs-lookup"><span data-stu-id="a64e7-169">FileOpenPicker.PickSingleFileAsync</span></span>**](https://msdn.microsoft.com/library/windows/apps/JJ635275) | [**<span data-ttu-id="a64e7-170">IAsyncOperation&lt;StorageFile&gt;</span><span class="sxs-lookup"><span data-stu-id="a64e7-170">IAsyncOperation&lt;StorageFile&gt;</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR206598)                                                                                | [**<span data-ttu-id="a64e7-171">StorageFile</span><span class="sxs-lookup"><span data-stu-id="a64e7-171">StorageFile</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR227171)          |
| [**<span data-ttu-id="a64e7-172">XmlDocument.SaveToFileAsync</span><span class="sxs-lookup"><span data-stu-id="a64e7-172">XmlDocument.SaveToFileAsync</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR206284)                 | [**<span data-ttu-id="a64e7-173">IAsyncAction</span><span class="sxs-lookup"><span data-stu-id="a64e7-173">IAsyncAction</span></span>**](https://msdn.microsoft.com/library/windows/apps/windows.foundation.iasyncaction.aspx)                                                                                                           | **<span data-ttu-id="a64e7-174">void</span><span class="sxs-lookup"><span data-stu-id="a64e7-174">void</span></span>**                                          |
| [**<span data-ttu-id="a64e7-175">InkStrokeContainer.LoadAsync</span><span class="sxs-lookup"><span data-stu-id="a64e7-175">InkStrokeContainer.LoadAsync</span></span>**](https://msdn.microsoft.com/library/windows/apps/Hh701757)               | [**<span data-ttu-id="a64e7-176">IAsyncActionWithProgress&lt;UInt64&gt;</span><span class="sxs-lookup"><span data-stu-id="a64e7-176">IAsyncActionWithProgress&lt;UInt64&gt;</span></span>**](https://msdn.microsoft.com/library/windows/apps/br206581.aspx)                                                                   | **<span data-ttu-id="a64e7-177">void</span><span class="sxs-lookup"><span data-stu-id="a64e7-177">void</span></span>**                                          |
| [**<span data-ttu-id="a64e7-178">DataReader.LoadAsync</span><span class="sxs-lookup"><span data-stu-id="a64e7-178">DataReader.LoadAsync</span></span>**](https://msdn.microsoft.com/library/windows/apps/BR208135)                            | <span data-ttu-id="a64e7-179">[**DataReaderLoadOperation**](https://msdn.microsoft.com/library/windows/apps/BR208120)、**IAsyncOperation&lt;UInt32&gt;** を実装するカスタムの結果クラス</span><span class="sxs-lookup"><span data-stu-id="a64e7-179">[**DataReaderLoadOperation**](https://msdn.microsoft.com/library/windows/apps/BR208120), a custom results class that implements **IAsyncOperation&lt;UInt32&gt;**</span></span> | [**<span data-ttu-id="a64e7-180">UInt32</span><span class="sxs-lookup"><span data-stu-id="a64e7-180">UInt32</span></span>**](https://msdn.microsoft.com/library/windows/apps/br206598.aspx)                     |

 

<span data-ttu-id="a64e7-181">「[**UWP アプリの .NET**](https://msdn.microsoft.com/library/windows/apps/xaml/br230232.aspx)」で定義されている非同期メソッドの戻り値の型は [**Task**](https://msdn.microsoft.com/library/windows/apps/xaml/system.threading.tasks.task.aspx) または [**Task&lt;TResult&gt;**](https://msdn.microsoft.com/library/windows/apps/xaml/dd321424.aspx) です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-181">Asynchronous methods that are defined in [**.NET for UWP apps**](https://msdn.microsoft.com/library/windows/apps/xaml/br230232.aspx) have the return type [**Task**](https://msdn.microsoft.com/library/windows/apps/xaml/system.threading.tasks.task.aspx) or [**Task&lt;TResult&gt;**](https://msdn.microsoft.com/library/windows/apps/xaml/dd321424.aspx).</span></span> <span data-ttu-id="a64e7-182">**Task** を返すメソッドは、[**IAsyncAction**](https://msdn.microsoft.com/library/windows/apps/windows.foundation.iasyncaction.aspx) を返す UWP の非同期メソッドに似ています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-182">Methods that return **Task** are similar to the asynchronous methods in the UWP that return [**IAsyncAction**](https://msdn.microsoft.com/library/windows/apps/windows.foundation.iasyncaction.aspx).</span></span> <span data-ttu-id="a64e7-183">どちらの場合も、非同期メソッドの結果は **void** です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-183">In each case, the result of the asynchronous method is **void**.</span></span> <span data-ttu-id="a64e7-184">戻り値の型 **Task&lt;TResult&gt;** は、タスク実行時の非同期メソッドの結果が `TResult` 型パラメーターと同じ型であるという点で、[**IAsyncOperation&lt;TResult&gt;**](https://msdn.microsoft.com/library/windows/apps/BR206598) に似ています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-184">The return type **Task&lt;TResult&gt;** is similar to [**IAsyncOperation&lt;TResult&gt;**](https://msdn.microsoft.com/library/windows/apps/BR206598) in that the result of the asynchronous method when running the task is the same type as the `TResult` type parameter.</span></span> <span data-ttu-id="a64e7-185">**UWP アプリ用 .NET** とタスクの使い方について詳しくは、「[Windows ランタイム アプリ用 .NET の概要](https://msdn.microsoft.com/library/windows/apps/xaml/br230302.aspx)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a64e7-185">For more info about using **.NET for UWP apps** and tasks, see [.NET for Windows Runtime apps overview](https://msdn.microsoft.com/library/windows/apps/xaml/br230302.aspx).</span></span>

## <a name="handling-errors"></a><span data-ttu-id="a64e7-186">エラーの処理</span><span class="sxs-lookup"><span data-stu-id="a64e7-186">Handling errors</span></span>


<span data-ttu-id="a64e7-187">**await** 演算子を使って非同期メソッドから結果を取得する場合は、同期メソッドの場合と同じように、**try/catch** ブロックを使って非同期メソッドで発生するエラーを処理できます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-187">When you use the **await** operator to retrieve your results from an asynchronous method, you can use a **try/catch** block to handle errors that occur in asynchronous methods, just as you do for synchronous methods.</span></span> <span data-ttu-id="a64e7-188">前の例では、**RetrieveFeedAsync** メソッドと **await** 操作が **try/catch** ブロックでラップされて、例外がスローされたときにエラーを処理するようになっています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-188">The previous example wraps the **RetrieveFeedAsync** method and **await** operation in a **try/catch** block to handle errors when an exception is thrown.</span></span>

<span data-ttu-id="a64e7-189">非同期メソッドが他の非同期メソッドを呼び出している場合は、例外が発生した非同期メソッドが外側のメソッドに伝達されます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-189">When asynchronous methods call other asynchronous methods, any asynchronous method that results in an exception will be propagated to the outer methods.</span></span> <span data-ttu-id="a64e7-190">つまり、最も外側のメソッドで **try/catch** ブロックを使うと、入れ子になっている非同期メソッドのエラーをキャッチできます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-190">This means that you can put a **try/catch** block on the outer-most method to catch errors for the nested asynchronous methods.</span></span> <span data-ttu-id="a64e7-191">これも、同期メソッドで例外をキャッチする方法と同様です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-191">Again, this is similar to how you catch exceptions for synchronous methods.</span></span> <span data-ttu-id="a64e7-192">ただし、**catch** ブロックで **await** を使うことはできません。</span><span class="sxs-lookup"><span data-stu-id="a64e7-192">However, you can't use **await** in the **catch** block.</span></span>

<span data-ttu-id="a64e7-193">**ヒント:** 以降では、Microsoft Visual Studio2005 c# では、 **await**で使える**catch**ブロックします。</span><span class="sxs-lookup"><span data-stu-id="a64e7-193">**Tip**Starting with C# in Microsoft Visual Studio2005, you can use **await** in the **catch** block.</span></span>

## <a name="summary-and-next-steps"></a><span data-ttu-id="a64e7-194">要約と次のステップ</span><span class="sxs-lookup"><span data-stu-id="a64e7-194">Summary and next steps</span></span>

<span data-ttu-id="a64e7-195">ここで説明した非同期メソッドの呼び出しのパターンは、イベント ハンドラーで非同期 API を呼び出す場合に使う最も簡単な方法です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-195">The pattern of calling an asynchronous method that we show here is the simplest one to use when you call asynchronous APIs in an event handler.</span></span> <span data-ttu-id="a64e7-196">このパターンは、**void** または **Sub** (Visual Basic) を返すオーバーライドされたメソッドで非同期メソッドを呼び出す場合にも使うことができます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-196">You can also use this pattern when you call an asynchronous method in an overridden method that returns **void** or a **Sub** in Visual Basic.</span></span>

<span data-ttu-id="a64e7-197">UWP で非同期メソッドを使う場合は、次の点を忘れないでください。</span><span class="sxs-lookup"><span data-stu-id="a64e7-197">As you encounter asynchronous methods in the UWP, it is important to remember:</span></span>

-   <span data-ttu-id="a64e7-198">非同期メソッドには、表記の規則により "Async" で終わる名前が付いています。</span><span class="sxs-lookup"><span data-stu-id="a64e7-198">By convention, asynchronous methods are given names that end in "Async".</span></span>
-   <span data-ttu-id="a64e7-199">**await** 演算子を使うメソッドには、**async** キーワードでマークされた宣言が必要です。</span><span class="sxs-lookup"><span data-stu-id="a64e7-199">Any method that uses the **await** operator must have its declaration marked with the **async** keyword.</span></span>
-   <span data-ttu-id="a64e7-200">アプリは、**await** 演算子を見つけると、非同期メソッドの実行中もユーザー操作への応答性を保ちます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-200">When an app finds the **await** operator, the app remains responsive to user interaction while the asynchronous method executes.</span></span>
-   <span data-ttu-id="a64e7-201">非同期メソッドによって返される値を待機しているときに、結果を含むオブジェクトが返されます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-201">Awaiting the value returned by an asynchronous method returns an object that contains the result.</span></span> <span data-ttu-id="a64e7-202">一般的には、戻り値に含まれている結果は有用なデータであり、戻り値そのものではありません。</span><span class="sxs-lookup"><span data-stu-id="a64e7-202">In most cases, the result contained within the return value is what's useful, not the return value itself.</span></span> <span data-ttu-id="a64e7-203">結果に含まれている値の型は、非同期メソッドの戻り値の型を調べればわかります。</span><span class="sxs-lookup"><span data-stu-id="a64e7-203">You can find the type of the value that is contained inside the result by looking at the return type of the async method.</span></span>
-   <span data-ttu-id="a64e7-204">非同期 API と **async** パターンを使うことにより、多くの場合、アプリの応答性が向上します。</span><span class="sxs-lookup"><span data-stu-id="a64e7-204">Using asynchronous APIs and **async** patterns is often a way to improve the responsiveness of your app.</span></span>

<span data-ttu-id="a64e7-205">このトピックの例では、次のようなテキストが出力されます。</span><span class="sxs-lookup"><span data-stu-id="a64e7-205">The example in this topic outputs text that looks like this.</span></span>

``` syntax
Windows Experience Blog
PC Snapshot: Sony VAIO Y, 8/9/2011 10:26:56 AM -07:00
Tech Tuesday Live Twitter #Chat: Too Much Tech #win7tech, 8/8/2011 12:48:26 PM -07:00
Windows 7 themes: what’s new and what’s popular!, 8/4/2011 11:56:28 AM -07:00
PC Snapshot: Toshiba Satellite A665 3D, 8/2/2011 8:59:15 AM -07:00
Time for new school supplies? Find back-to-school deals on Windows 7 PCs and Office 2010, 8/1/2011 2:14:40 PM -07:00
Best PCs for blogging (or working) on the go, 8/1/2011 10:08:14 AM -07:00
Tech Tuesday – Blogging Tips and Tricks–#win7tech, 8/1/2011 9:35:54 AM -07:00
PC Snapshot: Lenovo IdeaPad U460, 7/29/2011 9:23:05 AM -07:00
GIVEAWAY: Survive BlogHer with a Sony VAIO SA and a Samsung Focus, 7/28/2011 7:27:14 AM -07:00
3 Ways to Stay Cool This Summer, 7/26/2011 4:58:23 PM -07:00
Getting RAW support in Photo Gallery & Windows 7 (…and a contest!), 7/26/2011 10:40:51 AM -07:00
Tech Tuesdays Live Twitter Chats: Photography Tips, Tricks and Essentials, 7/25/2011 12:33:06 PM -07:00
3 Tips to Go Green With Your PC, 7/22/2011 9:19:43 AM -07:00
How to: Buy a Green PC, 7/22/2011 9:13:22 AM -07:00
Windows 7 themes: the distinctive artwork of Cheng Ling, 7/20/2011 9:53:07 AM -07:00
```
