---
ms.assetid: 23FE28F1-89C5-4A17-A732-A722648F9C5E
title: 非同期プログラミング
description: このトピックでは、ユニバーサル Windows プラットフォーム (UWP) での非同期プログラミングとでの形式について説明します。 C#、Microsoft Visual Basic .NET、C++、および JavaScript。
ms.date: 05/14/2018
ms.topic: article
keywords: Windows 10、UWP、非同期
ms.localizationpriority: medium
ms.openlocfilehash: 26378473803b8963c0ca85eb414bae798f9607e4
ms.sourcegitcommit: ac7f3422f8d83618f9b6b5615a37f8e5c115b3c4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/29/2019
ms.locfileid: "66371575"
---
# <a name="asynchronous-programming"></a><span data-ttu-id="ca67a-104">非同期プログラミング</span><span class="sxs-lookup"><span data-stu-id="ca67a-104">Asynchronous programming</span></span>
<span data-ttu-id="ca67a-105">このトピックでは、ユニバーサル Windows プラットフォーム (UWP) での非同期プログラミングとでの形式について説明します。 C#、Microsoft Visual Basic .NET、C++、および JavaScript。</span><span class="sxs-lookup"><span data-stu-id="ca67a-105">This topic describes asynchronous programming in the Universal Windows Platform (UWP) and its representation in C#, Microsoft Visual Basic .NET, C++, and JavaScript.</span></span>

<span data-ttu-id="ca67a-106">非同期プログラミングを使うと、アプリが時間のかかる可能性がある操作を実行しているときでも、アプリの応答性を保つことができます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-106">Using asynchronous programming helps your app stay responsive when it does work that might take an extended amount of time.</span></span> <span data-ttu-id="ca67a-107">たとえば、インターネットからコンテンツをダウンロードするアプリは、コンテンツが到着するまで数秒待機する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ca67a-107">For example, an app that downloads content from the Internet might spend several seconds waiting for the content to arrive.</span></span> <span data-ttu-id="ca67a-108">UI スレッドで同期メソッドを使ってコンテンツを取得すると、アプリはメソッドから制御が返されるまでブロックされます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-108">If you used a synchronous method on the UI thread to retrieve the content, the app is blocked until the method returns.</span></span> <span data-ttu-id="ca67a-109">アプリが操作に応答せず、応答していないと思ったユーザーが苛立ちを感じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ca67a-109">The app won't respond to user interaction, and because it seems non-responsive, the user might become frustrated.</span></span> <span data-ttu-id="ca67a-110">これよりもはるかに優れた方法は非同期プログラミングを使うことです。非同期プログラミングでは、アプリは実行を続けて、操作が完了するまで待機している間も UI に応答します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-110">A much better way is to use asynchronous programming, where the app continues to run and respond to the UI while it waits for an operation to complete.</span></span>

<span data-ttu-id="ca67a-111">処理の完了までに時間がかかるメソッドの場合、UWP で非同期プログラミングを使うのは標準で、例外ではありません。</span><span class="sxs-lookup"><span data-stu-id="ca67a-111">For methods that might take a long time to complete, asynchronous programming is the norm and not the exception in the UWP.</span></span> <span data-ttu-id="ca67a-112">JavaScript、 C#、Visual Basic、および C++ 各非同期メソッドの言語サポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-112">JavaScript, C#, Visual Basic, and C++ each provide language support for asynchronous methods.</span></span>

## <a name="asynchronous-programming-in-the-uwp"></a><span data-ttu-id="ca67a-113">UWP での非同期プログラミング</span><span class="sxs-lookup"><span data-stu-id="ca67a-113">Asynchronous programming in the UWP</span></span>
<span data-ttu-id="ca67a-114">多くの機能が UWP など、 [ **MediaCapture** ](https://docs.microsoft.com/uwp/api/Windows.Media.Capture.MediaCapture) Api と[ **StorageFile** ](https://docs.microsoft.com/uwp/api/Windows.Storage.StorageFile) Api は非同期 Api として公開されます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-114">Many UWP features, such as the [**MediaCapture**](https://docs.microsoft.com/uwp/api/Windows.Media.Capture.MediaCapture) APIs and [**StorageFile**](https://docs.microsoft.com/uwp/api/Windows.Storage.StorageFile) APIs, are exposed as asynchronous APIs.</span></span> <span data-ttu-id="ca67a-115">慣例により、非同期 Api の名前は制御が呼び出し元に返された後に実行する可能性の高い、実行の一部であることを示すには、"Async"で終了します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-115">By convention, the names of asynchronous APIs end with "Async" to indicate that part of their execution is likely to take place after control has returned to the caller.</span></span>

<span data-ttu-id="ca67a-116">ユニバーサル Windows プラットフォーム (UWP) アプリで非同期 API を使う場合、コードは一貫した方法で非ブロック呼び出しを行います。</span><span class="sxs-lookup"><span data-stu-id="ca67a-116">When you use asynchronous APIs in your Universal Windows Platform (UWP) app, your code makes non-blocking calls in a consistent way.</span></span> <span data-ttu-id="ca67a-117">これらの非同期パターンを独自の API 定義に実装すると、呼び出し元はコードを理解し、予測可能な方法で使うことができます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-117">When you implement these asynchronous patterns in your own API definitions, callers can understand and use your code in a predictable way.</span></span>

<span data-ttu-id="ca67a-118">次に、非同期 UWP API を呼び出す必要がある一般的なタスクをいくつか示します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-118">Here are some common tasks that require calling asynchronous UWP APIs.</span></span>

-   <span data-ttu-id="ca67a-119">メッセージ ダイアログの表示</span><span class="sxs-lookup"><span data-stu-id="ca67a-119">Displaying a message dialog</span></span>

-   <span data-ttu-id="ca67a-120">ファイル システムの操作 (ファイル ピッカーの表示)</span><span class="sxs-lookup"><span data-stu-id="ca67a-120">Working with the file system, displaying a file picker</span></span>

-   <span data-ttu-id="ca67a-121">インターネットを介したデータの送受信。</span><span class="sxs-lookup"><span data-stu-id="ca67a-121">Sending and receiving data to and from the Internet</span></span>

-   <span data-ttu-id="ca67a-122">ソケット、ストリーム、接続の使用</span><span class="sxs-lookup"><span data-stu-id="ca67a-122">Using sockets, streams, connectivity</span></span>

-   <span data-ttu-id="ca67a-123">予定、連絡先、カレンダーの操作</span><span class="sxs-lookup"><span data-stu-id="ca67a-123">Working with appointments, contacts, calendar</span></span>

-   <span data-ttu-id="ca67a-124">ファイルの種類の操作 (Portable Document Format (PDF) ファイルを開く、画像やメディア形式のデコードなど)。</span><span class="sxs-lookup"><span data-stu-id="ca67a-124">Working with file types, such as opening Portable Document Format (PDF) files or decoding image or media formats</span></span>

-   <span data-ttu-id="ca67a-125">デバイスやサービスの操作</span><span class="sxs-lookup"><span data-stu-id="ca67a-125">Interacting with a device or a service</span></span>

<span data-ttu-id="ca67a-126">UWP の非同期パターンを利用すると、スレッドの明示的な管理を完全に回避できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="ca67a-126">With UWP asynchronous pattern, you may be able to avoid explicitly manage threads at all.</span></span> <span data-ttu-id="ca67a-127">各プログラミング言語では、次に示すように独自の方法で UWP の非同期パターンがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-127">Each programming language supports the asynchronous pattern for the UWP in its own way:</span></span>

| <span data-ttu-id="ca67a-128">プログラミング言語</span><span class="sxs-lookup"><span data-stu-id="ca67a-128">Programming language</span></span> | <span data-ttu-id="ca67a-129">非同期表現</span><span class="sxs-lookup"><span data-stu-id="ca67a-129">Asynchronous representation</span></span>           |
|----------------------|---------------------------------------|
| <span data-ttu-id="ca67a-130">C#</span><span class="sxs-lookup"><span data-stu-id="ca67a-130">C#</span></span>                   | <span data-ttu-id="ca67a-131">**async** キーワード、**await** 演算子</span><span class="sxs-lookup"><span data-stu-id="ca67a-131">**async** keyword, **await** operator</span></span> |
| <span data-ttu-id="ca67a-132">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="ca67a-132">Visual Basic</span></span>         | <span data-ttu-id="ca67a-133">**Async** キーワード、**Await** 演算子</span><span class="sxs-lookup"><span data-stu-id="ca67a-133">**Async** keyword, **Await** operator</span></span> |
| <span data-ttu-id="ca67a-134">C++/WinRT</span><span class="sxs-lookup"><span data-stu-id="ca67a-134">C++/WinRT</span></span>            | <span data-ttu-id="ca67a-135">コルーチンと**co_await**演算子</span><span class="sxs-lookup"><span data-stu-id="ca67a-135">coroutine, and **co_await** operator</span></span>  |
| <span data-ttu-id="ca67a-136">C++/CX</span><span class="sxs-lookup"><span data-stu-id="ca67a-136">C++/CX</span></span>               | <span data-ttu-id="ca67a-137">**task** クラス、 **.then** メソッド</span><span class="sxs-lookup"><span data-stu-id="ca67a-137">**task** class, **.then** method</span></span>      |
| <span data-ttu-id="ca67a-138">JavaScript</span><span class="sxs-lookup"><span data-stu-id="ca67a-138">JavaScript</span></span>           | <span data-ttu-id="ca67a-139">promise オブジェクト、**then** 関数</span><span class="sxs-lookup"><span data-stu-id="ca67a-139">promise object, **then** function</span></span>     |

## <a name="asynchronous-patterns-in-uwp-using-c-and-visual-basic"></a><span data-ttu-id="ca67a-140">C# と Visual Basic を使った UWP での非同期パターン</span><span class="sxs-lookup"><span data-stu-id="ca67a-140">Asynchronous patterns in UWP using C# and Visual Basic</span></span>
<span data-ttu-id="ca67a-141">C# または Visual Basic で書かれたコードのセグメントは、通常は同期して実行されます。つまり、ある行が実行されるときには、その行は次の行が実行される前に完了します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-141">A typical segment of code written in C# or Visual Basic executes synchronously, meaning that when a line executes, it finishes before the next line executes.</span></span> <span data-ttu-id="ca67a-142">以前は非同期実行の Microsoft .NET プログラミング モデルがありましたが、作成されたコードでは、コードで実行しようとしているタスクではなく、非同期コードを実行するしくみに重点が置かれる傾向があります。</span><span class="sxs-lookup"><span data-stu-id="ca67a-142">There have been previous Microsoft .NET programming models for asynchronous execution, but the resulting code tends to emphasize the mechanics of executing asynchronous code instead of focusing on the task that the code is trying to accomplish.</span></span> <span data-ttu-id="ca67a-143">UWP、.NET framework、C# と Visual Basic のコンパイラでは、コードから非同期のしくみを取り出す機能が追加されました。</span><span class="sxs-lookup"><span data-stu-id="ca67a-143">The UWP, .NET framework, and C# and Visual Basic compilers have added features that abstract the asynchronous mechanics out of your code.</span></span> <span data-ttu-id="ca67a-144">これにより、.NET や UWP を使う場合、いつどのように達成するかではなく何を達成するかに重点を置いた非同期コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-144">For .NET and the UWP you can write asynchronous code that focuses on what your code does instead of how and when to do it.</span></span> <span data-ttu-id="ca67a-145">記述される非同期コードは、同期コードに類似しています。</span><span class="sxs-lookup"><span data-stu-id="ca67a-145">Your asynchronous code will look reasonably similar to synchronous code.</span></span> <span data-ttu-id="ca67a-146">詳しくは、「[C# または Visual Basic での非同期 API の呼び出し](call-asynchronous-apis-in-csharp-or-visual-basic.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ca67a-146">For more info, see [Call asynchronous APIs in C# or Visual Basic](call-asynchronous-apis-in-csharp-or-visual-basic.md).</span></span>

## <a name="asynchronous-patterns-in-uwp-with-cwinrt"></a><span data-ttu-id="ca67a-147">C++ UWP での非同期パターン/cli WinRT</span><span class="sxs-lookup"><span data-stu-id="ca67a-147">Asynchronous patterns in UWP with C++/WinRT</span></span>
<span data-ttu-id="ca67a-148">C++、コルーチンを使用する WinRT、/、 **co_await**演算子。</span><span class="sxs-lookup"><span data-stu-id="ca67a-148">With C++/WinRT, you use coroutines, and the **co_await** operator.</span></span> <span data-ttu-id="ca67a-149">詳細については、およびコード例は、次を参照してください。 [C + での非同期プログラミング/cli WinRT](../cpp-and-winrt-apis/concurrency.md)します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-149">For more info, and code examples, see [Asynchronous programming in C++/WinRT](../cpp-and-winrt-apis/concurrency.md).</span></span>

## <a name="asynchronous-patterns-in-uwp-with-ccx"></a><span data-ttu-id="ca67a-150">C++ UWP での非同期パターン/cli CX</span><span class="sxs-lookup"><span data-stu-id="ca67a-150">Asynchronous patterns in UWP with C++/CX</span></span>
<span data-ttu-id="ca67a-151">C++/CX では、非同期プログラミングは [**task クラス**](https://docs.microsoft.com/cpp/parallel/concrt/reference/task-class) とその [**then メソッド**](https://docs.microsoft.com/cpp/parallel/concrt/reference/task-class?view=vs-2017) に基づいています。</span><span class="sxs-lookup"><span data-stu-id="ca67a-151">In C++/CX, asynchronous programming is based on the [**task class**](https://docs.microsoft.com/cpp/parallel/concrt/reference/task-class), and its [**then method**](https://docs.microsoft.com/cpp/parallel/concrt/reference/task-class?view=vs-2017).</span></span> <span data-ttu-id="ca67a-152">構文は JavaScript の promise の構文に似ています。</span><span class="sxs-lookup"><span data-stu-id="ca67a-152">The syntax is similar to that of JavaScript promises.</span></span> <span data-ttu-id="ca67a-153">**task クラス**とそれに関連する型は、スレッド コンテキストの取り消しと管理に使われる機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-153">The **task class** and its related types also provide the capability for cancellation and management of the thread context.</span></span> <span data-ttu-id="ca67a-154">詳細については、次を参照してください。 [C + での非同期プログラミング/cli CX](asynchronous-programming-in-cpp-universal-windows-platform-apps.md)します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-154">For more info, see [Asynchronous programming in C++/CX](asynchronous-programming-in-cpp-universal-windows-platform-apps.md).</span></span>

<span data-ttu-id="ca67a-155">[**作成\_非同期関数**](https://docs.microsoft.com/cpp/parallel/concrt/reference/concurrency-namespace-functions?view=vs-2017) JavaScript または UWP をサポートするその他のすべての言語から使用できる非同期 Api を生成するためのサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-155">The [**create\_async function**](https://docs.microsoft.com/cpp/parallel/concrt/reference/concurrency-namespace-functions?view=vs-2017) provides support for producing asynchronous APIs that can be consumed from JavaScript or any other language that supports the UWP.</span></span> <span data-ttu-id="ca67a-156">詳細については、次を参照してください。 [c++ 非同期操作の作成/cli CX](https://docs.microsoft.com/cpp/parallel/concrt/creating-asynchronous-operations-in-cpp-for-windows-store-apps)します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-156">For more info, see [Creating Asynchronous Operations in C++/CX](https://docs.microsoft.com/cpp/parallel/concrt/creating-asynchronous-operations-in-cpp-for-windows-store-apps).</span></span>

## <a name="asynchronous-patterns-in-uwp-using-javascript"></a><span data-ttu-id="ca67a-157">JavaScript を使った UWP での非同期パターン</span><span class="sxs-lookup"><span data-stu-id="ca67a-157">Asynchronous patterns in UWP using JavaScript</span></span>
<span data-ttu-id="ca67a-158">JavaScript の非同期プログラミングでは、[Common JS Promises/A](https://wiki.commonjs.org/wiki/Promises/A) 提唱の標準に従って、非同期メソッドで promise オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-158">In JavaScript, asynchronous programming follows the [Common JS Promises/A](https://wiki.commonjs.org/wiki/Promises/A) proposed standard by having asynchronous methods return promise objects.</span></span> <span data-ttu-id="ca67a-159">Promise は、UWP と JavaScript 用 Windows ライブラリの両方で使われます。</span><span class="sxs-lookup"><span data-stu-id="ca67a-159">Promises are used in both the UWP and Windows Library for JavaScript.</span></span>

<span data-ttu-id="ca67a-160">promise オブジェクトは、将来取得されたときに値を表します。</span><span class="sxs-lookup"><span data-stu-id="ca67a-160">A promise object represents a value that will be fulfilled in the future.</span></span> <span data-ttu-id="ca67a-161">UWP では、promise オブジェクトをファクトリ関数から取得します。ファクトリ関数には、慣例により "Async" で終わる名前が付いています。</span><span class="sxs-lookup"><span data-stu-id="ca67a-161">In the UWP you get a promise object from a factory function, which by convention has a name that ends with "Async".</span></span>

<span data-ttu-id="ca67a-162">多くの場合、非同期関数の呼び出しは従来の関数の呼び出しと同じくらい簡単です。</span><span class="sxs-lookup"><span data-stu-id="ca67a-162">In many cases, calling an asynchronous function is almost as simple as calling a conventional function.</span></span> <span data-ttu-id="ca67a-163">違いは、結果またはエラーに対するハンドラーの割り当てと操作の開始に [**then**](https://docs.microsoft.com/previous-versions/windows/apps/br229728(v=win.10)) メソッドまたは [**done**](https://docs.microsoft.com/previous-versions/windows/apps/hh701079(v=win.10)) メソッドを使うことです。</span><span class="sxs-lookup"><span data-stu-id="ca67a-163">The difference is that you use the [**then**](https://docs.microsoft.com/previous-versions/windows/apps/br229728(v=win.10)) or the [**done**](https://docs.microsoft.com/previous-versions/windows/apps/hh701079(v=win.10)) method to assign the handlers for results or errors and to start the operation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ca67a-164">関連トピック</span><span class="sxs-lookup"><span data-stu-id="ca67a-164">Related topics</span></span>
* [<span data-ttu-id="ca67a-165">C# または Visual Basic での非同期 API の呼び出し</span><span class="sxs-lookup"><span data-stu-id="ca67a-165">Call asynchronous APIs in C# or Visual Basic</span></span>](call-asynchronous-apis-in-csharp-or-visual-basic.md)
* <span data-ttu-id="ca67a-166">[非同期を使用した非同期プログラミングと Await (c# および Visual Basic)](https://msdn.microsoft.com/library/hh191443(vs.110).aspx)</span><span class="sxs-lookup"><span data-stu-id="ca67a-166">[Asynchronous Programming with Async and Await (C# and Visual Basic)](https://msdn.microsoft.com/library/hh191443(vs.110).aspx)</span></span>
* <span data-ttu-id="ca67a-167">[リバーシ サンプル機能シナリオ: 非同期コード](https://docs.microsoft.com/previous-versions/windows/apps/jj712233(v=win.10))</span><span class="sxs-lookup"><span data-stu-id="ca67a-167">[Reversi sample feature scenarios: asynchronous code](https://docs.microsoft.com/previous-versions/windows/apps/jj712233(v=win.10))</span></span>
