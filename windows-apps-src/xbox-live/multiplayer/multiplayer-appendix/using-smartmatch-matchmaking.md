---
title: SmartMatch マッチメイキングの使用
author: KevinAsgari
description: Xbox Live SmartMatch を使用してマルチプレイヤー ゲームでプレイヤーをマッチングする方法について説明します。
ms.assetid: 10b6413e-51d9-4fec-9110-5e258d291040
ms.author: kevinasg
ms.date: 04/04/2017
ms.topic: article
keywords: Xbox Live, Xbox, ゲーム, UWP, Windows 10, Xbox One, マルチプレイヤー, マッチメイキング, SmartMatch
ms.localizationpriority: medium
ms.openlocfilehash: b14c6b0351363217cd5c7010af1eabdc148a0b9a
ms.sourcegitcommit: 144f5f127fc4fbd852f2f6780ef26054192d68fc
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/03/2018
ms.locfileid: "5975554"
---
# <a name="using-smartmatch-matchmaking"></a><span data-ttu-id="01f44-104">SmartMatch マッチメイキングの使用</span><span class="sxs-lookup"><span data-stu-id="01f44-104">Using SmartMatch Matchmaking</span></span>

<span data-ttu-id="01f44-105">次のフロー チャートは、SmartMatch マッチメイキングのプロセスを示しています。</span><span class="sxs-lookup"><span data-stu-id="01f44-105">The following flow chart illustrates the SmartMatch matchmaking process.</span></span>

![](../../images/multiplayer/Multiplayer_2015_SmartMatch_Matchmaking.png)

## <a name="creating-a-match-ticket-session-and-a-match-ticket"></a><span data-ttu-id="01f44-106">マッチ チケット セッションとマッチ チケットの作成</span><span class="sxs-lookup"><span data-stu-id="01f44-106">Creating a Match Ticket Session and a Match Ticket</span></span>

<span data-ttu-id="01f44-107">マッチメイキングを開始する前に、マッチメイキング "スカウト" が、マッチメイキングに一緒に参加することを希望するユーザーのグループを表す、マッチ チケット セッションを設定します。</span><span class="sxs-lookup"><span data-stu-id="01f44-107">Before starting matchmaking, a matchmaking "scout" sets up a match ticket session to represent the group of people who would like to enter matchmaking together.</span></span> <span data-ttu-id="01f44-108">このグループ内のすべてのユーザーは、**MultiplayerSession.Join メソッド (String, Boolean, Boolean)** を使用してセッションに参加します。</span><span class="sxs-lookup"><span data-stu-id="01f44-108">All users in this group join the session using the **MultiplayerSession.Join Method (String, Boolean, Boolean)**.</span></span>

<span data-ttu-id="01f44-109">チケット セッションが作成され、プレイヤーが設定されたら、タイトルは **MatchmakingService.CreateMatchTicketAsync メソッド**を使用してセッションをマッチメイキング サービスに送信します。</span><span class="sxs-lookup"><span data-stu-id="01f44-109">Once the ticket session has been created and populated with players, the title submits the session to the matchmaking service using the **MatchmakingService.CreateMatchTicketAsync Method**.</span></span> <span data-ttu-id="01f44-110">このメソッドは、チケット セッションを表すマッチ チケットを作成し、チケット セッションの /servers/matchmaking/properties/system/status フィールドを "searching" に更新します。</span><span class="sxs-lookup"><span data-stu-id="01f44-110">This method creates a match ticket that represents the ticket session, and updates the /servers/matchmaking/properties/system/status field in the ticket session to "searching".</span></span> <span data-ttu-id="01f44-111">詳細については、「[方法: マッチ チケットの作成](multiplayer-how-tos.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="01f44-111">For more information, see [How to: Create a Match Ticket](multiplayer-how-tos.md).</span></span>

<span data-ttu-id="01f44-112">マッチ チケット作成メソッドからの応答は **CreateMatchTicketResponse クラス** オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="01f44-112">The response from the match ticket creation method is a **CreateMatchTicketResponse Class** object.</span></span> <span data-ttu-id="01f44-113">この応答には、マッチ チケット ID、チケットの削除によってマッチメイキングをキャンセルするために使用できる GUID が含まれます。</span><span class="sxs-lookup"><span data-stu-id="01f44-113">The response contains the match ticket ID, a GUID that can be used can be used to cancel matchmaking by deleting the ticket.</span></span> <span data-ttu-id="01f44-114">応答にはホッパーの平均待ち時間の情報も含まれ、この情報を使ってユーザーの期待を設定できます。</span><span class="sxs-lookup"><span data-stu-id="01f44-114">The response also contains an average wait time for the hopper, which can be used to set user expectations.</span></span>


## <a name="setting-matchmaking-attributes-on-the-session-and-players"></a><span data-ttu-id="01f44-115">セッションおよびプレイヤーでのマッチメイキング属性の設定</span><span class="sxs-lookup"><span data-stu-id="01f44-115">Setting Matchmaking Attributes on the Session and Players</span></span>

<span data-ttu-id="01f44-116">マッチメイキングへセッションを送信するとき、タイトルは、マッチメイキング サービスがセッションを他のセッションとグループ化するために使用する属性を設定できます。</span><span class="sxs-lookup"><span data-stu-id="01f44-116">When submitting a session to matchmaking, the title can set attributes that the matchmaking service uses to group the session with other sessions.</span></span> <span data-ttu-id="01f44-117">属性は、チケット レベルまたはメンバーごとのレベルで指定できます。</span><span class="sxs-lookup"><span data-stu-id="01f44-117">Attributes can be specified at the ticket level or at the per-member level.</span></span>


### <a name="setting-matchmaking-attributes-at-the-match-ticket-level"></a><span data-ttu-id="01f44-118">マッチ チケット レベルでのマッチメイキング属性の設定</span><span class="sxs-lookup"><span data-stu-id="01f44-118">Setting Matchmaking Attributes at the Match Ticket Level</span></span>

<span data-ttu-id="01f44-119">タイトルは、**MatchmakingService.CreateMatchTicketAsync** メソッドの *ticketAttributesJson* パラメーターで、マッチ チケット レベルでの属性を送信します。</span><span class="sxs-lookup"><span data-stu-id="01f44-119">The title submits attributes at the match ticket level in the *ticketAttributesJson* parameter of the **MatchmakingService.CreateMatchTicketAsync** method.</span></span> <span data-ttu-id="01f44-120">チケット レベルで指定された属性は、メンバーごとのレベルで指定された同じ属性をオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="01f44-120">Attributes specified at the ticket level override the same attributes specified at the per-member level.</span></span>


### <a name="setting-matchmaking-attributes-at-the-per-member-level"></a><span data-ttu-id="01f44-121">メンバーごとのレベルでのマッチメイキング属性の設定</span><span class="sxs-lookup"><span data-stu-id="01f44-121">Setting Matchmaking Attributes at the Per-member Level</span></span>

<span data-ttu-id="01f44-122">タイトルは、マッチ チケット セッション内の各メンバーでメンバーごとの属性を指定します。</span><span class="sxs-lookup"><span data-stu-id="01f44-122">The title specifies per-member attributes on each member within the match ticket session.</span></span> <span data-ttu-id="01f44-123">これらは、**MultiplayerSession.SetCurrentUserMemberCustomPropertyJson メソッド**を呼び出し、プロパティ名 "matchAttrs" を使用して設定されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-123">These are set by calling the **MultiplayerSession.SetCurrentUserMemberCustomPropertyJson Method**, using a property name of "matchAttrs".</span></span> <span data-ttu-id="01f44-124">この呼び出しは、属性をチケット セッション内の各プレイヤーの /members/{index}/properties/custom/matchAttrs フィールドに配置します。</span><span class="sxs-lookup"><span data-stu-id="01f44-124">This call places the attributes in the /members/{index}/properties/custom/matchAttrs field on each player within the ticket session.</span></span>

<span data-ttu-id="01f44-125">マッチメイ キング プロセス均一メンバーごとの各ホッパーの Xbox Live 構成でその属性に対して指定した均一化メソッドに基づいて、単一のチケット レベル属性です。</span><span class="sxs-lookup"><span data-stu-id="01f44-125">The matchmaking process "flattens" per-member each into a single ticket-level attribute, based on the flatten method specified for that attribute in the Xbox Live configuration for the hopper.</span></span> <span data-ttu-id="01f44-126">これは、 [XDP](https://xdp.xboxlive.com)または[Windows デベロッパー センター](https://developer.microsoft.com/dashboard/windows/overview)で構成できます。</span><span class="sxs-lookup"><span data-stu-id="01f44-126">This can be configured on [XDP](https://xdp.xboxlive.com) or [Windows Dev Center](https://developer.microsoft.com/dashboard/windows/overview).</span></span>


## <a name="making-the-match"></a><span data-ttu-id="01f44-127">マッチの実行</span><span class="sxs-lookup"><span data-stu-id="01f44-127">Making the Match</span></span>

<span data-ttu-id="01f44-128">設定されたチケット セッションとマッチ チケットを使用して、マッチメイキング サービスは、表されたチケット セッションを他のグループを表す他のチケット セッションとマッチさせ、マッチ ターゲット セッションを作成または識別します。</span><span class="sxs-lookup"><span data-stu-id="01f44-128">With the ticket session and the match ticket set up, the matchmaking service matches the represented ticket session with other ticket sessions representing other groups, and creates or identifies a match target session.</span></span> <span data-ttu-id="01f44-129">また、サービスは、ターゲット セッションでマッチされたプレイヤーの予約を作成し、チケット セッションをマッチ済みとしてマークします。</span><span class="sxs-lookup"><span data-stu-id="01f44-129">The service also creates reservations for the matched players in the target session, and then marks the ticket sessions as matched.</span></span> <span data-ttu-id="01f44-130">MPSD は、チケット セッションへのこの変更をタイトルに通知します。</span><span class="sxs-lookup"><span data-stu-id="01f44-130">MPSD notifies the title of this change to the ticket session.</span></span>

<span data-ttu-id="01f44-131">次に、タイトルは、十分なプレイヤーが現れたことを確認するためにターゲット セッションを初期化し、サービスの品質 (QoS) チェックを実行してプレイヤーが互いに正しく接続できることを確認するための手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01f44-131">Now the title must then take steps to initialize the target session in order to confirm that enough players have shown up, and perform quality of service (QoS) checks to ensure that they can connect to one another successfully.</span></span> <span data-ttu-id="01f44-132">初期化や QoS が失敗した場合、タイトルは、別のグループを見つけることができるよう、マッチメイキングに再送信するようにチケット セッションをマークします。</span><span class="sxs-lookup"><span data-stu-id="01f44-132">If initialization and/or QoS fails, the title marks the ticket session for resubmission to matchmaking so that another group can be found.</span></span> <span data-ttu-id="01f44-133">プロセスの詳細については、「[ターゲット セッションの初期化と QoS](smartmatch-matchmaking.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="01f44-133">For more information on the processes, see [Target Session Initialization and QoS](smartmatch-matchmaking.md).</span></span>

<span data-ttu-id="01f44-134">マッチ アクティビティ中、以下の変更がセッションの JSON オブジェクトに対して行われます。</span><span class="sxs-lookup"><span data-stu-id="01f44-134">During match activity, the following changes are made to the JSON objects for the session:</span></span>

-   <span data-ttu-id="01f44-135">/servers/matchmaking/properties/system/status フィールドが "found" に設定されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-135">/servers/matchmaking/properties/system/status field set to "found"</span></span>
-   <span data-ttu-id="01f44-136">/servers/matchmaking/properties/system/targetSessionRef フィールドがターゲット セッションに設定されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-136">/servers/matchmaking/properties/system/targetSessionRef field set to target session</span></span>
-   <span data-ttu-id="01f44-137">各チケット セッションの /members/{index}/properties/custom/matchAttrs フィールドが /members/{index}/constants/custom/matchmakingResult/playerAttrs フィールドにコピーされます。</span><span class="sxs-lookup"><span data-stu-id="01f44-137">/members/{index}/properties/custom/matchAttrs field for each ticket session copied to the /members/{index}/constants/custom/matchmakingResult/playerAttrs field</span></span>
-   <span data-ttu-id="01f44-138">各プレイヤーについて、チケット属性がマッチ チケット内の ticketAttributes フィールドから /members/{index}/constants/custom/matchmakingResult/ticketAttrs フィールドにコピーされます。</span><span class="sxs-lookup"><span data-stu-id="01f44-138">For each player, ticket attributes copied from the ticketAttributes field in the match ticket to /members/{index}/constants/custom/matchmakingResult/ticketAttrs field</span></span>


## <a name="maintaining-the-match-ticket"></a><span data-ttu-id="01f44-139">マッチ チケットの維持</span><span class="sxs-lookup"><span data-stu-id="01f44-139">Maintaining the Match Ticket</span></span>

<span data-ttu-id="01f44-140">マッチメイキング サービスは、マッチ チケットがセッションに対して作成されたときのチケット セッションのスナップショットを使用します。</span><span class="sxs-lookup"><span data-stu-id="01f44-140">The matchmaking service uses a snapshot of the ticket session at the time when the match ticket is created for the session.</span></span> <span data-ttu-id="01f44-141">したがって、プレイヤーがチケット セッションに参加した場合やマッチ チケット セッションを抜けた場合、タイトルはマッチメイキング サービスを使用してマッチ チケットを削除し作成しなおす必要があります。</span><span class="sxs-lookup"><span data-stu-id="01f44-141">Thus, if any players join or leave the ticket session, the title must use the matchmaking service to delete and recreate the match ticket.</span></span>


## <a name="reusing-the-game-session-as-a-match-ticket-session"></a><span data-ttu-id="01f44-142">マッチ チケット セッションとしてのゲーム セッションの再利用</span><span class="sxs-lookup"><span data-stu-id="01f44-142">Reusing the Game Session as a Match Ticket Session</span></span>

| <span data-ttu-id="01f44-143">重要</span><span class="sxs-lookup"><span data-stu-id="01f44-143">Important</span></span>                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="01f44-144">*preserveSession* が Always に設定された 2 つのセッションは、組み合わせることができないので、互いにマッチングすることができません。</span><span class="sxs-lookup"><span data-stu-id="01f44-144">It is important to realize that two sessions with *preserveSession* set to Always will not be able to match with each other, since they cannot be combined.</span></span> <span data-ttu-id="01f44-145">タイトルで使用されるマッチメイキング フローではこの事実を考慮に入れる必要があります。</span><span class="sxs-lookup"><span data-stu-id="01f44-145">The matchmaking flow used by the title should take this fact into consideration.</span></span> |

<span data-ttu-id="01f44-146">タイトルはマッチ チケット セッションとしての既存のゲーム セッションを再利用し、既に進行中のゲームに参加する追加のプレイヤーを見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="01f44-146">A title can reuse an existing game session as a match ticket session to find more players to join a game that's already in progress.</span></span> <span data-ttu-id="01f44-147">これを実行できるようにするには、タイトルは、*preserveSession* パラメーターを **PreserveSessionMode.Always** に設定して **CreateMatchTicketAsync** を呼び出すことによってマッチ チケットを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="01f44-147">To enable this, the title must create the match ticket by calling **CreateMatchTicketAsync** with the *preserveSession* parameter set to **PreserveSessionMode.Always**.</span></span> <span data-ttu-id="01f44-148">これにより、マッチメイキング サービスは、チケットに使用されている既存のセッションがマッチメイキング プロセス全体を通じて保持され、結果としてターゲット セッションになるようにします。</span><span class="sxs-lookup"><span data-stu-id="01f44-148">The matchmaking service then ensures that the existing session used for the ticket is preserved throughout the matchmaking process, and becomes the resulting target session.</span></span>


## <a name="deleting-the-match-ticket"></a><span data-ttu-id="01f44-149">マッチ チケットの削除</span><span class="sxs-lookup"><span data-stu-id="01f44-149">Deleting the Match Ticket</span></span>

<span data-ttu-id="01f44-150">マッチ チケットを削除するには、タイトルで **MatchmakingService.DeleteMatchTicketAsync メソッド**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="01f44-150">To delete the match ticket, the title calls **MatchmakingService.DeleteMatchTicketAsync Method**.</span></span> <span data-ttu-id="01f44-151">チケットの削除:</span><span class="sxs-lookup"><span data-stu-id="01f44-151">Deletion of the ticket:</span></span>

1.  <span data-ttu-id="01f44-152">チケット セッションでユーザーのマッチメイキングを停止します。</span><span class="sxs-lookup"><span data-stu-id="01f44-152">Stops matchmaking for the users in the ticket session.</span></span>
2.  <span data-ttu-id="01f44-153">チケット セッションの /servers/matchmaking/properties/system/status フィールドを "canceled" に更新します。</span><span class="sxs-lookup"><span data-stu-id="01f44-153">Updates the /servers/matchmaking/properties/system/status field in the ticket session to "canceled".</span></span>


## <a name="performing-matchmaking-for-games-using-xbox-live-compute"></a><span data-ttu-id="01f44-154">Xbox Live エンジンを使用したゲームのマッチメイキングの実行</span><span class="sxs-lookup"><span data-stu-id="01f44-154">Performing Matchmaking for Games Using Xbox Live Compute</span></span>

<span data-ttu-id="01f44-155">ここでは、Xbox Live Compute ベース ゲームでユーザーをマッチメイキングする際に行われる手順の概要を示します。</span><span class="sxs-lookup"><span data-stu-id="01f44-155">Here are the high-level steps that take place to get a user matchmade into an Xbox Live Compute-based game.</span></span> <span data-ttu-id="01f44-156">サード パーティーによってホストされるゲームにも、類似のフローが当てはまるはずです。</span><span class="sxs-lookup"><span data-stu-id="01f44-156">A similar flow should apply for games hosted by third parties.</span></span>
1.  <span data-ttu-id="01f44-157">スカウトは、グループを表すためのチケット セッションを作成します。</span><span class="sxs-lookup"><span data-stu-id="01f44-157">The scout creates a ticket session to represent the group.</span></span> <span data-ttu-id="01f44-158">このセッションには、候補となるデータセンターのリストが含まれます。このリストは、/constants/system/measurementServerAddresses のセッション構成内にあります。</span><span class="sxs-lookup"><span data-stu-id="01f44-158">This session contains a list of potential datacenters, located in the session configuration in /constants/system/measurementServerAddresses.</span></span> <span data-ttu-id="01f44-159">このリストは、セッション テンプレート (データセンター リストが静的である場合) から取得されるか、最初に Xbox Live エンジンからリストを取得した後のセッションの作成時にリストを記述したクライアントから取得されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-159">It comes from either the session template if the datacenter list is static, or from the client writing it up at session creation after getting it from Xbox Live Compute first.</span></span> <span data-ttu-id="01f44-160">このセッションの targetSessionConstants/custom/gameServerPlatform オブジェクトには、gsiSetId、gameVariantId、および maxAllowedPlayers の値も含まれています。</span><span class="sxs-lookup"><span data-stu-id="01f44-160">This session also contains gsiSetId, gameVariantId, and maxAllowedPlayers values in the targetSessionConstants/custom/gameServerPlatform object.</span></span>
2.  <span data-ttu-id="01f44-161">グループに属する他のすべてのクライアントがチケット セッションに参加します。</span><span class="sxs-lookup"><span data-stu-id="01f44-161">All other clients in the group join the ticket session.</span></span>
3.  <span data-ttu-id="01f44-162">グループのすべてのメンバーは、/members/{index}/properties/system/serverMeasurements で定義されているように、チケット セッションの /constants/system オブジェクトから measurementServerAddresses 値をダウンロードし、プラットフォーム API を使用してそれらに ping を実行して、優先するデータセンターの順序付きリストをセッションにアップロードします。</span><span class="sxs-lookup"><span data-stu-id="01f44-162">All members of the group download the measurementServerAddresses values from the /constants/system object for the ticket session, ping them using the platform API, and upload an ordered list of preferred datacenters to the session, as defined in /members/{index}/properties/system/serverMeasurements.</span></span>

| <span data-ttu-id="01f44-163">注意</span><span class="sxs-lookup"><span data-stu-id="01f44-163">Note</span></span>                                                                                                                                                                                                                                                                                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="01f44-164">タイトルは、セッションの measurementServerAddresses 値を **MultiplayerSession.SetMeasurementServerAddresses** メソッドおよび **MultiplayerSessionConstants.MeasurementServerAddressesJson プロパティ**を使用して設定および取得できます。</span><span class="sxs-lookup"><span data-stu-id="01f44-164">The title can set and retrieve the measurementServerAddresses values from the session using the **MultiplayerSession.SetMeasurementServerAddresses** method and the **MultiplayerSessionConstants.MeasurementServerAddressesJson Property**.</span></span> |

4.  <span data-ttu-id="01f44-165">スカウトは、チケット セッションへの参照を渡して **CreateMatchTicketAsync** を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="01f44-165">The scout calls **CreateMatchTicketAsync**, passing in a reference to the ticket session.</span></span>

| <span data-ttu-id="01f44-166">注意</span><span class="sxs-lookup"><span data-stu-id="01f44-166">Note</span></span>                                                                                                                                                                                                         |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="01f44-167">チケット セッション オブジェクトの定数が一致していない場合、チケット作成メソッドは失敗する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="01f44-167">If ticket session objects have mismatched constants, the create ticket method might not succeed.</span></span> <span data-ttu-id="01f44-168">これは、ホッパーに必須ルールを追加し、定数が一致しないプレイヤーのマッチを防止することで回避できます。</span><span class="sxs-lookup"><span data-stu-id="01f44-168">This can be avoided by adding a MUST rule to the hopper, to prevent matching with players who have mismatched constants.</span></span> |

<span data-ttu-id="01f44-169">**MatchTicketDetailsResponse.PreserveSession プロパティ**が Never に設定されている場合、マッチメイキング サービスは各メンバーからのサーバー測定値をチケットの内部表現にコピーします。</span><span class="sxs-lookup"><span data-stu-id="01f44-169">If the **MatchTicketDetailsResponse.PreserveSession Property** is set to Never, the matchmaking service copies the server measurements from each member into the internal representation of the ticket.</span></span> <span data-ttu-id="01f44-170">サービスは、チケットのメンバーのサーバー測定値を、チケットの単一のサーバー測定値コレクションに均一化します。このコレクションは、特別なチケット属性としてチケットの内部表現に格納されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-170">It flattens the server measurements of the members of the ticket into a single server measurements collection for the ticket, stored in the internal representation of the ticket as a "special" ticket attribute.</span></span>

<span data-ttu-id="01f44-171">**MatchTicketDetailsResponse.PreserveSession** が Always に設定されている場合、サーバー測定値は使用されません。</span><span class="sxs-lookup"><span data-stu-id="01f44-171">If **MatchTicketDetailsResponse.PreserveSession** is set to Always, the server measurements are not used.</span></span> <span data-ttu-id="01f44-172">代わりに、マッチメイキング サービスは、セッションの /properties/system/matchmaking/serverConnectionString 値を、サイズ 1 で遅延ゼロの serverMeasurements コレクションとしてチケットの内部表現にコピーします。</span><span class="sxs-lookup"><span data-stu-id="01f44-172">Instead, the matchmaking service copies the /properties/system/matchmaking/serverConnectionString value for the session into the internal representation of the ticket, as a serverMeasurements collection of size 1 with latency zero.</span></span>

5.  <span data-ttu-id="01f44-173">マッチメイキング サービスでは、サーバー測定値コレクションを考慮に入れて、チケット セッションが他のグループを表すその他のチケット セッションとマッチングされます。</span><span class="sxs-lookup"><span data-stu-id="01f44-173">The matchmaking service matches the ticket session with others representing other groups, taking the server measurement collections into account.</span></span> <span data-ttu-id="01f44-174">同じデータセンターの優先度が高いグループ間でのマッチングが試行されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-174">It tries to match the group with other groups that have the same datacenters preferred highly.</span></span>
6.  <span data-ttu-id="01f44-175">マッチしたグループが見つかったら、マッチメイキング サービスではターゲット セッションが作成または識別され、一緒にマッチされたチケット セッションのすべてのプレイヤーが追加されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-175">Once a matched group has been found, the matchmaking service creates or identifies a target session and adds all the players from the ticket sessions that are matched together.</span></span> <span data-ttu-id="01f44-176">サービスでは、マッチされたグループの最終的に均一化されたサーバー測定値が /properties/system/serverConnectionStringCandidates に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="01f44-176">The service writes the final flattened server measurements for the matched group into /properties/system/serverConnectionStringCandidates.</span></span> <span data-ttu-id="01f44-177">ターゲット セッションで新しく追加されたメンバーごとに、最初に送信されたサーバー測定値が /members/{index}/constants/system/matchmakingResult/serverMeasurements に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="01f44-177">It writes the originally submitted server measurements for each newly-added member in the target session to /members/{index}/constants/system/matchmakingResult/serverMeasurements.</span></span>
7.  <span data-ttu-id="01f44-178">すべてのクライアントは、前述のように、ターゲット セッションで初期化を実行します。</span><span class="sxs-lookup"><span data-stu-id="01f44-178">All clients perform initialization on the target session as discussed above.</span></span> <span data-ttu-id="01f44-179">ただし、クライアントは Xbox Live エンジンに接続するため、接続確認のための QoS を互いに実行しません。</span><span class="sxs-lookup"><span data-stu-id="01f44-179">However, because the clients will be connecting to Xbox Live Compute, they do not perform QoS with one another to confirm connectivity.</span></span>
8.  <span data-ttu-id="01f44-180">一部またはすべてのクライアントが **GameServerPlatformService.AllocateClusterAsync メソッド**を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="01f44-180">Some or all clients call the **GameServerPlatformService.AllocateClusterAsync Method**.</span></span> <span data-ttu-id="01f44-181">最初の呼び出しによって割り当てがトリガーされ、それ以外の呼び出しでは受信確認のみを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="01f44-181">The first one triggers the allocation, while the others receive only an acknowledgment.</span></span> <span data-ttu-id="01f44-182">このメソッドによって、MPSD からターゲット セッションが取得され、負荷などの Xbox Live エンジン固有の情報やターゲット セッション内のデータセンター優先順位に基づいて、データセンターが選択されます。</span><span class="sxs-lookup"><span data-stu-id="01f44-182">The method gets the target session from MPSD and chooses a datacenter based on the datacenter preferences in the target session, as well as load and other Xbox Live Compute-specific knowledge.</span></span>
9.  <span data-ttu-id="01f44-183">すべてのクライアントがプレイします。</span><span class="sxs-lookup"><span data-stu-id="01f44-183">All clients play.</span></span>


## <a name="see-also"></a><span data-ttu-id="01f44-184">関連項目</span><span class="sxs-lookup"><span data-stu-id="01f44-184">See also</span></span>

[<span data-ttu-id="01f44-185">SmartMatch のランタイム操作</span><span class="sxs-lookup"><span data-stu-id="01f44-185">SmartMatch Runtime Operations</span></span>](smartmatch-matchmaking.md)

[<span data-ttu-id="01f44-186">SmartMatch マッチメイキング</span><span class="sxs-lookup"><span data-stu-id="01f44-186">SmartMatch Matchmaking</span></span>](smartmatch-matchmaking.md)

**<span data-ttu-id="01f44-187">Microsoft.Xbox.Services.Matchmaking 名前空間</span><span class="sxs-lookup"><span data-stu-id="01f44-187">Microsoft.Xbox.Services.Matchmaking Namespace</span></span>**

**<span data-ttu-id="01f44-188">Microsoft.Xbox.Services.Multiplayer 名前空間</span><span class="sxs-lookup"><span data-stu-id="01f44-188">Microsoft.Xbox.Services.Multiplayer Namespace</span></span>**
