---
author: Xansky
Description: Learn how to register your UWP app to receive push notifications that you send from Windows Dev Center.
title: ターゲット プッシュ通知用のアプリの構成
ms.author: mhopkins
ms.date: 02/08/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP, Microsoft Store Services SDK, ターゲット プッシュ通知, デベロッパー センター
ms.assetid: 30c832b7-5fbe-4852-957f-7941df8eb85a
ms.localizationpriority: medium
ms.openlocfilehash: 39ea899f9f0ee08d14ca5f182fdf07649ddd1d2e
ms.sourcegitcommit: 310a4555fedd4246188a98b31f6c094abb33ec60
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/19/2018
ms.locfileid: "5129779"
---
# <a name="configure-your-app-for-targeted-push-notifications"></a><span data-ttu-id="ad43e-103">ターゲット プッシュ通知用のアプリの構成</span><span class="sxs-lookup"><span data-stu-id="ad43e-103">Configure your app for targeted push notifications</span></span>

<span data-ttu-id="ad43e-104">Windows デベロッパー センター ダッシュボードの **[プッシュ通知]** のページを使用して、ユニバーサル Windows プラットフォーム (UWP) アプリがインストールされているデバイスにターゲット プッシュ通知を送信することによって、ユーザーと直接関わり合うことができます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-104">You can use the **Push notifications** page in the Windows Dev Center dashboard to directly engage with customers by sending targeted push notifications to the devices on which your Universal Windows Platform (UWP) app is installed.</span></span> <span data-ttu-id="ad43e-105">たとえば、ターゲット プッシュ通知を使用して、ユーザーにアプリの評価や新しい機能の試用などの行動を促すことができます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-105">For example, you can use targeted push notifications to encourage your customers to take an action, such as rating your app or trying a new feature.</span></span> <span data-ttu-id="ad43e-106">トースト通知、タイル通知、生の XML 通知など、さまざまな種類のプッシュ通知を送信できます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-106">You can send several different types of push notifications, including toast notifications, tile notifications, and raw XML notifications.</span></span> <span data-ttu-id="ad43e-107">また、プッシュ通知の結果としてのアプリの起動率を追跡することもできます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-107">You can also track the rate of app launches that resulted from your push notifications.</span></span> <span data-ttu-id="ad43e-108">この機能について詳しくは、「[アプリのユーザーにプッシュ通知を送信する](../publish/send-push-notifications-to-your-apps-customers.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ad43e-108">For more information about this feature, see [Send push notifications to your app's customers](../publish/send-push-notifications-to-your-apps-customers.md).</span></span>

<span data-ttu-id="ad43e-109">デベロッパー センターからユーザーにターゲット プッシュ通知を送信する前に、Microsoft Store Services SDK の [StoreServicesEngagementManager](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager) クラスのメソッドを使用して、通知を受信するアプリを登録する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-109">Before you can send targeted push notifications to your customers from Dev Center, you must use a method of the [StoreServicesEngagementManager](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager) class in the Microsoft Store Services SDK to register your app to receive notifications.</span></span> <span data-ttu-id="ad43e-110">このクラスの追加のメソッドを使用して、ターゲット プッシュ通知の結果としてアプリが起動されたことをデベロッパー センターに通知したり (通知の結果としてのアプリの起動率をトラッキングする場合)、通知の受信を停止したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-110">You can use additional methods of this class to notify Dev Center that your app was launched in response to a targeted push notification (if you want to track the rate of app launches that resulted from your notifications) and to stop receiving notifications.</span></span>

## <a name="configure-your-project"></a><span data-ttu-id="ad43e-111">プロジェクトを構成する</span><span class="sxs-lookup"><span data-stu-id="ad43e-111">Configure your project</span></span>

<span data-ttu-id="ad43e-112">コードを記述する前に、Microsoft Store Services SDK への参照をプロジェクトに追加するには、以下の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-112">Before you write any code, follow these steps to add a reference to the Microsoft Store Services SDK in your project:</span></span>

1. <span data-ttu-id="ad43e-113">Microsoft Store Services SDK を開発用コンピューターにインストールしていない場合には、[Microsoft Store Services SDK をインストール](microsoft-store-services-sdk.md#install-the-sdk)します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-113">If you have not done so already, [Install the Microsoft Store Services SDK](microsoft-store-services-sdk.md#install-the-sdk) on your development computer.</span></span> 
2. <span data-ttu-id="ad43e-114">Visual Studio でプロジェクトを開きます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-114">Open your project in Visual Studio.</span></span>
3. <span data-ttu-id="ad43e-115">ソリューション エクスプローラーで、プロジェクトの **[参照設定]** ノードを右クリックし、**[参照の追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ad43e-115">In Solution Explorer, right-click the **References** node for your project and click **Add Reference**.</span></span>
4. <span data-ttu-id="ad43e-116">**[参照マネージャー]** で、**[ユニバーサル Windows]** を展開し、**[拡張機能]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ad43e-116">In **Reference Manager**, expand **Universal Windows** and click **Extensions**.</span></span>
5. <span data-ttu-id="ad43e-117">SDK の一覧で、**[Microsoft Engagement Framework]** の横にあるチェック ボックスをオンにして、**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="ad43e-117">In the list of SDKs, click the check box next to **Microsoft Engagement Framework** and click **OK**.</span></span>

## <a name="register-for-push-notifications"></a><span data-ttu-id="ad43e-118">プッシュ通知への登録</span><span class="sxs-lookup"><span data-stu-id="ad43e-118">Register for push notifications</span></span>

<span data-ttu-id="ad43e-119">ターゲット プッシュ通知を受信するアプリをデベロッパー センターから登録するには</span><span class="sxs-lookup"><span data-stu-id="ad43e-119">To register your app to receive targeted push notifications from Dev Center:</span></span>

1. <span data-ttu-id="ad43e-120">プロジェクトで、起動中に実行されるコード セクションを見つけます。このセクションで、通知を受信するようにアプリケーションを登録することができます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-120">In your project, locate a section of code that runs during startup in which you can register your app to receive notifications.</span></span>
2. <span data-ttu-id="ad43e-121">コード ファイルの先頭に、次のステートメントを追加します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-121">Add the following statement to the top of the code file.</span></span>

    [!code-cs[DevCenterNotifications](./code/StoreSDKSamples/cs/DevCenterNotifications.cs#EngagementNamespace)]

3. <span data-ttu-id="ad43e-122">[StoreServicesEngagementManager](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager) オブジェクトを取得し、先ほど見つけた起動コードの [RegisterNotificationChannelAsync](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) オーバーロードの 1 つを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-122">Get a [StoreServicesEngagementManager](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager) object and call one of the [RegisterNotificationChannelAsync](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) overloads in the startup code you identified earlier.</span></span> <span data-ttu-id="ad43e-123">このメソッドは、アプリを起動するたびに呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-123">This method should be called each time that your app is launched.</span></span>

  * <span data-ttu-id="ad43e-124">デベロッパー センターで通知の独自のチャネル URI を作成する場合は、[RegisterNotificationChannelAsync()](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) オーバーロードを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-124">If you want Dev Center to create its own channel URI for the notifications, call the [RegisterNotificationChannelAsync()](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) overload.</span></span>

      [!code-cs[DevCenterNotifications](./code/StoreSDKSamples/cs/DevCenterNotifications.cs#RegisterNotificationChannelAsync1)]
      > [!IMPORTANT]
      > <span data-ttu-id="ad43e-125">アプリが [CreatePushNotificationChannelForApplicationAsync](https://docs.microsoft.com/uwp/api/windows.networking.pushnotifications.pushnotificationchannelmanager.createpushnotificationchannelforapplicationasync) も呼び出して WNS の通知チャネルを作成する場合、コードが [CreatePushNotificationChannelForApplicationAsync](https://docs.microsoft.com/uwp/api/windows.networking.pushnotifications.pushnotificationchannelmanager.createpushnotificationchannelforapplicationasync) および [RegisterNotificationChannelAsync()](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) オーバーロードを同時に呼び出さないようにしてください・</span><span class="sxs-lookup"><span data-stu-id="ad43e-125">If your app also calls [CreatePushNotificationChannelForApplicationAsync](https://docs.microsoft.com/uwp/api/windows.networking.pushnotifications.pushnotificationchannelmanager.createpushnotificationchannelforapplicationasync) to create a notification channel for WNS, make sure that your code does not call [CreatePushNotificationChannelForApplicationAsync](https://docs.microsoft.com/uwp/api/windows.networking.pushnotifications.pushnotificationchannelmanager.createpushnotificationchannelforapplicationasync) and the [RegisterNotificationChannelAsync()](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) overload simultaneously.</span></span> <span data-ttu-id="ad43e-126">これらのメソッドの両方を呼び出す必要がある場合は、それらを順番に呼び出すようにして、もう一方のメソッドを呼び出す前に別のメソッドの戻りを待つようにします。</span><span class="sxs-lookup"><span data-stu-id="ad43e-126">If you need to call both of these methods, make sure that you call them sequentially and await the return of one method before calling the other.</span></span>

  * <span data-ttu-id="ad43e-127">デベロッパー センターからターゲット プッシュ通知に使用するチャネル URI を指定する場合、[RegisterNotificationChannelAsync(StoreServicesNotificationChannelParameters)](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) オーバーロードを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-127">If you want to specify the channel URI to use for targeted push notifications from Dev Center, call the [RegisterNotificationChannelAsync(StoreServicesNotificationChannelParameters)](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.registernotificationchannelasync) overload.</span></span> <span data-ttu-id="ad43e-128">たとえば、アプリが既に Windows プッシュ通知サービス (WNS) を使用していて、同じチャネル URI を使用する場合は、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="ad43e-128">For example, might want to do this if your app already uses Windows Push Notification Services (WNS) and you want to use the same channel URI.</span></span> <span data-ttu-id="ad43e-129">まず [StoreServicesNotificationChannelParameters](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesnotificationchannelparameters) オブジェクトを作成し、[CustomNotificationChannelUri](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesnotificationchannelparameters.customnotificationchanneluri) プロパティをチャネル URI に割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-129">You must first create a [StoreServicesNotificationChannelParameters](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesnotificationchannelparameters) object and assign the [CustomNotificationChannelUri](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesnotificationchannelparameters.customnotificationchanneluri) property to your channel URI.</span></span>

      [!code-cs[DevCenterNotifications](./code/StoreSDKSamples/cs/DevCenterNotifications.cs#RegisterNotificationChannelAsync2)]

> [!NOTE]
> <span data-ttu-id="ad43e-130">**RegisterNotificationChannelAsync** メソッドを呼び出すと、MicrosoftStoreEngagementSDKId.txt という名前のファイルが、アプリのローカル アプリ データ ストア ([ApplicationData.LocalFolder](https://docs.microsoft.com/uwp/api/Windows.Storage.ApplicationData.LocalFolder) プロパティによって返されるフォルダー) に作成されます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-130">When you call the **RegisterNotificationChannelAsync** method, a file named MicrosoftStoreEngagementSDKId.txt is created in the local app data store for your app (the folder returned by the [ApplicationData.LocalFolder](https://docs.microsoft.com/uwp/api/Windows.Storage.ApplicationData.LocalFolder) property).</span></span> <span data-ttu-id="ad43e-131">このファイルには、ターゲット プッシュ通知インフラストラクチャで使用される ID が含まれています。</span><span class="sxs-lookup"><span data-stu-id="ad43e-131">This file contains an ID that is used by the targeted push notifications infrastructure.</span></span> <span data-ttu-id="ad43e-132">アプリがこのファイルを変更または削除しないことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="ad43e-132">Make sure that your app does not modify or delete this file.</span></span> <span data-ttu-id="ad43e-133">ファイルの変更や削除が行われると、通知の複数のインスタンスを受け取ったり、他の方法で通知が正しく動作しない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-133">Otherwise, your users may receive multiple instances of notifications, or the notifications may not behave properly in other ways.</span></span>

<span id="notification-customers" />

### <a name="how-targeted-push-notifications-are-routed-to-customers"></a><span data-ttu-id="ad43e-134">ターゲット プッシュ通知をユーザーにルーティングする方法</span><span class="sxs-lookup"><span data-stu-id="ad43e-134">How targeted push notifications are routed to customers</span></span>

<span data-ttu-id="ad43e-135">アプリで **RegisterNotificationChannelAsync** を呼び出すと、このメソッドは、現在デバイスにサインインしているユーザーの Microsoft アカウントを収集します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-135">When your app calls **RegisterNotificationChannelAsync**, this method collects the Microsoft account of the customer who is currently signed in to the device.</span></span> <span data-ttu-id="ad43e-136">その後で、ターゲット プッシュ通知をこのユーザーが含まれているセグメントに送信すると、デベロッパー センターによって、このユーザーの Microsoft アカウントに関連付けられているデバイスに通知が送信されます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-136">Later, when you send a targeted push notification to a segment that includes this customer, Dev Center sends the notification to devices that are associated with this customer's Microsoft account.</span></span>

<span data-ttu-id="ad43e-137">アプリを起動したユーザーが、Microsoft アカウントでデバイスにまだサインインしているときに、そのデバイスを他のユーザーに使用させた場合、他のユーザーが元のユーザーを対象とした通知を見る可能性があります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-137">If the customer who started your app gives their device to someone else to use while they are still signed in to the device with their Microsoft account, be aware that the other person may see the notification that was targeted at the original customer.</span></span> <span data-ttu-id="ad43e-138">これにより予期しない結果が起こる可能性があります (特に、ユーザーによるサインインが必要となるサービスを提供するアプリの場合)。</span><span class="sxs-lookup"><span data-stu-id="ad43e-138">This can have unintended consequences, particularly for apps that offer services that customers can sign in to use.</span></span> <span data-ttu-id="ad43e-139">このシナリオで他のユーザーがターゲット通知を見ることができなくするには、ユーザーがアプリからからサインアウトするときに、[UnregisterNotificationChannelAsync](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.unregisternotificationchannelasync) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-139">To prevent other users from seeing your targeted notifications in this scenario, call the [UnregisterNotificationChannelAsync](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.unregisternotificationchannelasync) method when customers sign out of your app.</span></span> <span data-ttu-id="ad43e-140">詳しくは、この記事の後半にある「[プッシュ通知の登録解除](#unregister)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="ad43e-140">For more information, see [Unregister for push notifications](#unregister) later in this article.</span></span>

### <a name="how-your-app-responds-when-the-user-launches-your-app"></a><span data-ttu-id="ad43e-141">ユーザーがアプリを起動したときのアプリの対応方法</span><span class="sxs-lookup"><span data-stu-id="ad43e-141">How your app responds when the user launches your app</span></span>

<span data-ttu-id="ad43e-142">通知を受信するようにアプリを登録し、[デベロッパー センターからアプリのユーザーにプッシュ通知を送信](../publish/send-push-notifications-to-your-apps-customers.md)した後に、ユーザーがプッシュ通知の結果としてアプリを起動すると、アプリの次のエントリ ポイントの 1 つが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-142">After your app is registered to receive notifications and you [send a push notification to your app's customers from Dev Center](../publish/send-push-notifications-to-your-apps-customers.md), one of the following entry points in your app will be called when the user launches your app in response to your push notification.</span></span> <span data-ttu-id="ad43e-143">ユーザーがアプリを起動したときに実行するコードがある場合は、アプリのこれらのエントリ ポイントのいずれかにコードを追加できます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-143">If you have some code that you want to run when the user launches your app, you can add the code to one of these entry points in your app.</span></span>

  * <span data-ttu-id="ad43e-144">プッシュ通知にフォアグラウンドのアクティブ化の種類がある場合には、プロジェクトの**アプリ**クラスの [OnActivated](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application.onactivated) メソッドを上書きして、このメソッドにコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-144">If the push notification has a foreground activation type, override the [OnActivated](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application.onactivated) method of the **App** class in your project and add your code to this method.</span></span>

  * <span data-ttu-id="ad43e-145">プッシュ通知にバックグラウンドのアクティブ化の種類がある場合には、[バックグラウンド タスク](../launch-resume/support-your-app-with-background-tasks.md)の [Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) メソッドにコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-145">If the push notification has a background activation type, add your code to the [Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) method for your [background task](../launch-resume/support-your-app-with-background-tasks.md).</span></span>

<span data-ttu-id="ad43e-146">たとえば、有料のアドオンを購入したアプリのユーザーに、特典として無料のアドオンを提供することができます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-146">For example, you might want to reward the users of your app that have purchased any paid add-ons in your app by granting them a free add-on.</span></span> <span data-ttu-id="ad43e-147">この例では、対象とするユーザーの[ユーザー セグメント](../publish/create-customer-segments.md)にプッシュ通知を送信できます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-147">In this case, you can send a push notification to a [customer segment](../publish/create-customer-segments.md) that targets these users.</span></span> <span data-ttu-id="ad43e-148">次に、無料の[アプリ内購入](in-app-purchases-and-trials.md)を提供するコードを、上記のエントリ ポイントのいずれかに追加できます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-148">Then, you can add code to grant them a free [in-app purchase](in-app-purchases-and-trials.md) in one of the entry points listed above.</span></span>

## <a name="notify-dev-center-of-your-app-launch"></a><span data-ttu-id="ad43e-149">アプリの起動をデベロッパー センターに通知する</span><span class="sxs-lookup"><span data-stu-id="ad43e-149">Notify Dev Center of your app launch</span></span>

<span data-ttu-id="ad43e-150">デベロッパー センターでターゲット プッシュ通知の **[アプリの起動率の追跡]** オプションを選択した場合、アプリの適切なエントリ ポイントから [ParseArgumentsAndTrackAppLaunch](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.parseargumentsandtrackapplaunch) メソッドを呼び出して、プッシュ通知の結果としてアプリが起動されたことをデベロッパー センターに通知します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-150">If you select the **Track app launch rate** option for your targeted push notification in Dev Center, call the [ParseArgumentsAndTrackAppLaunch](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.parseargumentsandtrackapplaunch) method from the appropriate entry point in your app to notify Dev Center that your app was launched in response to a push notification.</span></span>

<span data-ttu-id="ad43e-151">このメソッドは、アプリの元の起動引数を返します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-151">This method also returns the original launch arguments for your app.</span></span> <span data-ttu-id="ad43e-152">プッシュ通知によるアプリの起動率を追跡するように選択すると、起動引数に不透明なトラッキング ID が追加され、デベロッパー センターでのアプリの起動の追跡に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="ad43e-152">When you choose to track the app launch rate for your push notification, an opaque tracking ID is added to the launch arguments to help track the app launch in Dev Center.</span></span> <span data-ttu-id="ad43e-153">アプリの起動引数 [ParseArgumentsAndTrackAppLaunch](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.parseargumentsandtrackapplaunch) メソッドに渡す必要があります。このメソッドは、追跡 ID をデベロッパー センターに送信し、起動引数から追跡 ID を削除して、元の起動引数をコードに返します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-153">You must pass the launch arguments for your app to the [ParseArgumentsAndTrackAppLaunch](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.parseargumentsandtrackapplaunch) method, and this method sends the tracking ID to Dev Center, removes the tracking ID from the launch arguments, and returns the original launch arguments to your code.</span></span>

<span data-ttu-id="ad43e-154">このメソッドを呼び出す方法は、プッシュ通知のアクティブ化の種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-154">The way you call this method depends on the activation type of the push notification:</span></span>

* <span data-ttu-id="ad43e-155">プッシュ通知にフォアグラウンドのアクティブ化の種類がある場合は、このメソッドをアプリの [OnActivated](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application.onactivated) メソッド オーバーライドから呼び出し、このメソッドに渡された [ToastNotificationActivatedEventArgs](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Activation.ToastNotificationActivatedEventArgs) オブジェクトで使用可能な引数を渡します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-155">If the push notification has a foreground activation type, call this method from the [OnActivated](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application.onactivated) method override in your app and pass the arguments that are available in the [ToastNotificationActivatedEventArgs](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.Activation.ToastNotificationActivatedEventArgs) object that is passed to this method.</span></span> <span data-ttu-id="ad43e-156">次のコード例では、コード ファイルに **Microsoft.Services.Store.Engagement** 名前空間と **Windows.ApplicationModel.Activation** 名前空間の **using** ステートメントがあることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="ad43e-156">The following code example assumes that your code file has **using** statements for the **Microsoft.Services.Store.Engagement** and  **Windows.ApplicationModel.Activation** namespaces.</span></span>

  [!code-cs[DevCenterNotifications](./code/StoreSDKSamples/cs/App.xaml.cs#OnActivated)]

* <span data-ttu-id="ad43e-157">プッシュ通知にバックグラウンドのアクティブ化の種類がある場合、[バックグラウンド タスク](../launch-resume/support-your-app-with-background-tasks.md)の [Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) メソッドからこのメソッドを呼び出し、このメソッドに渡された [ToastNotificationActionTriggerDetail](https://docs.microsoft.com/uwp/api/Windows.UI.Notifications.ToastNotificationActionTriggerDetail) オブジェクトで使用可能な引数を渡します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-157">If the push notification has a background activation type, call this method from the [Run](https://docs.microsoft.com/uwp/api/windows.applicationmodel.background.ibackgroundtask.run) method for your [background task](../launch-resume/support-your-app-with-background-tasks.md) and pass the arguments that are available in the [ToastNotificationActionTriggerDetail](https://docs.microsoft.com/uwp/api/Windows.UI.Notifications.ToastNotificationActionTriggerDetail) object that is passed to this method.</span></span> <span data-ttu-id="ad43e-158">次のコード例では、コード ファイルに **Microsoft.Services.Store.Engagement**、**Windows.ApplicationModel.Background**、**Windows.UI.Notifications** の名前空間の **using** ステートメントがあることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="ad43e-158">The following code example assumes that your code file has **using** statements for the **Microsoft.Services.Store.Engagement**, **Windows.ApplicationModel.Background**, and **Windows.UI.Notifications** namespaces.</span></span>

  [!code-cs[DevCenterNotifications](./code/StoreSDKSamples/cs/DevCenterNotifications.cs#Run)]

<span id="unregister" />

## <a name="unregister-for-push-notifications"></a><span data-ttu-id="ad43e-159">プッシュ通知の登録解除</span><span class="sxs-lookup"><span data-stu-id="ad43e-159">Unregister for push notifications</span></span>

<span data-ttu-id="ad43e-160">アプリで Windows デベロッパー センターからのターゲット プッシュ通知の受信を停止する場合は、[UnregisterNotificationChannelAsync](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.unregisternotificationchannelasync) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="ad43e-160">If you want your app to stop receiving targeted push notifications from Dev Center, call the [UnregisterNotificationChannelAsync](https://docs.microsoft.com/uwp/api/microsoft.services.store.engagement.storeservicesengagementmanager.unregisternotificationchannelasync) method.</span></span>

[!code-cs[DevCenterNotifications](./code/StoreSDKSamples/cs/DevCenterNotifications.cs#UnregisterNotificationChannelAsync)]

<span data-ttu-id="ad43e-161">このメソッドは通知に使用されているチャネルを無効にするため、アプリは*いずれの*サービスからもプッシュ通知を受信しなくなることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ad43e-161">Note that this method invalidates the channel that is being used for notifications so the app no longer receives push notifications from *any* services.</span></span> <span data-ttu-id="ad43e-162">チャネルが閉じられると、デベロッパー センターからのターゲット プッシュ通知や WNS を使用したその他の通知を含め、どのサービスにもチャネルを使用することができなくなります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-162">After it has been closed, the channel cannot be used again for any services, including targeted push notifications from Dev Center and other notifications using WNS.</span></span> <span data-ttu-id="ad43e-163">このアプリでプッシュ通知の送信を再開するには、アプリは新しいチャネルを要求する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ad43e-163">To resume sending push notifications to this app, the app must request a new channel.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ad43e-164">関連トピック</span><span class="sxs-lookup"><span data-stu-id="ad43e-164">Related topics</span></span>

* [<span data-ttu-id="ad43e-165">アプリのユーザーにプッシュ通知を送信する</span><span class="sxs-lookup"><span data-stu-id="ad43e-165">Send push notifications to your app's customers</span></span>](../publish/send-push-notifications-to-your-apps-customers.md)
* [<span data-ttu-id="ad43e-166">Windows プッシュ通知サービス (WNS) の概要</span><span class="sxs-lookup"><span data-stu-id="ad43e-166">Windows Push Notification Services (WNS) overview</span></span>](https://docs.microsoft.com/windows/uwp/design/shell/tiles-and-notifications/windows-push-notification-services--wns--overview)
* [<span data-ttu-id="ad43e-167">通知チャネルを要求、作成、保存する方法</span><span class="sxs-lookup"><span data-stu-id="ad43e-167">How to request, create, and save a notification channel</span></span>](https://docs.microsoft.com/previous-versions/windows/apps/hh868221(v=win.10))
* [<span data-ttu-id="ad43e-168">Microsoft Store Services SDK</span><span class="sxs-lookup"><span data-stu-id="ad43e-168">Microsoft Store Services SDK</span></span>](https://docs.microsoft.com/windows/uwp/monetize/microsoft-store-services-sdk)
