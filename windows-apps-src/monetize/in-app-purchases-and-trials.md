---
author: mcleanbyron
ms.assetid: F45E6F35-BC18-45C8-A8A5-193D528E2A4E
description: UWP アプリのアプリ内購入と試用版を有効にする方法を説明します。
title: アプリ内購入と試用版
ms.author: mcleans
ms.date: 08/25/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP, アプリ内購入, IAP, アドオン, 試用版, コンシューマブル, 永続的, サブスクリプション
ms.localizationpriority: medium
ms.openlocfilehash: 28e28c5db19d9a2b397a04cc326867605d796aac
ms.sourcegitcommit: 6618517dc0a4e4100af06e6d27fac133d317e545
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2018
ms.locfileid: "1691241"
---
# <a name="in-app-purchases-and-trials"></a><span data-ttu-id="1f745-104">アプリ内購入と試用版</span><span class="sxs-lookup"><span data-stu-id="1f745-104">In-app purchases and trials</span></span>

<span data-ttu-id="1f745-105">Windows SDK に用意されている API を使用して、以下の機能を実装し、ユニバーサル Windows プラットフォーム (UWP) アプリによる収益を向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-105">The Windows SDK provides APIs you can use to implement the following features to make more money from your Universal Windows Platform (UWP) app:</span></span>

* <span data-ttu-id="1f745-106">**アプリ内購入**&nbsp;&nbsp; アプリが無料であるかどうかにかかわらず、コンテンツやアプリの新機能 (ゲームの次のレベルのロック解除など) をアプリ内から直接販売できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-106">**In-app purchases**&nbsp;&nbsp;Whether your app is free or not, you can sell content or new app functionality (such as unlocking the next level of a game) from right within the app.</span></span>

* <span data-ttu-id="1f745-107">**試用版機能**&nbsp;&nbsp;アプリを [Windows デベロッパー センター ダッシュボードで無料試用版](../publish/set-app-pricing-and-availability.md#free-trial)として構成した場合、試用期間中に一部の機能を除外または制限することによって、アプリの通常版を購入するようユーザーを促すことができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-107">**Trial functionality**&nbsp;&nbsp;If you configure your app as a [free trial in the Windows Dev Center dashboard](../publish/set-app-pricing-and-availability.md#free-trial), you can entice your customers to purchase the full version of your app by excluding or limiting some features during the trial period.</span></span> <span data-ttu-id="1f745-108">また、ユーザーがアプリを購入する前の試用期間中にだけバナーや透かしなどを表示する機能を有効にすることもできます。</span><span class="sxs-lookup"><span data-stu-id="1f745-108">You can also enable features, such as banners or watermarks, that are shown only during the trial, before a customer buys your app.</span></span>

<span data-ttu-id="1f745-109">この記事では、UWP アプリでのアプリ内購入と試用版のしくみについて、その概要を説明します。</span><span class="sxs-lookup"><span data-stu-id="1f745-109">This article provides an overview of how in-app purchases and trials work in UWP apps.</span></span>

<span id="choose-namespace" />

## <a name="choose-which-namespace-to-use"></a><span data-ttu-id="1f745-110">使用する名前空間を選ぶ</span><span class="sxs-lookup"><span data-stu-id="1f745-110">Choose which namespace to use</span></span>

<span data-ttu-id="1f745-111">UWP アプリにアプリ内購入機能や試用版機能を追加する際に使用できる名前空間は、2 つあります。どちらの名前空間を使用するかは、アプリのターゲットとなる Windows 10 のバージョンによって決まります。</span><span class="sxs-lookup"><span data-stu-id="1f745-111">There are two different namespaces you can use to add in-app purchases and trial functionality to your UWP apps, depending on which version of Windows 10 your apps target.</span></span> <span data-ttu-id="1f745-112">これらの名前空間の API は同じ目的を果たしますが、その設計は大きく異なります。また、この 2 つの API 間にコードの互換性はありません。</span><span class="sxs-lookup"><span data-stu-id="1f745-112">Although the APIs in these namespaces serve the same goals, they are designed quite differently, and code is not compatible between the two APIs.</span></span>

* <span data-ttu-id="1f745-113">**[Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx)**&nbsp;&nbsp;Windows 10 バージョン 1607 以降の場合、アプリはこの名前空間の API を使用して、アプリ内購入および試用版を実装することができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-113">**[Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx)**&nbsp;&nbsp;Starting in Windows 10, version 1607, apps can use the API in this namespace to implement in-app purchases and trials.</span></span> <span data-ttu-id="1f745-114">Visual Studio でアプリ プロジェクトのターゲットが **Windows 10 Anniversary Edition (10.0、ビルド 14393)** 以降である場合は、この名前空間のメンバーを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="1f745-114">We recommend that you use the members in this namespace if your app project targets **Windows 10 Anniversary Edition (10.0; Build 14393)** or a later release in Visual Studio.</span></span> <span data-ttu-id="1f745-115">この名前空間は、ストアで管理されるコンシューマブルなアドオンなど、最新の種類のアドオンをサポートしており、Windows デベロッパー センターとストアで今後サポートされる製品および機能の種類と互換性を持つように設計されています。</span><span class="sxs-lookup"><span data-stu-id="1f745-115">This namespace supports the latest add-on types, such as Store-managed consumable add-ons, and is designed to be compatible with future types of products and features supported by Windows Dev Center and the Store.</span></span> <span data-ttu-id="1f745-116">この名前空間について詳しくは、この記事の「[Windows.Services.Store 名前空間を使用するアプリ内購入と試用版](#api_intro)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-116">For more information about this namespace, see the [In-app purchases and trials using the Windows.Services.Store namespace](#api_intro) section in this article.</span></span>

* <span data-ttu-id="1f745-117">**[Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx)**&nbsp;&nbsp;Windows 10 のすべてのバージョンでは、この名前空間にあるアプリ内購入と試用版向けの以前の API がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="1f745-117">**[Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx)**&nbsp;&nbsp;All versions of Windows 10 also support an older API for in-app purchases and trials in this namespace.</span></span> <span data-ttu-id="1f745-118">**Windows.ApplicationModel.Store** 名前空間については、「[Windows.ApplicationModel.Store 名前空間を使用するアプリ内購入と試用版](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-118">For information about the **Windows.ApplicationModel.Store** namespace, see [In-app purchases and trials using the Windows.ApplicationModel.Store namespace](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1f745-119">**Windows.ApplicationModel.Store** 名前空間は今後更新されず、新機能も追加されないため、アプリでは、可能であれば代わりに **Windows.Services.Store** 名前空間を使うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="1f745-119">The **Windows.ApplicationModel.Store** namespace is no longer being updated with new features, and we recommend that you use the **Windows.Services.Store** namespace instead if possible for your app.</span></span> <span data-ttu-id="1f745-120">**Windows.ApplicationModel.Store** 名前空間は、[デスクトップ ブリッジ](https://developer.microsoft.com/windows/bridges/desktop)を使う Windows デスクトップ アプリケーションや、デベロッパー センターの開発サンドボックスを使うアプリまたはゲーム (たとえば、Xbox Live と統合されるゲームがすべて該当します) ではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="1f745-120">The **Windows.ApplicationModel.Store** namespace is not supported in Windows desktop applications that use the [Desktop Bridge](https://developer.microsoft.com/windows/bridges/desktop) or in apps or games that use a development sandbox in Dev Center (for example, this is the case for any game that integrates with Xbox Live).</span></span>

<span id="concepts" />

## <a name="basic-concepts"></a><span data-ttu-id="1f745-121">基本的な概念</span><span class="sxs-lookup"><span data-stu-id="1f745-121">Basic concepts</span></span>

<span data-ttu-id="1f745-122">ストアで提供されるアイテムはすべて、通常、*製品*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="1f745-122">Every item that is offered in the Store is generally called a *product*.</span></span> <span data-ttu-id="1f745-123">ほとんどの開発者が扱う製品の種類は、*アプリ*と*アドオン*のみです。</span><span class="sxs-lookup"><span data-stu-id="1f745-123">Most developers only work with the following types of products: *apps* and *add-ons*.</span></span>

<span data-ttu-id="1f745-124">アドオンとは、ユーザーがアプリのコンテキストで利用できる製品や機能のことです。たとえば、アプリやゲームで使用される通貨、ゲームの新しい地図や武器、広告を表示せずにアプリを使用できる機能などに加え、音楽やビデオなどのデジタル コンテンツを提供できるアプリなら、そのようなコンテンツのことも表します。</span><span class="sxs-lookup"><span data-stu-id="1f745-124">An add-on is a product or feature that you make available to your customers in the context of your app: for example, currency to be used in an app or game, new maps or weapons for a game, the ability to use your app without ads, or digital content such as music or videos for apps that have the ability to offer that type of content.</span></span> <span data-ttu-id="1f745-125">すべてのアプリとアドオンは、そのアプリやアドオンを使用する権利がユーザーにあるかどうかを示す関連付けられたライセンスを備えます。</span><span class="sxs-lookup"><span data-stu-id="1f745-125">Every app and add-on has an associated license that indicates whether the user is entitled to use the app or add-on.</span></span> <span data-ttu-id="1f745-126">アプリまたはアドオンを試用版として使用する権利がユーザーにある場合は、その試用版に関する追加情報もライセンスによって提供されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-126">If the user is entitled to use the app or add-on as a trial, the license also provides additional info about the trial.</span></span>

<span data-ttu-id="1f745-127">アプリでユーザーにアドオンを提供するには、[デベロッパー センター ダッシュボードでアプリのアドオンを定義します](../publish/add-on-submissions.md)。これにより、そのアドオンがストアで認識されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-127">To offer an add-on to customers in your app, you must [define the add-on for your app in the Dev Center dashboard](../publish/add-on-submissions.md) so the Store knows about it.</span></span> <span data-ttu-id="1f745-128">その後で、アプリで **Windows.Services.Store** または **Windows.ApplicationModel.Store** 名前空間の API を使用して、アプリ内購入としてユーザーに販売するアドオンを提供することができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-128">Then, your app can use APIs in the **Windows.Services.Store** or **Windows.ApplicationModel.Store** namespace to offer the add-on for sale to the user as an in-app purchase.</span></span>

<span data-ttu-id="1f745-129">UWP アプリでは、次の種類のアドオンを提供できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-129">UWP apps can offer the following types of add-ons.</span></span>

| <span data-ttu-id="1f745-130">アドオンの種類</span><span class="sxs-lookup"><span data-stu-id="1f745-130">Add-on type</span></span> |  <span data-ttu-id="1f745-131">説明</span><span class="sxs-lookup"><span data-stu-id="1f745-131">Description</span></span>  |
|---------|-------------------|
| <span data-ttu-id="1f745-132">永続的</span><span class="sxs-lookup"><span data-stu-id="1f745-132">Durable</span></span>  |  <span data-ttu-id="1f745-133">[Windows デベロッパー センター ダッシュボード](../publish/enter-iap-properties.md)で指定した有効期間のあいだ保持されるアドオンです。</span><span class="sxs-lookup"><span data-stu-id="1f745-133">An add-on that persists for the lifetime that you specify in the [Windows Dev Center dashboard](../publish/enter-iap-properties.md).</span></span> <p/><p/><span data-ttu-id="1f745-134">既定では、永続的なアドオンの有効期限が切れることはありません。この場合、アドオンは 1 回のみ購入することができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-134">By default, durable add-ons never expire, in which case they can only be purchased once.</span></span> <span data-ttu-id="1f745-135">アドオンで特定の期間を指定している場合、期限が切れた後、ユーザーはアドオンを再購入できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-135">If you specify a particular duration for the add-on, the user can repurchase the add-on after it expires.</span></span> |
| <span data-ttu-id="1f745-136">開発者により管理されるコンシューマブル</span><span class="sxs-lookup"><span data-stu-id="1f745-136">Developer-managed consumable</span></span>  |  <span data-ttu-id="1f745-137">購入し、使用した後に再購入できるアドオンです。</span><span class="sxs-lookup"><span data-stu-id="1f745-137">An add-on that can be purchased, used, and purchased again.</span></span> <span data-ttu-id="1f745-138">この種類のアドオンは、多くの場合、アプリ内通貨に使用されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-138">This type of add-on is often used for in-app currency.</span></span> <p/><p/><span data-ttu-id="1f745-139">この種類のコンシューマブルでは、アドオンが表すユーザーのアイテムの残量を追跡し、ユーザーによってすべてのアイテムが消費されたらアドオンの購入をフルフィルメント完了としてストアに報告する義務が開発者にあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-139">For this type of consumable, you are responsible for keeping track of the user's balance of items that the add-on represents, and for reporting the purchase of the add-on as fulfilled to the Store after the user has consumed all the items.</span></span> <span data-ttu-id="1f745-140">以前のアドオン購入をフルフィルメント完了としてアプリで報告するまで、ユーザーがそのアドオンを再購入することはできません。</span><span class="sxs-lookup"><span data-stu-id="1f745-140">The user cannot purchase the add-on again until your app has reported the previous add-on purchase as fulfilled.</span></span> <p/><p/><span data-ttu-id="1f745-141">たとえば、アドオンがゲーム内の 100 コインを表しており、ユーザーによって 10 コインが消費されている場合、アプリまたはサービスでは、ユーザーの 90 コインの残高を保持する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-141">For example, if your add-on represents 100 coins in a game and the user consumes 10 coins, your app or service must maintain the new remaining balance of 90 coins for the user.</span></span> <span data-ttu-id="1f745-142">ユーザーによって 100 コインすべてが消費されたら、アプリでそのアドオンをフルフィルメント完了として報告する必要があります。その後、ユーザーは 100 コイン アドオンを再購入できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-142">After the user has consumed all 100 coins, your app must report the add-on as fulfilled, and then the user can purchase the 100 coin add-on again.</span></span>    |
| <span data-ttu-id="1f745-143">ストアで管理されるコンシューマブル</span><span class="sxs-lookup"><span data-stu-id="1f745-143">Store-managed consumable</span></span>  |  <span data-ttu-id="1f745-144">購入し、使用した後に再購入できるアドオンです。</span><span class="sxs-lookup"><span data-stu-id="1f745-144">An add-on that can be purchased, used, and purchased again.</span></span> <span data-ttu-id="1f745-145">この種類のアドオンは、多くの場合、アプリ内通貨に使用されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-145">This type of add-on is often used for in-app currency.</span></span><p/><p/><span data-ttu-id="1f745-146">この種類のコンシューマブルでは、アドオンが表すユーザーのアイテムの残量はストアで追跡します。</span><span class="sxs-lookup"><span data-stu-id="1f745-146">For this type of consumable, the Store keeps track of the user's balance of items that the add-on represents.</span></span> <span data-ttu-id="1f745-147">ユーザーによりアイテムが消費されたら、そのアイテムをフルフィルメント完了としてストアに報告する義務が開発者にあり、ストアによってユーザーの残量が更新されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-147">When the user consumes any items, you are responsible for reporting those items as fulfilled to the Store, and the Store updates the user's balance.</span></span> <span data-ttu-id="1f745-148">アプリでは、ユーザーのアイテムの現在の残量をいつでも照会できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-148">Your app can query for the current balance for the user at any time.</span></span> <span data-ttu-id="1f745-149">ユーザーは、すべてのアイテムを消費したら、そのアドオンを再購入できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-149">After the user consumes all of the items, the user can purchase the add-on again.</span></span>  <p/><p/> <span data-ttu-id="1f745-150">たとえば、アドオンがゲーム内の 100 のコインの初期量を表しており、ユーザーによって 10 コインが消費された場合、そのアドオンの 10 ユニットがフルフィルメント完了したことをアプリでストアに報告すると、ストアにより残高が更新されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-150">For example, if your add-on represents an initial quantity of 100 coins in a game and the user consumes 10 coins, your app reports to the Store that 10 units of the add-on were fulfilled, and the Store updates the remaining balance.</span></span> <span data-ttu-id="1f745-151">ユーザーは、100 コインすべてを消費した後、その 100 コインのアドオンを再購入できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-151">After the user has consumed all 100 coins, the user can purchase the 100 coin add-on again.</span></span> <p/><p/><span data-ttu-id="1f745-152">**注:**&nbsp;&nbsp;Microsoft Store で管理されるコンシューマブルを使用するには、Visual Studio でアプリが **Windows 10 Anniversary Edition (10.0、ビルド 14393)** 以降をターゲットとし、**Windows.ApplicationModel.Store** 名前空間ではなく、**Windows.Services.Store** 名前空間を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-152">**Note**&nbsp;&nbsp;To use Store-managed consumables, your app must target **Windows 10 Anniversary Edition (10.0; Build 14393)** or a later release in Visual Studio, and it must use the **Windows.Services.Store** namespace instead of the **Windows.ApplicationModel.Store** namespace.</span></span>  |
| <span data-ttu-id="1f745-153">サブスクリプション</span><span class="sxs-lookup"><span data-stu-id="1f745-153">Subscription</span></span> | <span data-ttu-id="1f745-154">アドオンを使い続けるために定期的な間隔でユーザーが継続的に課金する永続的なアドオンです。</span><span class="sxs-lookup"><span data-stu-id="1f745-154">A durable add-on where the customer continues to be charged at recurring intervals in order to keep using the add-on.</span></span> <span data-ttu-id="1f745-155">ユーザーはいつでもサブスクリプションをキャンセルして、それ以降の課金を取り消すことができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-155">The customer can cancel the subscription at any time to avoid further charges.</span></span> <p/><p/><span data-ttu-id="1f745-156">**注:**&nbsp;&nbsp;サブスクリプション アドオンを現在利用できるのは、初期導入プログラムに参加している開発者に限られます。</span><span class="sxs-lookup"><span data-stu-id="1f745-156">**Note**&nbsp;&nbsp;Subscription add-ons are currently only available to developers who are participating in an early adoption program.</span></span> <span data-ttu-id="1f745-157">サブスクリプション アドオンを使用するには、Visual Studio でアプリが **Windows 10 Anniversary Edition (10.0、ビルド 14393)** 以降をターゲットとし、**Windows.ApplicationModel.Store** 名前空間ではなく、**Windows.Services.Store** 名前空間を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-157">To use subscription add-ons, your app must target **Windows 10 Anniversary Edition (10.0; Build 14393)** or a later release in Visual Studio, and it must use the **Windows.Services.Store** namespace instead of the **Windows.ApplicationModel.Store** namespace.</span></span>  |

<span />

> [!NOTE]
> <span data-ttu-id="1f745-158">パッケージで使用される永続的なアドオン (ダウンロード コンテンツまたは DLC とも呼ばれます) など、他の種類のアドオンが利用できるのは一部の開発者に限られており、このドキュメントでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="1f745-158">Other types of add-ons, such as durable add-ons with packages (also known as downloadable content or DLC) are only available to a restricted set of developers, and are not covered in this documentation.</span></span>

<span id="api_intro" />

## <a name="in-app-purchases-and-trials-using-the-windowsservicesstore-namespace"></a><span data-ttu-id="1f745-159">Windows.Services.Store 名前空間を使用するアプリ内購入と試用版</span><span class="sxs-lookup"><span data-stu-id="1f745-159">In-app purchases and trials using the Windows.Services.Store namespace</span></span>

<span data-ttu-id="1f745-160">このセクションでは、[Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) 名前空間の重要なタスクと概念の概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="1f745-160">This section provides an overview of important tasks and concepts for the [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) namespace.</span></span> <span data-ttu-id="1f745-161">この名前空間は、Visual Studio で**Windows 10 Anniversary Edition (10.0、ビルド 14393)** 以降 (これは Windows 10 バージョン 1607 に対応) をターゲットとするアプリでのみ利用可能です。</span><span class="sxs-lookup"><span data-stu-id="1f745-161">This namespace is available only to apps that target **Windows 10 Anniversary Edition (10.0; Build 14393)** or a later release in Visual Studio (this corresponds to Windows 10, version 1607).</span></span> <span data-ttu-id="1f745-162">可能であれば、アプリで [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) 名前空間ではなく、**Windows.Services.Store** 名前空間を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="1f745-162">We recommend that apps use the **Windows.Services.Store** namespace instead of the [Windows.ApplicationModel.Store](https://msdn.microsoft.com/library/windows/apps/windows.applicationmodel.store.aspx) namespace if possible.</span></span> <span data-ttu-id="1f745-163">**Windows.ApplicationModel.Store** 名前空間については、[この記事](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-163">For information about the **Windows.ApplicationModel.Store** namespace, see [this article](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md).</span></span>

**<span data-ttu-id="1f745-164">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="1f745-164">In this section</span></span>**

* [<span data-ttu-id="1f745-165">ビデオ</span><span class="sxs-lookup"><span data-stu-id="1f745-165">Video</span></span>](#video)
* [<span data-ttu-id="1f745-166">StoreContext クラスの概要</span><span class="sxs-lookup"><span data-stu-id="1f745-166">Get started with the StoreContext class</span></span>](#get-started-storecontext)
* [<span data-ttu-id="1f745-167">アプリ内購入の実装</span><span class="sxs-lookup"><span data-stu-id="1f745-167">Implement in-app purchases</span></span>](#implement-iap)
* [<span data-ttu-id="1f745-168">試用版機能の実装</span><span class="sxs-lookup"><span data-stu-id="1f745-168">Implement trial functionality</span></span>](#implement-trial)
* [<span data-ttu-id="1f745-169">アプリ内購入や試用版の実装のテスト</span><span class="sxs-lookup"><span data-stu-id="1f745-169">Test your in-app purchase or trial implementation</span></span>](#testing)
* [<span data-ttu-id="1f745-170">アプリ内購入の受領通知</span><span class="sxs-lookup"><span data-stu-id="1f745-170">Receipts for in-app purchases</span></span>](#receipts)
* [<span data-ttu-id="1f745-171">デスクトップ ブリッジでの StoreContext クラスの使用</span><span class="sxs-lookup"><span data-stu-id="1f745-171">Using the StoreContext class with the Desktop Bridge</span></span>](#desktop)
* [<span data-ttu-id="1f745-172">製品、SKU、および可用性</span><span class="sxs-lookup"><span data-stu-id="1f745-172">Products, SKUs, and availabilities</span></span>](#products-skus)
* [<span data-ttu-id="1f745-173">ストア ID</span><span class="sxs-lookup"><span data-stu-id="1f745-173">Store IDs</span></span>](#store-ids)

<span id="video" />

### <a name="video"></a><span data-ttu-id="1f745-174">ビデオ</span><span class="sxs-lookup"><span data-stu-id="1f745-174">Video</span></span>

<span data-ttu-id="1f745-175">[Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) 名前空間を使用してアプリにアプリ内購入を実装する方法の概要については、次のビデオをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-175">Watch the following video for an overview of how to implement in-app purchases in your app using the [Windows.Services.Store](https://msdn.microsoft.com/library/windows/apps/windows.services.store.aspx) namespace.</span></span>
<br/>
<br/>
> [!VIDEO https://channel9.msdn.com/Blogs/One-Dev-Minute/Adding-In-App-Purchases-to-Your-UWP-App/player]

<span id="get-started-storecontext" />

### <a name="get-started-with-the-storecontext-class"></a><span data-ttu-id="1f745-176">StoreContext クラスの概要</span><span class="sxs-lookup"><span data-stu-id="1f745-176">Get started with the StoreContext class</span></span>

<span data-ttu-id="1f745-177">**Windows.Services.Store** 名前空間のメイン エントリ ポイントは、[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) クラスです。</span><span class="sxs-lookup"><span data-stu-id="1f745-177">The main entry point to the **Windows.Services.Store** namespace is the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) class.</span></span> <span data-ttu-id="1f745-178">このクラスには、現在のアプリとその利用可能なアドオンに関する情報の取得、現在のアプリまたはそのアドオンに関するライセンス情報の取得、現在のユーザー向けのアプリまたはアドオンの購入、およびその他のタスクを行う際に使用できるメソッドが用意されています。</span><span class="sxs-lookup"><span data-stu-id="1f745-178">This class provides methods you can use to get info for the current app and its available add-ons, get license info for the current app or its add-ons, purchase an app or add-on for the current user, and perform other tasks.</span></span> <span data-ttu-id="1f745-179">[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) オブジェクトを取得するには、次のいずれかを実行します。</span><span class="sxs-lookup"><span data-stu-id="1f745-179">To get a [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) object, do one of the following:</span></span>

* <span data-ttu-id="1f745-180">シングル ユーザー アプリ (アプリを起動したユーザーのコンテキストのみで実行されるアプリ) では、静的な [GetDefault](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getdefault) メソッドを使って **StoreContext** オブジェクトを取得します。このオブジェクトをうと、ユーザーの Microsoft Store 関連のデータにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="1f745-180">In a single-user app (that is, an app that runs only in the context of the user that launched the app), use the static [GetDefault](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getdefault) method to get a **StoreContext** object that you can use to access Microsoft Store-related data for the user.</span></span> <span data-ttu-id="1f745-181">ほとんどのユニバーサル Windows プラットフォーム アプリ (UWP) アプリはシングル ユーザー アプリです。</span><span class="sxs-lookup"><span data-stu-id="1f745-181">Most Universal Windows Platform (UWP) apps are single-user apps.</span></span>

  ```csharp
  Windows.Services.Store.StoreContext context = StoreContext.GetDefault();
  ```

* <span data-ttu-id="1f745-182">[マルチユーザー アプリ](../xbox-apps/multi-user-applications.md)では、静的な [GetForUser](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getforuser) メソッドを使って **StoreContext** オブジェクトを取得します。このオブジェクトを使うと、アプリの使用中に Microsoft アカウントでサインインしていた特定のユーザーに関する Microsoft Store 関連のデータにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="1f745-182">In a [multi-user app](../xbox-apps/multi-user-applications.md), use the static [GetForUser](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getforuser) method to get a **StoreContext** object that you can use to access Microsoft Store-related data for a specific user who is signed in with their Microsoft account while using the app.</span></span> <span data-ttu-id="1f745-183">次の例は、利用可能な最初のユーザーの **StoreContext** オブジェクトを取得します。</span><span class="sxs-lookup"><span data-stu-id="1f745-183">The following example gets a **StoreContext** object for the first available user.</span></span>

  ```csharp
  var users = await Windows.System.User.FindAllAsync();
  Windows.Services.Store.StoreContext context = StoreContext.GetForUser(users[0]);
  ```

> [!NOTE]
> <span data-ttu-id="1f745-184">[デスクトップ ブリッジ](https://developer.microsoft.com/windows/bridges/desktop) を使用する Windows デスクトップ アプリケーションでは、[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) オブジェクトを使用する前に、追加の手順を実行してこのオブジェクトを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-184">Windows desktop applications that use the [Desktop Bridge](https://developer.microsoft.com/windows/bridges/desktop) must perform additional steps to configure the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) object before they can use this object.</span></span> <span data-ttu-id="1f745-185">詳しくは、[このセクション](#desktop)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-185">For more information, see [this section](#desktop).</span></span>

<span data-ttu-id="1f745-186">[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) オブジェクトを構成すると、このオブジェクトのメソッドを呼び出して、現在のアプリやアドオンに関するストア製品情報の取得、現在のアプリとそのアドオンに関するライセンス情報の取得、現在のユーザー向けのアプリやアドオンの購入、およびその他のタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-186">After you have a [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) object, you can start calling methods of this object to get Store product info for the current app and its add-ons, retrieve license info for the current app and its add-ons, purchase an app or add-on for the current user, and perform other tasks.</span></span> <span data-ttu-id="1f745-187">このオブジェクトを使用して実行できる一般的なタスクについて詳しくは、次の記事をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-187">For more information about common tasks you can perform using this object, see the following articles:</span></span>

* [<span data-ttu-id="1f745-188">アプリとアドオンの製品情報の取得</span><span class="sxs-lookup"><span data-stu-id="1f745-188">Get product info for apps and add-ons</span></span>](get-product-info-for-apps-and-add-ons.md)
* [<span data-ttu-id="1f745-189">アプリとアドオンのライセンス情報の取得</span><span class="sxs-lookup"><span data-stu-id="1f745-189">Get license info for apps and add-ons</span></span>](get-license-info-for-apps-and-add-ons.md)
* [<span data-ttu-id="1f745-190">アプリとアドオンのアプリ内購入の有効化</span><span class="sxs-lookup"><span data-stu-id="1f745-190">Enable in-app purchases of apps and add-ons</span></span>](enable-in-app-purchases-of-apps-and-add-ons.md)
* [<span data-ttu-id="1f745-191">コンシューマブルなアドオン購入の有効化</span><span class="sxs-lookup"><span data-stu-id="1f745-191">Enable consumable add-on purchases</span></span>](enable-consumable-add-on-purchases.md)
* [<span data-ttu-id="1f745-192">アプリのサブスクリプション アドオンの有効化</span><span class="sxs-lookup"><span data-stu-id="1f745-192">Enable subscription add-ons for your app</span></span>](enable-subscription-add-ons-for-your-app.md)
* [<span data-ttu-id="1f745-193">アプリの試用版の実装</span><span class="sxs-lookup"><span data-stu-id="1f745-193">Implement a trial version of your app</span></span>](implement-a-trial-version-of-your-app.md)

<span data-ttu-id="1f745-194">**StoreContext** および **Windows.Services.Store** 名前空間にある他の型を使用する方法を示すサンプル アプリについては、[ストア サンプル](https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/Store)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-194">For a sample app that demonstrates how to use **StoreContext** and other types in the **Windows.Services.Store** namespace, see the [Store sample](https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/Store).</span></span>

<span id="implement-iap" />

### <a name="implement-in-app-purchases"></a><span data-ttu-id="1f745-195">アプリ内購入の実装</span><span class="sxs-lookup"><span data-stu-id="1f745-195">Implement in-app purchases</span></span>

<span data-ttu-id="1f745-196">**Windows.Services.Store** 名前空間を使用して、アプリでアプリ内購入をユーザーに提供するには:</span><span class="sxs-lookup"><span data-stu-id="1f745-196">To offer an in-app purchase to customers in your app using the **Windows.Services.Store** namespace:</span></span>

1. <span data-ttu-id="1f745-197">ユーザーが購入できるアドオンをアプリで提供する場合、[デベロッパー センター ダッシュ ボードで、アプリに関するアドオンの申請を作成](https://msdn.microsoft.com/windows/uwp/publish/add-on-submissions)します。</span><span class="sxs-lookup"><span data-stu-id="1f745-197">If your app offers add-ons that customers can purchase, [create add-on submissions for your app in the Dev Center dashboard](https://msdn.microsoft.com/windows/uwp/publish/add-on-submissions).</span></span>

2. <span data-ttu-id="1f745-198">[アプリで提供されるアプリやアドオンの製品情報を取得](get-product-info-for-apps-and-add-ons.md)してから、[ライセンスがアクティブになっているかどうかを判断](get-license-info-for-apps-and-add-ons.md)する (つまり、アプリやアドオンを使用するためのライセンスをユーザーが所有しているかどうかを判断する) ようにアプリのコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="1f745-198">Write code in your app to [retrieve product info for your app or an add-on offered by your app](get-product-info-for-apps-and-add-ons.md) and then [determine whether the license is active](get-license-info-for-apps-and-add-ons.md) (that is, whether the user has a license to use the app or add-on).</span></span> <span data-ttu-id="1f745-199">ライセンスがアクティブになっていない場合、ユーザーに販売するためのアプリやアドオンをアプリ内購入として提供する UI を表示します。</span><span class="sxs-lookup"><span data-stu-id="1f745-199">If the license isn't active, display a UI that offers the app or add-on for sale to the user as an in-app purchase.</span></span>

3. <span data-ttu-id="1f745-200">ユーザーがアプリやアドオンの購入を選んだ場合、製品を購入するための適切なメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="1f745-200">If the user chooses to purchase your app or add-on, use the appropriate method to purchase the product:</span></span>

    * <span data-ttu-id="1f745-201">ユーザーがアプリや永続的なアドオンを購入する場合は、「[アプリとアドオンのアプリ内購入の有効化](enable-in-app-purchases-of-apps-and-add-ons.md)」の指示に従ってください。</span><span class="sxs-lookup"><span data-stu-id="1f745-201">If the user is purchasing your app or a durable add-on, follow the instructions in [Enable in-app purchases of apps and add-ons](enable-in-app-purchases-of-apps-and-add-ons.md).</span></span>
    * <span data-ttu-id="1f745-202">ユーザーがコンシューマブルなアドオンを購入する場合は、「[コンシューマブルなアドオン購入の有効化](enable-consumable-add-on-purchases.md)」の指示に従ってください。</span><span class="sxs-lookup"><span data-stu-id="1f745-202">If the user is purchasing a consumable add-on, follow the instructions in [Enable consumable add-on purchases](enable-consumable-add-on-purchases.md).</span></span>
    * <span data-ttu-id="1f745-203">ユーザーがサブスクリプション アドオンを購入する場合は、「[アプリのサブスクリプション アドオンの有効化](enable-subscription-add-ons-for-your-app.md)」の指示に従ってください。</span><span class="sxs-lookup"><span data-stu-id="1f745-203">If the user is purchasing a subscription add-on, follow the instructions in [Enable subscription add-ons for your app](enable-subscription-add-ons-for-your-app.md).</span></span>

4. <span data-ttu-id="1f745-204">この記事に記載されている[テスト ガイダンス](#testing)に従って、実装をテストします。</span><span class="sxs-lookup"><span data-stu-id="1f745-204">Test your implementation by following the [testing guidance](#testing) in this article.</span></span>

<span id="implement-trial" />

### <a name="implement-trial-functionality"></a><span data-ttu-id="1f745-205">試用版機能の実装</span><span class="sxs-lookup"><span data-stu-id="1f745-205">Implement trial functionality</span></span>

<span data-ttu-id="1f745-206">**Windows.Services.Store** 名前空間を使用して、アプリの試用版の機能を除外または制限するには:</span><span class="sxs-lookup"><span data-stu-id="1f745-206">To exclude or limit features in a trial version of your app using the **Windows.Services.Store** namespace:</span></span>

1. <span data-ttu-id="1f745-207">[Windows デベロッパー センター ダッシュ ボードで、アプリを無料試用版として構成します](../publish/set-app-pricing-and-availability.md#free-trial)。</span><span class="sxs-lookup"><span data-stu-id="1f745-207">[Configure your app as a free trial in the Windows Dev Center dashboard](../publish/set-app-pricing-and-availability.md#free-trial).</span></span>

2. <span data-ttu-id="1f745-208">[アプリで提供されるアプリやアドオンの製品情報を取得](get-product-info-for-apps-and-add-ons.md)してから、[アプリに関連付けられているライセンスが試用版ライセンスになっているかどうかを判断](get-license-info-for-apps-and-add-ons.md)するようにアプリのコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="1f745-208">Write code in your app to [retrieve product info for your app or an add-on offered by your app](get-product-info-for-apps-and-add-ons.md) and then [determine whether the license associated with the app is a trial license](get-license-info-for-apps-and-add-ons.md).</span></span>

3. <span data-ttu-id="1f745-209">試用版である場合は、アプリの特定の機能を除外または制限します。ユーザーが完全なライセンスを購入した場合は、その機能を有効にします。</span><span class="sxs-lookup"><span data-stu-id="1f745-209">Exclude or limit certain features in your app if it is a trial, and then enable the features when the user purchases a full license.</span></span> <span data-ttu-id="1f745-210">詳細とコード例については、「[アプリの試用版の実装](implement-a-trial-version-of-your-app.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-210">For more information and a code example, see [Implement a trial version of your app](implement-a-trial-version-of-your-app.md).</span></span>

4. <span data-ttu-id="1f745-211">この記事に記載されている[テスト ガイダンス](#testing)に従って、実装をテストします。</span><span class="sxs-lookup"><span data-stu-id="1f745-211">Test your implementation by following the [testing guidance](#testing) in this article.</span></span>

<span id="testing" />

### <a name="test-your-in-app-purchase-or-trial-implementation"></a><span data-ttu-id="1f745-212">アプリ内購入や試用版の実装のテスト</span><span class="sxs-lookup"><span data-stu-id="1f745-212">Test your in-app purchase or trial implementation</span></span>

<span data-ttu-id="1f745-213">アプリで **Windows.Services.Store** 名前空間の API を使用してアプリ内購入や試用版機能を実装する場合は、アプリを Store に公開してからそのアプリを開発デバイスにダウンロードし、そのライセンスを使用してテストを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-213">If your app uses APIs in the **Windows.Services.Store** namespace to implement in-app purchase or trial functionality, you must publish your app to the Store and download the app to your development device to use its license for testing.</span></span> <span data-ttu-id="1f745-214">コードをテストするには次のプロセスに従います。</span><span class="sxs-lookup"><span data-stu-id="1f745-214">Follow this process to test your code:</span></span>

1. <span data-ttu-id="1f745-215">アプリがまだ公開されておらず、Microsoft Store で利用できない場合、アプリが [Windows アプリ認定キット](https://developer.microsoft.com/windows/develop/app-certification-kit)の最低限の要件を満たしていることを確認し、Windows デベロッパー センター ダッシュボードに[そのアプリを申請](https://msdn.microsoft.com/windows/uwp/publish/app-submissions)します。その後で、アプリが認定プロセスに合格したことを確認します。</span><span class="sxs-lookup"><span data-stu-id="1f745-215">If your app is not yet published and available in the Store, make sure your app meets the minimum [Windows App Certification Kit](https://developer.microsoft.com/windows/develop/app-certification-kit) requirements, [submit your app](https://msdn.microsoft.com/windows/uwp/publish/app-submissions) to the Windows Dev Center dashboard, and make sure your app passes the certification process.</span></span> <span data-ttu-id="1f745-216">テスト中に [Microsoft Store でアプリを検索できないようにアプリを構成する](https://msdn.microsoft.com/windows/uwp/publish/set-app-pricing-and-availability)ことも可能です。</span><span class="sxs-lookup"><span data-stu-id="1f745-216">You can [configure your app so it is not discoverable in the Store](https://msdn.microsoft.com/windows/uwp/publish/set-app-pricing-and-availability) while you test it.</span></span>

2. <span data-ttu-id="1f745-217">次に、以下の操作が完了していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="1f745-217">Next, make sure you have completed the following:</span></span>

    * <span data-ttu-id="1f745-218">[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) クラス、および **Windows.Services.Store** 名前空間にある他の関連する型を使用するアプリのコードを、[アプリ内購入](#implement-iap)や[試用版機能](#implement-trial)を実装するように記述します。</span><span class="sxs-lookup"><span data-stu-id="1f745-218">Write code in your app that uses the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) class and other related types in the **Windows.Services.Store** namespace to implement [in-app purchases](#implement-iap) or [trial functionality](#implement-trial).</span></span>
    * <span data-ttu-id="1f745-219">ユーザーが購入できるアドオンをアプリで提供する場合、[デベロッパー センター ダッシュ ボードで、アプリに関するアドオンの申請を作成](https://msdn.microsoft.com/windows/uwp/publish/add-on-submissions)します。</span><span class="sxs-lookup"><span data-stu-id="1f745-219">If your app offers an add-on that customers can purchase, [create an add-on submission for your app in the Dev Center dashboard](https://msdn.microsoft.com/windows/uwp/publish/add-on-submissions).</span></span>
    * <span data-ttu-id="1f745-220">アプリの試用版で一部の機能を除外または制限する場合は、[Windows デベロッパー センター ダッシュ ボードで、アプリを無料試用版として構成します](../publish/set-app-pricing-and-availability.md#free-trial)。</span><span class="sxs-lookup"><span data-stu-id="1f745-220">If you want to exclude or limit some features in a trial version of your app, [configure your app as a free trial in the Windows Dev Center dashboard](../publish/set-app-pricing-and-availability.md#free-trial).</span></span>

3. <span data-ttu-id="1f745-221">プロジェクトを Visual Studio で開き、**[プロジェクト]** メニューをクリックし、**[ストア]** をポイントして、**[アプリケーションをストアと関連付ける]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="1f745-221">With your project open in Visual Studio, click the **Project menu**, point to **Store**, and then click **Associate App with the Store**.</span></span> <span data-ttu-id="1f745-222">ウィザードの手順を完了し、テストに使用する Windows デベロッパー センター アカウントのアプリとアプリ プロジェクトを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="1f745-222">Complete the instructions in the wizard to associate the app project with the app in your Windows Dev Center account that you want to use for testing.</span></span>
    > [!NOTE]
    > <span data-ttu-id="1f745-223">プロジェクトとストアのアプリを関連付けていない場合、[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) メソッドにより、戻り値の **ExtendedError** プロパティがエラー コード値 0x803F6107 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-223">If you do not associate your project with an app in the Store, the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) methods set the **ExtendedError** property of their return values to the error code value 0x803F6107.</span></span> <span data-ttu-id="1f745-224">この値は、ストアにそのアプリに関する情報がないことを示します。</span><span class="sxs-lookup"><span data-stu-id="1f745-224">This value indicates that the Store doesn't have any knowledge about the app.</span></span>
4. <span data-ttu-id="1f745-225">まだ前の手順で指定したストアのアプリをインストールしていない場合は、アプリをインストールし、アプリを一度実行してから閉じます。</span><span class="sxs-lookup"><span data-stu-id="1f745-225">If you have not done so already, install the app from the Store that you specified in the previous step, run the app once, and then close this app.</span></span> <span data-ttu-id="1f745-226">これにより、アプリの有効なライセンスが開発用デバイスにインストールされます。</span><span class="sxs-lookup"><span data-stu-id="1f745-226">This ensures that a valid license for the app is installed to your development device.</span></span>

5. <span data-ttu-id="1f745-227">Visual Studio で、プロジェクトの実行またはデバッグを開始します。</span><span class="sxs-lookup"><span data-stu-id="1f745-227">In Visual Studio, start running or debugging your project.</span></span> <span data-ttu-id="1f745-228">コードによって、ローカルのプロジェクトと関連付けたストア アプリからアプリおよびアドオンのデータが取得されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-228">Your code should retrieve app and add-on data from the Store app that you associated with your local project.</span></span> <span data-ttu-id="1f745-229">アプリを再インストールするように求められた場合は、その指示に従った後、プロジェクトを実行またはデバッグします。</span><span class="sxs-lookup"><span data-stu-id="1f745-229">If you are prompted to reinstall the app, follow the instructions and then run or debug your project.</span></span>
    > [!NOTE]
    > <span data-ttu-id="1f745-230">上記の手順を実行すると、ストアに新しいアプリ パッケージを提出しなくても、引き続きアプリのコードを更新し、更新されたプロジェクトを開発用コンピューターでデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="1f745-230">After you complete these steps, you can continue to update your app's code and then debug your updated project on your development computer without submitting new app packages to the Store.</span></span> <span data-ttu-id="1f745-231">テストで使用するローカル ライセンスを取得するため、開発用コンピューターにストア バージョンのアプリを 1 度だけダウンロードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-231">You only need to download the Store version of your app to your development computer once to obtain the local license that will be used for testing.</span></span> <span data-ttu-id="1f745-232">テストが完了し、ユーザーがアプリのアプリ内購入や試用版に関連する機能を利用できるようにするには、ストアに新しいアプリ パッケージを申請するだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="1f745-232">You only need to submit new app packages to the Store after you complete your testing and you want to make the in-app purchase or trial-related features in your app available to your customers.</span></span>

<span data-ttu-id="1f745-233">アプリで **Windows.ApplicationModel.Store** 名前空間を使用している場合は、アプリで [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) クラスを使用することで、アプリをストアに提出する前に、ライセンス情報をテスト中にシミュレートできます。</span><span class="sxs-lookup"><span data-stu-id="1f745-233">If your app uses the **Windows.ApplicationModel.Store** namespace, you can use the [CurrentAppSimulator](https://msdn.microsoft.com/library/windows/apps/hh779766) class in your app to simulate license info during testing before you submit your app to the Store.</span></span> <span data-ttu-id="1f745-234">詳しくは、「[CurrentApp クラスと CurrentAppSimulator クラスの概要] (in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md#get-started-with-the-currentapp-and-currentappsimulator-classes)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-234">For more information, see [Get started with the CurrentApp and CurrentAppSimulator classes] (in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md#get-started-with-the-currentapp-and-currentappsimulator-classes).</span></span>  

> [!NOTE]
> <span data-ttu-id="1f745-235">**Windows.Services.Store** 名前空間には、テスト中にライセンス情報をシミュレートするために使用できるクラスが用意されていません。</span><span class="sxs-lookup"><span data-stu-id="1f745-235">The **Windows.Services.Store** namespace does not provide a class that you can use to simulate license info during testing.</span></span> <span data-ttu-id="1f745-236">**Windows.Services.Store** 名前空間を使用してアプリ内購入または試用版を実装する場合は、上記のように、アプリをストアに公開してからそのアプリを開発デバイスにダウンロードし、そのライセンスを使用してテストを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-236">If you use the **Windows.Services.Store** namespace to implement in-app purchases or trials, you must publish your app to the Store and download the app to your development device to use its license for testing as described above.</span></span>

<span id="receipts" />

### <a name="receipts-for-in-app-purchases"></a><span data-ttu-id="1f745-237">アプリ内購入の受領通知</span><span class="sxs-lookup"><span data-stu-id="1f745-237">Receipts for in-app purchases</span></span>

<span data-ttu-id="1f745-238">**Windows.Services.Store** 名前空間には、購入が成功した場合の取引の受領通知をアプリのコードで取得する際に使用できる API が用意されていません。</span><span class="sxs-lookup"><span data-stu-id="1f745-238">The **Windows.Services.Store** namespace does not provide an API you can use to obtain a transaction receipt for successful purchases in your app's code.</span></span> <span data-ttu-id="1f745-239">これは、**Windows.ApplicationModel.Store** 名前空間を使用するアプリの場合とは異なります。このようなアプリでは、[クライアント側の API を使用して、取引の受領通知を取得する](use-receipts-to-verify-product-purchases.md)ことができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-239">This is a different experience from apps that use the **Windows.ApplicationModel.Store** namespace, which can [use a client-side API to retrieve a transaction receipt](use-receipts-to-verify-product-purchases.md).</span></span>

<span data-ttu-id="1f745-240">**Windows.Services.Store** 名前空間を使ってアプリ内購入を実装しているとき、特定のユーザーがアプリまたはアドオンを購入したかどうかを確認する必要がある場合は、[Microsoft Store コレクション REST API](view-and-grant-products-from-a-service.md) の[製品の照会メソッド](query-for-products.md)を使用できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-240">If you implement in-app purchases using the **Windows.Services.Store** namespace and you want to validate whether a given customer has purchased an app or add-on, you can use the [query for products method](query-for-products.md) in the [Microsoft Store collection REST API](view-and-grant-products-from-a-service.md).</span></span> <span data-ttu-id="1f745-241">このメソッドで返されるデータによって、指定されたユーザーが特定の製品に対する資格を持っているかどうかを確認し、ユーザーが購入した製品の取引に関するデータを取得することができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-241">The return data for this method confirms whether the specified customer has an entitlement for a given product, and provides data for the transaction in which the user acquired the product.</span></span> <span data-ttu-id="1f745-242">Microsoft Store コレクション API では、Azure AD Authentication を使ってこの情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="1f745-242">The Microsoft Store collection API uses Azure AD authentication to retrieve this information.</span></span>

<span id="desktop" />

### <a name="using-the-storecontext-class-with-the-desktop-bridge"></a><span data-ttu-id="1f745-243">デスクトップ ブリッジでの StoreContext クラスの使用</span><span class="sxs-lookup"><span data-stu-id="1f745-243">Using the StoreContext class with the Desktop Bridge</span></span>

<span data-ttu-id="1f745-244">[デスクトップ ブリッジ](https://developer.microsoft.com/windows/bridges/desktop)を使用するデスクトップ アプリケーションでは、[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) クラスを使用してアプリ内購入と試用版を実装できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-244">Desktop applications that use the [Desktop Bridge](https://developer.microsoft.com/windows/bridges/desktop) can use the [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) class to implement in-app purchases and trials.</span></span> <span data-ttu-id="1f745-245">ただし、Win32 デスクトップ アプリケーション、またはレンダリング フレームワーク (WPF アプリケーションなど) に関連付けられているウィンドウ ハンドル (HWND) を含んだデスクトップ アプリケーションがある場合、アプリケーションでは、オブジェクトによって表示されるモーダル ダイアログのオーナー ウィンドウとなるアプリケーション ウィンドウを指定するように、**StoreContext** オブジェクトを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-245">However, if you have a Win32 desktop application or a desktop application that has a window handle (HWND) that is associated with the rendering framework (such as a WPF application), your application must configure the **StoreContext** object to specify which application window is the owner window for modal dialogs that are shown by the object.</span></span>

<span data-ttu-id="1f745-246">多くの **StoreContext** メンバー (および **StoreContext** オブジェクトを介してアクセスされる他の関連する型のメンバー) では、製品購入などのストアに関連する操作を行うために、モーダル ダイアログがユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-246">Many **StoreContext** members (and members of other related types that are accessed through the **StoreContext** object) display a modal dialog to the user for Store-related operations such as purchasing a product.</span></span> <span data-ttu-id="1f745-247">デスクトップ アプリケーションで、モーダル ダイアログのオーナー ウィンドウを指定するように **StoreContext** オブジェクトが構成されていない場合、このオブジェクトは不正確なデータまたはエラーを返します。</span><span class="sxs-lookup"><span data-stu-id="1f745-247">If a desktop application does not configure the **StoreContext** object to specify the owner window for modal dialogs, this object will return inaccurate data or errors.</span></span>

<span data-ttu-id="1f745-248">デスクトップ ブリッジを使用するデスクトップ アプリケーションで **StoreContext** オブジェクトを構成するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="1f745-248">To configure a **StoreContext** object in a desktop application that uses the Desktop Bridge, follow these steps.</span></span>

1. <span data-ttu-id="1f745-249">次のいずれかを実行して、アプリで [IInitializeWithWindow](https://msdn.microsoft.com/library/windows/desktop/hh706981.aspx) インターフェイスにアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="1f745-249">Do one of the following to enable your app to access the [IInitializeWithWindow](https://msdn.microsoft.com/library/windows/desktop/hh706981.aspx) interface:</span></span>

    * <span data-ttu-id="1f745-250">アプリケーションが C# や Visual Basic などのマネージ言語で記述されている場合、次の C# の例に示すように、アプリのコードで [ComImport](https://msdn.microsoft.com/library/system.runtime.interopservices.comimportattribute.aspx) 属性を使用して、**IInitializeWithWindow** インターフェイスを宣言します。</span><span class="sxs-lookup"><span data-stu-id="1f745-250">If your application is written in a managed language such as C# or Visual Basic, declare the **IInitializeWithWindow** interface in your app's code with the [ComImport](https://msdn.microsoft.com/library/system.runtime.interopservices.comimportattribute.aspx) attribute as shown in the following C# example.</span></span> <span data-ttu-id="1f745-251">この例では、コード ファイルに **System.Runtime.InteropServices** 名前空間の **using** ステートメントが指定されていることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="1f745-251">This example assumes that your code file has a **using** statement for the **System.Runtime.InteropServices** namespace.</span></span>

        ```csharp
        [ComImport]
        [Guid("3E68D4BD-7135-4D10-8018-9FB6D9F33FA1")]
        [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
        public interface IInitializeWithWindow
        {
            void Initialize(IntPtr hwnd);
        }
        ```

    * <span data-ttu-id="1f745-252">アプリケーションが C++ で記述されている場合、コードに shobjidl.h ヘッダー ファイルへの参照を追加します。</span><span class="sxs-lookup"><span data-stu-id="1f745-252">If your application is written in C++, add a reference to the shobjidl.h header file in your code.</span></span> <span data-ttu-id="1f745-253">このヘッダー ファイルには、**IInitializeWithWindow** インターフェイスの宣言が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1f745-253">This header file contains the declaration of the **IInitializeWithWindow** interface.</span></span>

2. <span data-ttu-id="1f745-254">この記事で既に説明したように、[GetDefault](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getdefault) メソッド ([マルチ ユーザー アプリ](../xbox-apps/multi-user-applications.md)の場合は [GetForUser](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getforuser) メソッド) を使用して、[StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) オブジェクトを取得します。次に、このオブジェクトを [IInitializeWithWindow](https://msdn.microsoft.com/library/windows/desktop/hh706981.aspx) オブジェクトにキャストします。</span><span class="sxs-lookup"><span data-stu-id="1f745-254">Get a [StoreContext](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storecontext.aspx) object by using the [GetDefault](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getdefault) method (or [GetForUser](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getforuser) if your app is a [multi-user app](../xbox-apps/multi-user-applications.md)) as described earlier in this article, and cast this object to an [IInitializeWithWindow](https://msdn.microsoft.com/library/windows/desktop/hh706981.aspx) object.</span></span> <span data-ttu-id="1f745-255">その後で、[IInitializeWithWindow.Initialize](https://msdn.microsoft.com/library/windows/desktop/hh706982.aspx) メソッドを呼び出し、**StoreContext** メソッドによって表示されるモーダル ダイアログのオーナーにするウィンドウのハンドルを渡します。</span><span class="sxs-lookup"><span data-stu-id="1f745-255">Then, call the [IInitializeWithWindow.Initialize](https://msdn.microsoft.com/library/windows/desktop/hh706982.aspx) method, and pass the handle of the window that you want to be the owner for any modal dialogs that are shown by **StoreContext** methods.</span></span> <span data-ttu-id="1f745-256">次の C# の例は、アプリのメイン ウィンドウのハンドルをメソッドに渡す方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="1f745-256">The following C# example shows how to pass the handle of your app's main window to the method.</span></span>
    ```csharp
    StoreContext context = StoreContext.GetDefault();
    IInitializeWithWindow initWindow = (IInitializeWithWindow)(object)context;
    initWindow.Initialize(System.Diagnostics.Process.GetCurrentProcess().MainWindowHandle);
    ```

<span id="products-skus" />

### <a name="products-skus-and-availabilities"></a><span data-ttu-id="1f745-257">製品、SKU、および可用性</span><span class="sxs-lookup"><span data-stu-id="1f745-257">Products, SKUs, and availabilities</span></span>

<span data-ttu-id="1f745-258">ストア内のすべての製品には少なくとも 1 つの *SKU* があり、各 SKU ごとに少なくとも 1 つの*可用性*があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-258">Every product in the Store has at least one *SKU*, and each SKU has at least one *availability*.</span></span> <span data-ttu-id="1f745-259">Windows デベロッパー センター ダッシュボードでは、ほとんどの場合、これらの概念は開発者から抽象化されており、多くの開発者はアプリまたはアドオンの SKU や可用性を定義することはありません。</span><span class="sxs-lookup"><span data-stu-id="1f745-259">These concepts are abstracted away from most developers in the Windows Dev Center dashboard, and most developers will never define SKUs or availabilities for their apps or add-ons.</span></span> <span data-ttu-id="1f745-260">ただし、**Windows.Services.Store** 名前空間のストア製品のオブジェクト モデルには SKU と可用性が含まれているため、シナリオによっては、これらの概念の基本的な知識があると役に立つことがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-260">However, because the object model for Store products in the **Windows.Services.Store** namespace includes SKUs and availabilities, a basic understanding of these concepts can be helpful for some scenarios.</span></span>

| <span data-ttu-id="1f745-261">オブジェクト</span><span class="sxs-lookup"><span data-stu-id="1f745-261">Object</span></span> |  <span data-ttu-id="1f745-262">説明</span><span class="sxs-lookup"><span data-stu-id="1f745-262">Description</span></span>  |
|---------|-------------------|
| <span data-ttu-id="1f745-263">製品</span><span class="sxs-lookup"><span data-stu-id="1f745-263">Product</span></span>  |  <span data-ttu-id="1f745-264">*製品*は、アプリやアドオンなど、ストアで利用できるすべての製品の種類を指します。</span><span class="sxs-lookup"><span data-stu-id="1f745-264">A *product* refers to any type of product that is available in the Store, including an app or add-on.</span></span> <p/><p/> <span data-ttu-id="1f745-265">ストアの各製品には対応する [StoreProduct](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeproduct.aspx) オブジェクトがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-265">Each product in the Store has a corresponding [StoreProduct](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeproduct.aspx) object.</span></span> <span data-ttu-id="1f745-266">このクラスには、製品のストア ID、ストア登録情報の画像と動画、価格情報などのデータにアクセスするために使用できるプロパティが用意されています。</span><span class="sxs-lookup"><span data-stu-id="1f745-266">This class provides properties you can use to access data such as the Store ID of the product, the images and videos for the Store listing, and pricing info.</span></span> <span data-ttu-id="1f745-267">また、製品を購入するために使用できるメソッドも提供されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-267">It also provides methods you can use to purchase the product.</span></span> |
| <span data-ttu-id="1f745-268">SKU</span><span class="sxs-lookup"><span data-stu-id="1f745-268">SKU</span></span> |  <span data-ttu-id="1f745-269">*SKU* によって、独自の説明や価格など、製品固有の詳細情報に基づいて特定のバージョンの製品が示されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-269">A *SKU* is a specific version of a product with its own description, price, and other unique product details.</span></span> <span data-ttu-id="1f745-270">各アプリまたはアドオンには既定の SKU があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-270">Each app or add-on has a default SKU.</span></span> <span data-ttu-id="1f745-271">ほとんどの開発者は、アプリの通常版と試用版を公開している場合を除いて (ストア カタログでは、通常版と試用版は同じアプリの別の SKU になります)、1 つのアプリに複数の SKU を用意することはありません。</span><span class="sxs-lookup"><span data-stu-id="1f745-271">The only time most developers will ever have multiple SKUs for an app is if they publish a full version of their app and a trial version (in the Store catalog, each of these versions is a different SKU of the same app).</span></span> <p/><p/> <span data-ttu-id="1f745-272">一部の発行元は、独自の SKU を定義することができます。</span><span class="sxs-lookup"><span data-stu-id="1f745-272">Some publishers have the ability to define their own SKUs.</span></span> <span data-ttu-id="1f745-273">たとえば、大規模なゲームの発行元の場合、赤い血が許可されない市場では緑の血が表示される SKU でゲームをリリースし、それ以外のすべての市場では赤い血が表示される別の SKU でゲームをリリースすることがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-273">For example, a large game publisher might release a game with one SKU that shows green blood in markets that don't allow red blood and a different SKU that shows red blood in all other markets.</span></span> <span data-ttu-id="1f745-274">または、デジタル ビデオ コンテンツを販売している発行元が、1 つのビデオに対して、高解像度版の SKU と通常解像度版の SKU という、2 つの SKU を公開する場合もあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-274">Alternatively, a publisher who sells digital video content might publish two SKUs for a video, one SKU for the high-definition version and a different SKU for the standard-definition version.</span></span> <p/><p/> <span data-ttu-id="1f745-275">ストアの各 SKU には対応する [StoreSku](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storesku.aspx) オブジェクトがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-275">Each SKU in the Store has a corresponding [StoreSku](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storesku.aspx) object.</span></span> <span data-ttu-id="1f745-276">すべての [StoreProduct](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeproduct.aspx) には、製品の SKU にアクセスするために使用できる [Skus](https://docs.microsoft.com/uwp/api/windows.services.store.storeproduct.skus) プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-276">Every [StoreProduct](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeproduct.aspx) has a [Skus](https://docs.microsoft.com/uwp/api/windows.services.store.storeproduct.skus) property you can use to access the SKUs for the product.</span></span> |
| <span data-ttu-id="1f745-277">可用性</span><span class="sxs-lookup"><span data-stu-id="1f745-277">Availability</span></span>  |  <span data-ttu-id="1f745-278">*可用性*によって、固有の価格情報に基づいて特定のバージョンの SKU が示されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-278">An *availability* is a specific version of a SKU with its own unique pricing info.</span></span> <span data-ttu-id="1f745-279">各 SKU には、既定の可用性があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-279">Each SKU has a default availability.</span></span> <span data-ttu-id="1f745-280">一部の発行元は独自の可用性を定義でき、特定の SKU にさまざまな価格オプションを導入できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-280">Some publishers have the ability to define their own availabilities to introduce different price options for a given SKU.</span></span> <p/><p/> <span data-ttu-id="1f745-281">ストアの各可用性には対応する [StoreAvailability](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeavailability.aspx) オブジェクトがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-281">Each availability in the Store has a corresponding [StoreAvailability](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeavailability.aspx) object.</span></span> <span data-ttu-id="1f745-282">すべての [StoreSku](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storesku.aspx) には、SKU の可用性にアクセスするために使用できる [Availabilities](https://docs.microsoft.com/uwp/api/windows.services.store.storesku.availabilities) プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-282">Every [StoreSku](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storesku.aspx) has an [Availabilities](https://docs.microsoft.com/uwp/api/windows.services.store.storesku.availabilities) property you can use to access the availabilities for the SKU.</span></span> <span data-ttu-id="1f745-283">ほとんどの開発者の場合、SKU ごとに 1 つの既定の可用性があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-283">For most developers, each SKU has a single default availability.</span></span>  |

<span id="store_ids" />

### <a name="store-ids"></a><span data-ttu-id="1f745-284">ストア ID</span><span class="sxs-lookup"><span data-stu-id="1f745-284">Store IDs</span></span>

<span data-ttu-id="1f745-285">アプリやアドオンなど、ストアのすべての製品には関連付けられた**ストア ID** があります (これは*製品ストア ID* と呼ばれることもあります)。</span><span class="sxs-lookup"><span data-stu-id="1f745-285">Every app, add-on, or other product in the Store has an associated **Store ID** (this is also sometimes called a *product Store ID*).</span></span> <span data-ttu-id="1f745-286">多くの API は、アプリまたはアドオンで操作を実行するためにストア ID を必要とします。</span><span class="sxs-lookup"><span data-stu-id="1f745-286">Many APIs require the Store ID in order to perform an operation on an app or add-on.</span></span>

<span data-ttu-id="1f745-287">ストア内の製品のストア ID は 12 文字の英数字文字列です。たとえば、```9NBLGGH4R315``` のようになります。</span><span class="sxs-lookup"><span data-stu-id="1f745-287">The Store ID of any product in the Store is 12-character alpha-numeric string, such as ```9NBLGGH4R315```.</span></span> <span data-ttu-id="1f745-288">ストア内の製品のストア ID は、次のようにさまざまな方法で取得できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-288">There are several different ways to get the Store ID for a product in the Store:</span></span>

* <span data-ttu-id="1f745-289">アプリの場合、ストア ID は、デベロッパー センター ダッシュボードの [[アプリ ID] ページ](../publish/view-app-identity-details.md)で取得できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-289">For an app, you can get the Store ID on the [App identity page](../publish/view-app-identity-details.md) of the Dev Center dashboard.</span></span>
* <span data-ttu-id="1f745-290">アドオンの場合、ストア ID はダッシュボードのアドオンの概要ページで取得できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-290">For an add-on, you can get the Store ID on the add-on's overview page in the dashboard.</span></span>
* <span data-ttu-id="1f745-291">製品の場合、その製品を表す [StoreProduct](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeproduct.aspx) オブジェクトの [StoreId](https://docs.microsoft.com/uwp/api/windows.services.store.storeproduct.storeid) プロパティを使用するにより、ストア ID をプログラムで取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="1f745-291">For any product, you can also get the Store ID programmatically by using the [StoreId](https://docs.microsoft.com/uwp/api/windows.services.store.storeproduct.storeid) property of the [StoreProduct](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeproduct.aspx) object that represents the product.</span></span>

<span data-ttu-id="1f745-292">製品の SKU と可用性の場合は、その SKU と可用性にも形式の異なる固有のストア ID が用意されています。</span><span class="sxs-lookup"><span data-stu-id="1f745-292">For products with SKUs and availabilities, the SKUs and availabilities also have their own Store IDs with different formats.</span></span>

| <span data-ttu-id="1f745-293">オブジェクト</span><span class="sxs-lookup"><span data-stu-id="1f745-293">Object</span></span> |  <span data-ttu-id="1f745-294">ストア ID の形式</span><span class="sxs-lookup"><span data-stu-id="1f745-294">Store ID format</span></span>  |
|---------|-------------------|
| <span data-ttu-id="1f745-295">SKU</span><span class="sxs-lookup"><span data-stu-id="1f745-295">SKU</span></span> |  <span data-ttu-id="1f745-296">SKU の場合、ストア ID の形式は ```<product Store ID>/xxxx``` のようになります。ここで、```xxxx``` は製品の SKU を識別する 4 文字の英数字文字列です。</span><span class="sxs-lookup"><span data-stu-id="1f745-296">The Store ID for a SKU has the format ```<product Store ID>/xxxx```, where ```xxxx``` is a 4-character alpha-numeric string that identifies a SKU for the product.</span></span> <span data-ttu-id="1f745-297">たとえば、```9NBLGGH4R315/000N``` と記述します。</span><span class="sxs-lookup"><span data-stu-id="1f745-297">For example, ```9NBLGGH4R315/000N```.</span></span> <span data-ttu-id="1f745-298">この ID は、[StoreSku](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storesku.aspx) オブジェクトの [StoreId](https://docs.microsoft.com/uwp/api/windows.services.store.storesku.storeid) プロパティによって返され、*SKU ストア ID* と呼ばれることもあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-298">This ID is returned by the [StoreId](https://docs.microsoft.com/uwp/api/windows.services.store.storesku.storeid) property of a  [StoreSku](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storesku.aspx) object, and it is sometimes called the *SKU Store ID*.</span></span> |
| <span data-ttu-id="1f745-299">可用性</span><span class="sxs-lookup"><span data-stu-id="1f745-299">Availability</span></span>  |  <span data-ttu-id="1f745-300">可用性の場合、ストア ID の形式は ```<product Store ID>/xxxx/yyyyyyyyyyyy``` のようになります。ここで、```xxxx``` は製品の SKU を識別する 4 文字の英数字文字列で、```yyyyyyyyyyyy``` は SKU の可用性を識別する 12 文字の英数字文字列です。</span><span class="sxs-lookup"><span data-stu-id="1f745-300">The Store ID for an availability has the format ```<product Store ID>/xxxx/yyyyyyyyyyyy```, where ```xxxx``` is a 4-character alpha-numeric string that identifies a SKU for the product and ```yyyyyyyyyyyy``` is a 12-character alpha-numeric string that identifies an availability for the SKU.</span></span> <span data-ttu-id="1f745-301">たとえば、```9NBLGGH4R315/000N/4KW6QZD2VN6X``` と記述します。</span><span class="sxs-lookup"><span data-stu-id="1f745-301">For example, ```9NBLGGH4R315/000N/4KW6QZD2VN6X```.</span></span> <span data-ttu-id="1f745-302">この ID は、[StoreAvailability](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeavailability.aspx) オブジェクトの [StoreId](https://docs.microsoft.com/uwp/api/windows.services.store.storeavailability.storeid) プロパティによって返され、*可用性ストア ID* と呼ばれることもあります。</span><span class="sxs-lookup"><span data-stu-id="1f745-302">This ID is returned by the [StoreId](https://docs.microsoft.com/uwp/api/windows.services.store.storeavailability.storeid) property of a  [StoreAvailability](https://msdn.microsoft.com/library/windows/apps/windows.services.store.storeavailability.aspx) object, and it is sometimes called the *availability Store ID*.</span></span>  |

<span id="product-ids" />

## <a name="how-to-use-product-ids-for-add-ons-in-your-code"></a><span data-ttu-id="1f745-303">コードでアドオンの製品 ID を使用する方法</span><span class="sxs-lookup"><span data-stu-id="1f745-303">How to use product IDs for add-ons in your code</span></span>

<span data-ttu-id="1f745-304">アプリのコンテキストでユーザーがアドオンを利用できるようにするには、デベロッパー センター ダッシュボードで[アドオンの申請を作成する](../publish/add-on-submissions.md)ときに、アドオン用の[固有の製品 ID を入力](../publish/set-your-add-on-product-id.md#product-id)しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="1f745-304">If you want to make an add-on available to your customers in the context of your app, you must [enter a unique product ID](../publish/set-your-add-on-product-id.md#product-id) for your add-on when you [create your add-on submission](../publish/add-on-submissions.md) in the Dev Center dashboard.</span></span> <span data-ttu-id="1f745-305">この製品 ID を使用することでコード内でアドオンを参照できます。ただし、製品 ID を使用できる特定のシナリオは、アプリのアプリ内購入に使用する名前空間によって異なります。</span><span class="sxs-lookup"><span data-stu-id="1f745-305">You can use this product ID to refer to the add-on in your code, although the specific scenarios in which you can use the product ID depend on which namespace you use for in-app purchases in your app.</span></span>

> [!NOTE]
> <span data-ttu-id="1f745-306">デベロッパー センター ダッシュボードでアドオン用に入力する製品 ID は、アドオンの[ストア ID](#store-ids) とは異なります。</span><span class="sxs-lookup"><span data-stu-id="1f745-306">The product ID that you enter in the Dev Center dashboard for an add-on is different than the add-on's [Store ID](#store-ids).</span></span> <span data-ttu-id="1f745-307">ストア ID はデベロッパー センターによって生成されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-307">The Store ID is generated by Dev Center.</span></span>

### <a name="apps-that-use-the-windowsservicesstore-namespace"></a><span data-ttu-id="1f745-308">Windows.Services.Store 名前空間を使うアプリ</span><span class="sxs-lookup"><span data-stu-id="1f745-308">Apps that use the Windows.Services.Store namespace</span></span>

<span data-ttu-id="1f745-309">アプリで **Windows.Services.Store** 名前空間を使用している場合、製品 ID を使用することで、アドオンを表す [StoreProduct](https://docs.microsoft.com/uwp/api/Windows.Services.Store.StoreProduct) や、アドオンのライセンスを表す [StoreLicense](https://docs.microsoft.com/uwp/api/windows.services.store.storelicense) を簡単に識別できます。</span><span class="sxs-lookup"><span data-stu-id="1f745-309">If your app uses the **Windows.Services.Store** namespace, you can use the product ID to easily identify the [StoreProduct](https://docs.microsoft.com/uwp/api/Windows.Services.Store.StoreProduct) that represents your add-on or the [StoreLicense](https://docs.microsoft.com/uwp/api/windows.services.store.storelicense) that represents your add-on's license.</span></span> <span data-ttu-id="1f745-310">製品 ID は、[StoreProduct.InAppOfferToken](https://docs.microsoft.com/uwp/api/Windows.Services.Store.StoreProduct.InAppOfferToken) プロパティおよび [StoreLicense.InAppOfferToken](https://docs.microsoft.com/uwp/api/windows.services.store.storelicense.InAppOfferToken) プロパティにより公開されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-310">The product ID is exposed by the [StoreProduct.InAppOfferToken](https://docs.microsoft.com/uwp/api/Windows.Services.Store.StoreProduct.InAppOfferToken) and [StoreLicense.InAppOfferToken](https://docs.microsoft.com/uwp/api/windows.services.store.storelicense.InAppOfferToken) properties.</span></span>

> [!NOTE]
> <span data-ttu-id="1f745-311">製品 ID はコードでアドオンを識別する便利な方法ですが、**Windows.Services.Store** 名前空間のほとんどの操作では、製品 ID の代わりにアドオンの[ストア ID](#store-ids) を使用します。</span><span class="sxs-lookup"><span data-stu-id="1f745-311">Although the product ID is a useful way to identify an add-on in your code, most operations in the **Windows.Services.Store** namespace use the [Store ID](#store-ids) of an add-on instead of the product ID.</span></span> <span data-ttu-id="1f745-312">たとえば、アプリの 1 つ以上の既知のアドオンをプログラムで取得するには、アドオンの (製品 ID ではなく) ストア ID を [GetStoreProductsAsync](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getstoreproductsasync) メソッドに渡します。</span><span class="sxs-lookup"><span data-stu-id="1f745-312">For example, to programmatically retrieve one or more known add-ons for an app, pass the Store IDs (rather than the product IDs) of the add-ons to the [GetStoreProductsAsync](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.getstoreproductsasync) method.</span></span> <span data-ttu-id="1f745-313">同様に、コンシューマブルなアドオンをフルフィルメント完了として報告するには、アドオンの (製品 ID ではなく) ストア ID を [ReportConsumableFulfillmentAsync](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.reportconsumablefulfillmentasync) メソッドに渡します。</span><span class="sxs-lookup"><span data-stu-id="1f745-313">Similarly, to report a consumable add-on as fulfilled, pass the Store ID of the add-on (rather than the product ID) to the [ReportConsumableFulfillmentAsync](https://docs.microsoft.com/uwp/api/windows.services.store.storecontext.reportconsumablefulfillmentasync) method.</span></span>

### <a name="apps-that-use-the-windowsapplicationmodelstore-namespace"></a><span data-ttu-id="1f745-314">Windows.ApplicationModel.Store 名前空間を使うアプリ</span><span class="sxs-lookup"><span data-stu-id="1f745-314">Apps that use the Windows.ApplicationModel.Store namespace</span></span>

<span data-ttu-id="1f745-315">アプリで **Windows.ApplicationModel.Store** 名前空間を使用している場合は、ほとんどの操作に、デベロッパー センター ダッシュボードでアドオンに割り当てた製品 ID を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1f745-315">If your app uses the **Windows.ApplicationModel.Store** namespace, you'll need to use the product ID that you assign to an add-on in the Dev Center dashboard for most operations.</span></span> <span data-ttu-id="1f745-316">次に、例を示します。</span><span class="sxs-lookup"><span data-stu-id="1f745-316">For example:</span></span>

* <span data-ttu-id="1f745-317">アドオンを表す [ProductListing](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlisting) や、アドオンのライセンスを表す [ProductLicense](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlicense) を識別するには、製品 ID を使用します。</span><span class="sxs-lookup"><span data-stu-id="1f745-317">Use the product ID to identify the [ProductListing](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlisting) that represents your add-on or the [ProductLicense](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlicense) that represents your add-on's license.</span></span> <span data-ttu-id="1f745-318">製品 ID は、[ProductListing.ProductId](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlisting.ProductId) プロパティおよび [ProductLicense.ProductId](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlicense.ProductId) プロパティにより公開されます。</span><span class="sxs-lookup"><span data-stu-id="1f745-318">The product ID is exposed by the [ProductListing.ProductId](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlisting.ProductId) and [ProductLicense.ProductId](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.productlicense.ProductId) properties.</span></span>

* <span data-ttu-id="1f745-319">ユーザーのアドオンを購入する場合は [RequestProductPurchaseAsync](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.currentapp.requestproductpurchaseasync) メソッドを使用して製品 ID を指定します。</span><span class="sxs-lookup"><span data-stu-id="1f745-319">Specify the product ID when you purchase your add-on for the user by using the [RequestProductPurchaseAsync](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.currentapp.requestproductpurchaseasync) method.</span></span> <span data-ttu-id="1f745-320">詳しくは、「[アプリ内製品購入の有効化](enable-in-app-product-purchases.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-320">For more information, see [Enable in-app product purchases](enable-in-app-product-purchases.md).</span></span>

* <span data-ttu-id="1f745-321">コンシューマブルなアドオンをフルフィルメント完了として報告する場合は [ReportConsumableFulfillmentAsync](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.currentapp.reportconsumablefulfillmentasync) メソッドを使用して製品 ID を指定します。</span><span class="sxs-lookup"><span data-stu-id="1f745-321">Specify the product ID when you report your consumable add-on as fulfilled by using the [ReportConsumableFulfillmentAsync](https://docs.microsoft.com/uwp/api/windows.applicationmodel.store.currentapp.reportconsumablefulfillmentasync) method.</span></span> <span data-ttu-id="1f745-322">詳しくは、「[コンシューマブルなアプリ内製品購入の有効化](enable-consumable-in-app-product-purchases.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="1f745-322">For more information, see [Enable consumable in-app product purchases](enable-consumable-in-app-product-purchases.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1f745-323">関連トピック</span><span class="sxs-lookup"><span data-stu-id="1f745-323">Related topics</span></span>

* [<span data-ttu-id="1f745-324">アプリとアドオンの製品情報の取得</span><span class="sxs-lookup"><span data-stu-id="1f745-324">Get product info for apps and add-ons</span></span>](get-product-info-for-apps-and-add-ons.md)
* [<span data-ttu-id="1f745-325">アプリとアドオンのライセンス情報の取得</span><span class="sxs-lookup"><span data-stu-id="1f745-325">Get license info for apps and add-ons</span></span>](get-license-info-for-apps-and-add-ons.md)
* [<span data-ttu-id="1f745-326">アプリとアドオンのアプリ内購入の有効化</span><span class="sxs-lookup"><span data-stu-id="1f745-326">Enable in-app purchases of apps and add-ons</span></span>](enable-in-app-purchases-of-apps-and-add-ons.md)
* [<span data-ttu-id="1f745-327">コンシューマブルなアドオン購入の有効化</span><span class="sxs-lookup"><span data-stu-id="1f745-327">Enable consumable add-on purchases</span></span>](enable-consumable-add-on-purchases.md)
* [<span data-ttu-id="1f745-328">アプリのサブスクリプション アドオンの有効化</span><span class="sxs-lookup"><span data-stu-id="1f745-328">Enable subscription add-ons for your app</span></span>](enable-subscription-add-ons-for-your-app.md)
* [<span data-ttu-id="1f745-329">アプリの試用版の実装</span><span class="sxs-lookup"><span data-stu-id="1f745-329">Implement a trial version of your app</span></span>](implement-a-trial-version-of-your-app.md)
* [<span data-ttu-id="1f745-330">Microsoft Store の操作のエラー コード</span><span class="sxs-lookup"><span data-stu-id="1f745-330">Error codes for Store operations</span></span>](error-codes-for-store-operations.md)
* [<span data-ttu-id="1f745-331">Windows.ApplicationModel.Store 名前空間を使用するアプリ内購入と試用版</span><span class="sxs-lookup"><span data-stu-id="1f745-331">In-app purchases and trials using the Windows.ApplicationModel.Store namespace</span></span>](in-app-purchases-and-trials-using-the-windows-applicationmodel-store-namespace.md)
