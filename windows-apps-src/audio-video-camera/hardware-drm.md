---
author: drewbatgit
ms.assetid: A7E0DA1E-535A-459E-9A35-68A4150EE9F5
description: このトピックでは、PlayReady ハードウェア ベースのデジタル著作権管理 (DRM) をユニバーサル Windows プラットフォーム (UWP) アプリに追加する方法の概要を示します。
title: ハードウェア DRM
ms.author: drewbat
ms.date: 02/08/2017
ms.topic: article
keywords: Windows 10, UWP
ms.localizationpriority: medium
ms.openlocfilehash: 6e898e342cb26ab86a74c30b5ced3dd3a9b68165
ms.sourcegitcommit: e814a13978f33654d8e995584f4b047cb53e0aef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/05/2018
ms.locfileid: "6023507"
---
# <a name="hardware-drm"></a><span data-ttu-id="1ff60-104">ハードウェア DRM</span><span class="sxs-lookup"><span data-stu-id="1ff60-104">Hardware DRM</span></span>


<span data-ttu-id="1ff60-105">このトピックでは、PlayReady ハードウェア ベースのデジタル著作権管理 (DRM) をユニバーサル Windows プラットフォーム (UWP) アプリに追加する方法の概要を示します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-105">This topic provides an overview of how to add PlayReady hardware-based digital rights management (DRM) to your Universal Windows Platform (UWP) app.</span></span>

> [!NOTE] 
> <span data-ttu-id="1ff60-106">ハードウェア ベースの PlayReady DRM は、Windows デバイスや Windows 以外のデバイスを含む多種多様なデバイス (テレビ セット、電話、タブレットなど) でサポートされます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-106">Hardware-based PlayReady DRM is supported on a multitude of devices, including both Windows and non-Windows devices such as TV sets, phones, and tablets.</span></span> <span data-ttu-id="1ff60-107">PlayReady ハードウェア DRM をサポートする Windows デバイスの場合、Windows 10 を実行しており、サポート対象のハードウェア構成を備えている必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-107">For a Windows device to support PlayReady Hardware DRM, it must be running Windows 10 and have a supported hardware configuration.</span></span>

<span data-ttu-id="1ff60-108">最近では、価値の高いコンテンツをアプリで再生するためのアクセス許可を付与できるように、ハードウェア ベースの保護に移行するコンテンツ プロバイダーが多くなっています。</span><span class="sxs-lookup"><span data-stu-id="1ff60-108">Increasingly, content providers are moving towards hardware-based protections for granting permission to play back full high value content in apps.</span></span> <span data-ttu-id="1ff60-109">PlayReady がこのニーズを満たすために、暗号化コアのハードウェアの実装の強力なサポートが追加されました。</span><span class="sxs-lookup"><span data-stu-id="1ff60-109">Robust support for a hardware implementation of the cryptographic core has been added to PlayReady to meet this need.</span></span> <span data-ttu-id="1ff60-110">このサポートにより、複数のデバイス プラットフォーム上で、高解像度 (1080 p) と超高解像度 (UHD) のコンテンツを安全に再生できます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-110">This support enables secure playback of high definition (1080p) and ultra-high definition (UHD) content on multiple device platforms.</span></span> <span data-ttu-id="1ff60-111">キー マテリアル (秘密キー、コンテンツ キー、これらのキーを派生またはロック解除するために使われるその他のキー マテリアルを含みます)、および暗号化解除された圧縮および非圧縮ビデオ サンプルは、ハードウェア セキュリティを利用して保護されます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-111">Key material (including private keys, content keys, and any other key material used to derive or unlock said keys), and decrypted compressed and uncompressed video samples are protected by leveraging hardware security.</span></span>

## <a name="windows-tee-implementation"></a><span data-ttu-id="1ff60-112">Windows TEE 実装</span><span class="sxs-lookup"><span data-stu-id="1ff60-112">Windows TEE implementation</span></span>

<span data-ttu-id="1ff60-113">このトピックでは、windows 10 が信頼された実行環境 (TEE) を実装する方法の簡単な概要を示します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-113">This topic provides a brief overview of how Windows10 implements the trusted execution environment (TEE).</span></span>

<span data-ttu-id="1ff60-114">Windows TEE 実装の詳細については、このドキュメントでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="1ff60-114">The details of the Windows TEE implementation is out of scope for this document.</span></span> <span data-ttu-id="1ff60-115">ただし、標準の移植キット TEE ポートと Windows ポートの違いについては、簡単に説明します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-115">However, a brief discussion of the difference between the standard porting kit TEE port and the Windows port will be beneficial.</span></span> <span data-ttu-id="1ff60-116">Windows は OEM プロキシ レイヤーを実装し、Windows メディア ファンデーション サブシステムのユーザー モード ドライバーに、シリアル化された PRITEE 関数呼び出しを転送します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-116">Windows implements the OEM proxy layer and transfers the serialized PRITEE functions calls to a user mode driver in the Windows Media Foundation subsystem.</span></span> <span data-ttu-id="1ff60-117">これは最終的に Windows TrEE (信頼される実行環境) ドライバーまたは OEM のグラフィックス ドライバーにルーティングされます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-117">This will eventually get routed to either the Windows TrEE (Trusted Execution Environment) driver or the OEM’s graphics driver.</span></span> <span data-ttu-id="1ff60-118">これらのいずれの方法についても、このドキュメントでは説明しません。</span><span class="sxs-lookup"><span data-stu-id="1ff60-118">The details of either of these approaches is out of scope for this document.</span></span> <span data-ttu-id="1ff60-119">次の図は、Windows ポートのコンポーネントの一般的な操作を示しています。</span><span class="sxs-lookup"><span data-stu-id="1ff60-119">The following diagram shows the general component interaction for the Windows port.</span></span> <span data-ttu-id="1ff60-120">Windows PlayReady TEE 実装を開発する場合は、<WMLA@Microsoft.com> にご連絡ください。</span><span class="sxs-lookup"><span data-stu-id="1ff60-120">If you want to develop a Windows PlayReady TEE implementation, you can contact <WMLA@Microsoft.com>.</span></span>

![Windows TEE コンポーネント図](images/windowsteecomponentdiagram720.jpg)

## <a name="considerations-for-using-hardware-drm"></a><span data-ttu-id="1ff60-122">ハードウェア DRM を使うための考慮事項</span><span class="sxs-lookup"><span data-stu-id="1ff60-122">Considerations for using hardware DRM</span></span>

<span data-ttu-id="1ff60-123">このトピックでは、ハードウェア DRM を使うように設計されたアプリを開発するときに考慮する必要がある事項について、簡単な一覧を使って説明します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-123">This topic provides a brief list of items that should be considered when developing apps designed to use hardware DRM.</span></span> <span data-ttu-id="1ff60-124">「[PlayReady DRM](playready-client-sdk.md#output-protection)」で説明されているように、Windows 10 用 PlayReady HWDRM では、すべての出力の保護は、出力の保護の動作に影響を与える Windows TEE 実装内から適用されます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-124">As explained in [PlayReady DRM](playready-client-sdk.md#output-protection), with PlayReady HWDRM for Windows 10, all output protections are enforced from within the Windows TEE implementation, which has some consequences on output protection behaviors:</span></span>

-   <span data-ttu-id="1ff60-125">**未圧縮デジタル ビデオ向けの出力保護レベル (OPL) 270 のサポート:** Windows 10 用 PlayReady HWDRM では、解像度の低下をサポートしておらず、HDCP が強制的に使われます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-125">**Support for output protection level (OPL) for uncompressed digital video 270:** PlayReady HWDRM for Windows 10 doesn't support down-resolution and will enforce that HDCP is engaged.</span></span> <span data-ttu-id="1ff60-126">HWDRM の高解像度コンテンツには、270 を超える OPL をお勧めします (ただし、必須ではありません)。</span><span class="sxs-lookup"><span data-stu-id="1ff60-126">We recommend that high definition content for HWDRM have an OPL greater than 270 (although it is not required).</span></span> <span data-ttu-id="1ff60-127">また、HDCP タイプの制限をライセンスで設定することもお勧めします (Windows 10 では HDCP バージョン 2.2)。</span><span class="sxs-lookup"><span data-stu-id="1ff60-127">Additionally, we recommend that you set HDCP type restriction in the license (HDCP version 2.2 on Windows 10).</span></span>
-   **<span data-ttu-id="1ff60-128">出力の保護は、ソフトウェア DRM (SWDRM) とは異なり、最も能力の低いモニターに基づいてすべてのモニターに適用されます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-128">Unlike software DRM (SWDRM), output protections are enforced on all monitors based on the least capable monitor.</span></span>** <span data-ttu-id="1ff60-129">たとえば、ユーザーが 2 台のモニターを接続していて、1 台のモニターが HDCP をサポートし、もう 1 台がサポートしていない場合、HDCP をサポートするモニターでコンテンツがレンダリングされているのみの場合でも、ライセンスに HDCP が必要な場合、再生は失敗します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-129">For example, if the user has two monitors connected where one of the monitors supports HDCP and the other does not, playback will fail if the license requires HDCP even if the content is only being rendered on the monitor that supports HDCP.</span></span> <span data-ttu-id="1ff60-130">ソフトウェア DRM では、HDCP をサポートしているモニターにレンダリングされているのみの場合、コンテンツは再生されます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-130">In software DRM, content would play back as long as it is only being rendered on the monitor that supports HDCP.</span></span>
-   <span data-ttu-id="1ff60-131">コンテンツのキーとライセンスで、**次の条件が満たされていない限り、HWDRM がクライアントで使用されることと、安全であることが保証されません**。</span><span class="sxs-lookup"><span data-stu-id="1ff60-131">**HWDRM is not guaranteed to be used by the client and secure unless the following conditions are met** by the content keys and licenses:</span></span>
    -   <span data-ttu-id="1ff60-132">ビデオのコンテンツ キーに使われるライセンスには、最低限のセキュリティ レベルとして 3000 が必要です。</span><span class="sxs-lookup"><span data-stu-id="1ff60-132">The license used for the video content key must have a Minimum Security level property of 3000.</span></span>
    -   <span data-ttu-id="1ff60-133">オーディオは、ビデオとは異なるコンテンツ キーに暗号化される必要があります。また、オーディオに使われるライセンスには、最低限のセキュリティ レベルとして 2000 が必要です。</span><span class="sxs-lookup"><span data-stu-id="1ff60-133">Audio must be encrypted to a different content key than video, and the license used for the audio must have a Minimum Security level property of 2000.</span></span> <span data-ttu-id="1ff60-134">または、オーディオをプレーン テキストのままにしてくこともできます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-134">Alternatively, audio could be left in the clear.</span></span>
    
<span data-ttu-id="1ff60-135">HWDRM を使うときは、次の項目も考慮してください。</span><span class="sxs-lookup"><span data-stu-id="1ff60-135">Additionally, you should take the following items into consideration when using HWDRM:</span></span>

-   <span data-ttu-id="1ff60-136">保護されたメディア プロセス (PMP) はサポートされません。</span><span class="sxs-lookup"><span data-stu-id="1ff60-136">Protected Media Process (PMP) is not supported.</span></span>
-   <span data-ttu-id="1ff60-137">Windows Media ビデオ (VC-1 とも呼ばれます) はサポートされません (「[ハードウェア DRM のオーバーライド](#override-hardware-drm)」をご覧ください)。</span><span class="sxs-lookup"><span data-stu-id="1ff60-137">Windows Media Video (also known as VC-1) is not supported (see [Override hardware DRM](#override-hardware-drm)).</span></span>
-   <span data-ttu-id="1ff60-138">永続的なライセンスには、複数のグラフィックス処理装置 (GPU) はサポートされません。</span><span class="sxs-lookup"><span data-stu-id="1ff60-138">Multiple graphics processing units (GPUs) are not supported for persistent licenses.</span></span>

<span data-ttu-id="1ff60-139">複数の GPU を持つコンピューターで、永続的なライセンスを処理するには、次のシナリオについて考えてみます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-139">To handle persistent licenses on machines with multiple GPUs, consider the following scenario:</span></span>

1.  <span data-ttu-id="1ff60-140">顧客が、グラフィックス カードが搭載された新しいコンピューターを購入します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-140">A customer buys a new machine with an integrated graphics card.</span></span>
2.  <span data-ttu-id="1ff60-141">顧客は、ハードウェア DRM の使用中に永続的なライセンスを取得するアプリを使います。</span><span class="sxs-lookup"><span data-stu-id="1ff60-141">The customer uses an app that acquires persistent licenses while using hardware DRM.</span></span>
3.  <span data-ttu-id="1ff60-142">これで、永続的なライセンスがそのグラフィックス カードのハードウェア キーにバインドされます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-142">The persistent license is now bound to that graphics card’s hardware keys.</span></span>
4.  <span data-ttu-id="1ff60-143">次に、顧客は新しいグラフィックス カードを取り付けます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-143">The customer then installs a new graphics card.</span></span>
5.  <span data-ttu-id="1ff60-144">ハッシュされたデータ ストア (HDS) 内のすべてのライセンスは、搭載されたビデオ カードにバインドされますが、ユーザーは新たに取り付けられたグラフィックス カードを使って、保護されたコンテンツを再生したいと考えています。</span><span class="sxs-lookup"><span data-stu-id="1ff60-144">All licenses in the hashed data store (HDS) are bound to the integrated video card, but the customer now wants to play back protected content using the newly-installed graphics card.</span></span>

<span data-ttu-id="1ff60-145">ハードウェアでライセンスの暗号化を解除できないことが原因で再生エラーが発生するのを防ぐために、PlayReady は、見つかったグラフィックス カードごとに、個別 HDS を使います。</span><span class="sxs-lookup"><span data-stu-id="1ff60-145">To prevent playback from failing because the licenses can’t be decrypted by the hardware, PlayReady uses a separate HDS for each graphics card that it encounters.</span></span> <span data-ttu-id="1ff60-146">これにより、PlayReady は、通常は既にライセンスを持っているコンテンツのライセンスの取得を試みます (ソフトウェア DRM の場合、またはハードウェアの変更がない場合、PlayReady はライセンスを再取得する必要はありません)。</span><span class="sxs-lookup"><span data-stu-id="1ff60-146">This will cause PlayReady to attempt license acquisition for a piece of content where PlayReady would normally already have a license (that is, in the software DRM case or any case without a hardware change, PlayReady wouldn’t need to reacquire a license).</span></span> <span data-ttu-id="1ff60-147">したがって、アプリが、ハードウェア DRM の使用中に永続的なライセンスを取得した場合、アプリは、エンド ユーザーがグラフィックス カードを取り付けた (または取り外した) 場合にそのライセンスが実質的に失われるケースに対応できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-147">Therefore, if the app acquires a persistent license while using hardware DRM, your app needs to be able to handle the case where that license is effectively “lost” if the end user installs (or uninstalls) a graphics card.</span></span> <span data-ttu-id="1ff60-148">これは一般的なシナリオではないため、ハードウェアの変更後にコンテンツが再生されなくなった場合、クライアント/サーバー コードでハードウェアの変更を処理する方法の調査よりも、サポートへの問い合わせの対応が必要になることがあります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-148">Because this is not a common scenario, you may decide to handle the support calls when the content no longer plays after a hardware change rather than figure out how to deal with a hardware change in the client/server code.</span></span>

## <a name="override-hardware-drm"></a><span data-ttu-id="1ff60-149">ハードウェア DRM のオーバーライド</span><span class="sxs-lookup"><span data-stu-id="1ff60-149">Override hardware DRM</span></span>

<span data-ttu-id="1ff60-150">このセクションでは、再生するコンテンツがハードウェア DRM (HWDRM) をサポートしていない場合に、ハードウェア DRM をオーバーライドする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-150">This section describes how to override hardware DRM (HWDRM) if the content to be played back does not support hardware DRM.</span></span>

<span data-ttu-id="1ff60-151">既定では、システムによってサポートされている場合は、ハードウェア DRM が使われます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-151">By default, hardware DRM is used if the system supports it.</span></span> <span data-ttu-id="1ff60-152">ただし、一部のコンテンツは、ハードウェア DRM ではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="1ff60-152">However, some content is not supported in hardware DRM.</span></span> <span data-ttu-id="1ff60-153">この 1 つの例として、Cocktail コンテンツがあります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-153">One example of this is Cocktail content.</span></span> <span data-ttu-id="1ff60-154">別の例として、H.264 と HEVC 以外のビデオ コーデックを使う任意のコンテンツがあります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-154">Another example is any content that uses a video codec other than H.264 and HEVC.</span></span> <span data-ttu-id="1ff60-155">さらに別の例として、HEVC コンテンツがあります。ハードウェアによって、HEVC をサポートしているものと、そうでないものがあります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-155">Another example is HEVC content, as some hardware DRM will support HEVC and some will not.</span></span> <span data-ttu-id="1ff60-156">そのため、コンテンツを再生する場合に、ハードウェア DRM が該当のシステムでこれをサポートしていない場合は、ハードウェア DRM を除外することができます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-156">Therefore, if you want to play a piece of content and hardware DRM doesn’t support it on the system in question, you may want to opt out of hardware DRM.</span></span>

<span data-ttu-id="1ff60-157">次の例は、ハードウェア DRM の除外方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="1ff60-157">The following example shows how to opt-out of hardware DRM.</span></span> <span data-ttu-id="1ff60-158">この操作は、切り替えの前にのみ行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-158">You only need to do this before you switch.</span></span> <span data-ttu-id="1ff60-159">また、メモリ内に PlayReady オブジェクトが存在していないことも確認してください。存在する場合は、動作が未定義になります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-159">Also, make sure you don’t have any PlayReady object in memory, otherwise behavior is undefined.</span></span>

```js
var applicationData = Windows.Storage.ApplicationData.current;
var localSettings = applicationData.localSettings.createContainer("PlayReady", Windows.Storage.ApplicationDataCreateDisposition.always);
localSettings.values["SoftwareOverride"] = 1;
```

<span data-ttu-id="1ff60-160">ハードウェア DRM に切り替えるには、**SoftwareOverride** の値を **0** に設定します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-160">To switch back to hardware DRM, set the **SoftwareOverride** value to **0**.</span></span>

<span data-ttu-id="1ff60-161">すべてのメディア再生で、**MediaProtectionManager** を次のように設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ff60-161">For every media playback, you need to set **MediaProtectionManager** to:</span></span>

```js
mediaProtectionManager.properties["Windows.Media.Protection.UseSoftwareProtectionLayer"] = true;
```

<span data-ttu-id="1ff60-162">ハードウェア DRM を使用しているか、ソフトウェア DRM は、C:\\Users\\ を参照するよう指示する最善の方法&lt;ユーザー名&gt;\\AppData\\Local\\Packages\\&lt;アプリケーション名&gt;\\LocalCache\\PlayReady\\\*</span><span class="sxs-lookup"><span data-stu-id="1ff60-162">The best way to tell if you are in hardware DRM or software DRM is to look at C:\\Users\\&lt;username&gt;\\AppData\\Local\\Packages\\&lt;application name&gt;\\LocalCache\\PlayReady\\\*</span></span>

-   <span data-ttu-id="1ff60-163">mspr.hds ファイルがある場合は、ソフトウェア DRM を使っています。</span><span class="sxs-lookup"><span data-stu-id="1ff60-163">If there is an mspr.hds file, you are in software DRM.</span></span>
-   <span data-ttu-id="1ff60-164">他の \*.hds ファイルがある場合は、ハードウェア DRM を使っています。</span><span class="sxs-lookup"><span data-stu-id="1ff60-164">If you have another \*.hds file, you are in hardware DRM.</span></span>
-   <span data-ttu-id="1ff60-165">PlayReady フォルダー全体を削除して、テストを再試行することもできます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-165">You can delete the entire PlayReady folder and retry your test as well.</span></span>

## <a name="detect-the-type-of-hardware-drm"></a><span data-ttu-id="1ff60-166">ハードウェア DRM の種類を検出する</span><span class="sxs-lookup"><span data-stu-id="1ff60-166">Detect the type of hardware DRM</span></span>

<span data-ttu-id="1ff60-167">このセクションでは、システムでサポートされているハードウェア DRM の種類を検出する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-167">This section describes how to detect what type of hardware DRM is supported on the system.</span></span>

<span data-ttu-id="1ff60-168">[**PlayReadyStatics.CheckSupportedHardware**](https://msdn.microsoft.com/library/windows/apps/dn986441) メソッドを使って、システムが特定のハードウェア DRM 機能をサポートしているかどうかを判断できます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-168">You can use the [**PlayReadyStatics.CheckSupportedHardware**](https://msdn.microsoft.com/library/windows/apps/dn986441) method to determine whether the system supports a specific hardware DRM feature.</span></span> <span data-ttu-id="1ff60-169">次に例を示します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-169">For example:</span></span>

```csharp
bool isFeatureSupported = PlayReadyStatics.CheckSupportedHardware(PlayReadyHardwareDRMFeatures.HEVC);
```

<span data-ttu-id="1ff60-170">[**PlayReadyHardwareDRMFeatures**](https://msdn.microsoft.com/library/windows/apps/dn986265) 列挙体には、照会できるハードウェア DRM 機能の値の有効な一覧が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-170">The [**PlayReadyHardwareDRMFeatures**](https://msdn.microsoft.com/library/windows/apps/dn986265) enumeration contains the valid list of hardware DRM feature values that can be queried.</span></span> <span data-ttu-id="1ff60-171">ハードウェア DRM がサポートされているかどうかを判断するには、クエリで **HardwareDRM** メンバーを使います。</span><span class="sxs-lookup"><span data-stu-id="1ff60-171">To determine if hardware DRM is supported, use the **HardwareDRM** member in the query.</span></span> <span data-ttu-id="1ff60-172">ハードウェアが高効率ビデオ コーディング (HEVC)/H.265 コーデックをサポートしているかどうかを判断するには、クエリで **HEVC** メンバーを使います。</span><span class="sxs-lookup"><span data-stu-id="1ff60-172">To determine if the hardware supports the High Efficiency Video Coding (HEVC)/H.265 codec, use the **HEVC** member in the query.</span></span>

<span data-ttu-id="1ff60-173">[**PlayReadyStatics.PlayReadyCertificateSecurityLevel**](https://msdn.microsoft.com/library/windows/apps/windows.media.protection.playready.playreadystatics.playreadycertificatesecuritylevel.aspx) プロパティを使って、クライアント証明書のセキュリティ レベルを取得し、ハードウェア DRM がサポートされているかどうか判断することもできます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-173">You can also use the [**PlayReadyStatics.PlayReadyCertificateSecurityLevel**](https://msdn.microsoft.com/library/windows/apps/windows.media.protection.playready.playreadystatics.playreadycertificatesecuritylevel.aspx) property to get the security level of the client certificate to determine if hardware DRM is supported.</span></span> <span data-ttu-id="1ff60-174">返された証明書のセキュリティ レベルが 3000 以上でない限り、クライアントが個別化またはプロビジョニングされていないか (この場合、このプロパティは 0 を返します)、ハードウェア DRM が使われていません (この場合、このプロパティは 3000 未満の値を返します)。</span><span class="sxs-lookup"><span data-stu-id="1ff60-174">Unless the returned certificate security level is greater than or equal to 3000, either the client is not individualized or provisioned (in which case this property returns 0) or hardware DRM is not in use (in which case this property returns a value that is less than 3000).</span></span>

### <a name="detecting-support-for-aes128cbc-hardware-drm"></a><span data-ttu-id="1ff60-175">AES128CBC ハードウェア DRM のサポートの検出</span><span class="sxs-lookup"><span data-stu-id="1ff60-175">Detecting support for AES128CBC hardware DRM</span></span>
<span data-ttu-id="1ff60-176">Windows 10、バージョン 1709 以降では、デバイス上での AES128CBC ハードウェア暗号化のサポート状況を検出できます。これには、**[PlayReadyStatics.CheckSupportedHardware](https://msdn.microsoft.com/library/windows/apps/dn986441)** を呼び出して、列挙値 [**PlayReadyHardwareDRMFeatures.Aes128Cbc**](https://msdn.microsoft.com/library/windows/apps/dn986265) を指定します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-176">Starting with Windows 10, version 1709, you can detect support for AES128CBC hardware encryption on a device by calling **[PlayReadyStatics.CheckSupportedHardware](https://msdn.microsoft.com/library/windows/apps/dn986441)** and specifying the enumeration value [**PlayReadyHardwareDRMFeatures.Aes128Cbc**](https://msdn.microsoft.com/library/windows/apps/dn986265).</span></span> <span data-ttu-id="1ff60-177">以前のバージョンの Windows 10 では、この値を指定すると、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="1ff60-177">On previous versions of Windows 10, specifying this value will cause an exception to be thrown.</span></span> <span data-ttu-id="1ff60-178">このため、**CheckSupportedHardware** を呼び出す前に、**[ApiInformation.IsApiContractPresent](https://docs.microsoft.com/uwp/api/windows.foundation.metadata.apiinformation.isapicontractpresent)** を呼び出して、メジャー コントラクト バージョン 5 を指定し、この列挙値が存在していることを確認します。</span><span class="sxs-lookup"><span data-stu-id="1ff60-178">For this reason, you should check for the presence of the enumeration value by calling **[ApiInformation.IsApiContractPresent](https://docs.microsoft.com/uwp/api/windows.foundation.metadata.apiinformation.isapicontractpresent)** and specifying major contract version 5 before calling **CheckSupportedHardware**.</span></span>

```csharp
bool supportsAes128Cbc = ApiInformation.IsApiContractPresent("Windows.Foundation.UniversalApiContract", 5);

if (supportsAes128Cbc)
{
    supportsAes128Cbc = PlayReadyStatics.CheckSupportedHardware(PlayReadyHardwareDRMFeatures.Aes128Cbc);
}
```

## <a name="see-also"></a><span data-ttu-id="1ff60-179">関連項目</span><span class="sxs-lookup"><span data-stu-id="1ff60-179">See also</span></span>
- [<span data-ttu-id="1ff60-180">PlayReady DRM</span><span class="sxs-lookup"><span data-stu-id="1ff60-180">PlayReady DRM</span></span>](playready-client-sdk.md)
