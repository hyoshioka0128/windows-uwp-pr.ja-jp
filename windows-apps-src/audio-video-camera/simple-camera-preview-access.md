---
ms.assetid: 9BA3F85A-970F-411C-ACB1-B65768B8548A
description: この記事では、ユニバーサル Windows プラットフォーム (UWP) アプリで XAML ページ内にカメラ プレビュー ストリームをすばやく表示する方法について説明します。
title: カメラ プレビューの表示
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: 7fba78a619f18d7da2e190758d73ac7a56b12fb9
ms.sourcegitcommit: ac7f3422f8d83618f9b6b5615a37f8e5c115b3c4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/29/2019
ms.locfileid: "66360656"
---
# <a name="display-the-camera-preview"></a><span data-ttu-id="52958-104">カメラ プレビューの表示</span><span class="sxs-lookup"><span data-stu-id="52958-104">Display the camera preview</span></span>


<span data-ttu-id="52958-105">この記事では、ユニバーサル Windows プラットフォーム (UWP) アプリで XAML ページ内にカメラ プレビュー ストリームをすばやく表示する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="52958-105">This article describes how to quickly display the camera preview stream within a XAML page in a Universal Windows Platform (UWP) app.</span></span> <span data-ttu-id="52958-106">カメラを使って写真やビデオをキャプチャするアプリを作成するには、デバイスとカメラの向きの処理や、キャプチャされたファイルのエンコーディング オプションの設定などのタスクを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="52958-106">Creating an app that captures photos and videos using the camera requires you to perform tasks like handling device and camera orientation or setting encoding options for the captured file.</span></span> <span data-ttu-id="52958-107">アプリ シナリオによっては、このような他の考慮事項について考えなくても、カメラからプレビュー ストリームをそのまま表示することができます。</span><span class="sxs-lookup"><span data-stu-id="52958-107">For some app scenarios, you may want to just simply show the preview stream from the camera without worrying about these other considerations.</span></span> <span data-ttu-id="52958-108">この記事では、最小限のコードでそれを行う方法を示します。</span><span class="sxs-lookup"><span data-stu-id="52958-108">This article shows you how to do that with a minimum of code.</span></span> <span data-ttu-id="52958-109">プレビュー ストリームの操作が完了したら、必ず以下の手順に従ってプレビュー ストリームを正しくシャットダウンする必要がある点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="52958-109">Note that you should always shut down the preview stream properly when you are done with it by following the steps below.</span></span>

<span data-ttu-id="52958-110">写真やビデオをキャプチャするカメラ アプリの作成方法について詳しくは、「[MediaCapture を使った基本的な写真、ビデオ、およびオーディオのキャプチャ](basic-photo-video-and-audio-capture-with-MediaCapture.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="52958-110">For information on writing a camera app that captures photos or videos, see [Basic photo, video, and audio capture with MediaCapture](basic-photo-video-and-audio-capture-with-MediaCapture.md).</span></span>

## <a name="add-capability-declarations-to-the-app-manifest"></a><span data-ttu-id="52958-111">アプリ マニフェストに機能宣言を追加する</span><span class="sxs-lookup"><span data-stu-id="52958-111">Add capability declarations to the app manifest</span></span>

<span data-ttu-id="52958-112">アプリからデバイスのカメラにアクセスするには、アプリでデバイス機能 (*webcam* と *microphone*) の使用を宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="52958-112">In order for your app to access a device's camera, you must declare that your app uses the *webcam* and *microphone* device capabilities.</span></span> 

<span data-ttu-id="52958-113">**アプリケーション マニフェストに機能を追加します。**</span><span class="sxs-lookup"><span data-stu-id="52958-113">**Add capabilities to the app manifest**</span></span>

1.  <span data-ttu-id="52958-114">Microsoft Visual Studio の**ソリューション エクスプローラー**で、**package.appxmanifest** 項目をダブルクリックしてアプリケーション マニフェストのデザイナーを開きます。</span><span class="sxs-lookup"><span data-stu-id="52958-114">In Microsoft Visual Studio, in **Solution Explorer**, open the designer for the application manifest by double-clicking the **package.appxmanifest** item.</span></span>
2.  <span data-ttu-id="52958-115">**[機能]** タブをクリックします。</span><span class="sxs-lookup"><span data-stu-id="52958-115">Select the **Capabilities** tab.</span></span>
3.  <span data-ttu-id="52958-116">**[Web カメラ]** のボックスと **[マイク]** のボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="52958-116">Check the box for **Webcam** and the box for **Microphone**.</span></span>

## <a name="add-a-captureelement-to-your-page"></a><span data-ttu-id="52958-117">ページに CaptureElement コントロールを追加する</span><span class="sxs-lookup"><span data-stu-id="52958-117">Add a CaptureElement to your page</span></span>

<span data-ttu-id="52958-118">[  **CaptureElement**](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.CaptureElement) を使って、XAML ページ内にプレビュー ストリームを表示します。</span><span class="sxs-lookup"><span data-stu-id="52958-118">Use a [**CaptureElement**](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.CaptureElement) to display the preview stream within your XAML page.</span></span>

[!code-xml[CaptureElement](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml#SnippetCaptureElement)]



## <a name="use-mediacapture-to-start-the-preview-stream"></a><span data-ttu-id="52958-119">MediaCapture を使ってプレビュー ストリームを開始する</span><span class="sxs-lookup"><span data-stu-id="52958-119">Use MediaCapture to start the preview stream</span></span>

<span data-ttu-id="52958-120">[  **MediaCapture**](https://docs.microsoft.com/uwp/api/Windows.Media.Capture.MediaCapture) オブジェクトは、デバイスのカメラに対するアプリのインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="52958-120">The [**MediaCapture**](https://docs.microsoft.com/uwp/api/Windows.Media.Capture.MediaCapture) object is your app's interface to the device's camera.</span></span> <span data-ttu-id="52958-121">このクラスは、Windows.Media.Capture 名前空間のメンバーです。</span><span class="sxs-lookup"><span data-stu-id="52958-121">This class is a member of the Windows.Media.Capture namespace.</span></span> <span data-ttu-id="52958-122">この記事の例では、既定のプロジェクト テンプレートに含まれている API に加えて、[**Windows.ApplicationModel**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel) 名前空間と [System.Threading.Tasks](https://docs.microsoft.com/dotnet/api/system.threading.tasks?redirectedfrom=MSDN) 名前空間の API も使われます。</span><span class="sxs-lookup"><span data-stu-id="52958-122">The example in this article also uses APIs from the [**Windows.ApplicationModel**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel) and [System.Threading.Tasks](https://docs.microsoft.com/dotnet/api/system.threading.tasks?redirectedfrom=MSDN) namespaces, in addition to those included by the default project template.</span></span>

<span data-ttu-id="52958-123">ページの .cs ファイルに次の名前空間を含めるには using ディレクティブを追加します。</span><span class="sxs-lookup"><span data-stu-id="52958-123">Add using directives to include the following namespaces in your page's .cs file.</span></span>

[!code-cs[SimpleCameraPreviewUsing](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetSimpleCameraPreviewUsing)]

<span data-ttu-id="52958-124">**MediaCapture** オブジェクトのクラス メンバー変数と、カメラが現在プレビューを表示しているかどうかを追跡するブール値を宣言します。</span><span class="sxs-lookup"><span data-stu-id="52958-124">Declare a class member variable for the **MediaCapture** object and a boolean to track whether the camera is currently previewing.</span></span> 

[!code-cs[DeclareMediaCapture](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetDeclareMediaCapture)]

<span data-ttu-id="52958-125">プレビューの実行中にディスプレイがオフになっていないことを確認するために使用する、[**DisplayRequest**](https://docs.microsoft.com/uwp/api/Windows.System.Display.DisplayRequest) 型の変数を宣言します。</span><span class="sxs-lookup"><span data-stu-id="52958-125">Declare a variable of type [**DisplayRequest**](https://docs.microsoft.com/uwp/api/Windows.System.Display.DisplayRequest) that will be used to make sure the display does not turn off while the preview is running.</span></span>

[!code-cs[DeclareDisplayRequest](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetDeclareDisplayRequest)]

<span data-ttu-id="52958-126">カメラのプレビューを起動するヘルパー メソッド (この例では **StartPreviewAsync**) を作成します。</span><span class="sxs-lookup"><span data-stu-id="52958-126">Create a helper method to start up the camera preview, called **StartPreviewAsync** in this example.</span></span> <span data-ttu-id="52958-127">アプリのシナリオによって、ページが読み込まれるときに呼び出される **OnNavigatedTo** イベント ハンドラーからこれを呼び出すことも、UI イベントへの応答でプレビューを待機して起動することもできます。</span><span class="sxs-lookup"><span data-stu-id="52958-127">Depending on your app's scenario, you may want to call this from the **OnNavigatedTo** event handler that is called when the page is loaded or wait and launch the preview in response to UI events.</span></span>

<span data-ttu-id="52958-128">**MediaCapture** クラスの新しいインスタンスを作成し、[**InitializeAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.initializeasync) を呼び出してキャプチャ デバイスを初期化します。</span><span class="sxs-lookup"><span data-stu-id="52958-128">Create a new instance of the **MediaCapture** class and call [**InitializeAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.initializeasync) to initialize the capture device.</span></span> <span data-ttu-id="52958-129">カメラがないデバイスなどではこのメソッドが失敗することがあるため、**try** ブロック内から呼び出してください。</span><span class="sxs-lookup"><span data-stu-id="52958-129">This method may fail, on devices that don't have a camera for example, so you should call it from within a **try** block.</span></span> <span data-ttu-id="52958-130">ユーザーがデバイスのプライバシー設定でカメラへのアクセスを無効にしている場合、カメラを初期化しようとすると **UnauthorizedAccessException** がスローされます。</span><span class="sxs-lookup"><span data-stu-id="52958-130">An **UnauthorizedAccessException** will be thrown when you attempt to initialize the camera if the user has disabled camera access in the device's privacy settings.</span></span> <span data-ttu-id="52958-131">この例外は、開発中、アプリ マニフェストに適切な機能を追加し忘れた場合も表示されます。</span><span class="sxs-lookup"><span data-stu-id="52958-131">You will also see this exception during development if you have neglected to add the proper capabilities to your app manifest.</span></span>

<span data-ttu-id="52958-132">**重要:** 一部のデバイス ファミリでは、アプリがデバイスのカメラへのアクセスを付与される前に、ユーザー同意のプロンプトがユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="52958-132">**Important** On some device families, a user consent prompt is displayed to the user before your app is granted access to the device's camera.</span></span> <span data-ttu-id="52958-133">このため、[**MediaCapture.InitializeAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.initializeasync) のみをメイン UI スレッドから呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="52958-133">For this reason, you must only call [**MediaCapture.InitializeAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.initializeasync) from the main UI thread.</span></span> <span data-ttu-id="52958-134">別のスレッドからカメラを初期化しようとすると、初期化エラーになる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="52958-134">Attempting to initialize the camera from another thread may result in initialization failure.</span></span>

<span data-ttu-id="52958-135">[  **Source**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.captureelement.source) プロパティを設定して、**MediaCapture** を **CaptureElement** に接続します。</span><span class="sxs-lookup"><span data-stu-id="52958-135">Connect the **MediaCapture** to the **CaptureElement** by setting the [**Source**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.captureelement.source) property.</span></span> <span data-ttu-id="52958-136">[  **StartPreviewAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.startpreviewasync) を呼び出してプレビューを開始します。</span><span class="sxs-lookup"><span data-stu-id="52958-136">Start the preview by calling [**StartPreviewAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.startpreviewasync).</span></span> <span data-ttu-id="52958-137">別のアプリがキャプチャ デバイスを排他的に制御している場合、このメソッドは **FileLoadException** をスローします。</span><span class="sxs-lookup"><span data-stu-id="52958-137">This method will throw a **FileLoadException** if another app has exclusive control of the capture device.</span></span> <span data-ttu-id="52958-138">排他的制御での変更をリッスンについては、次のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="52958-138">See the next section for information listening for changes in exclusive control.</span></span>

<span data-ttu-id="52958-139">[  **RequestActive**](https://docs.microsoft.com/uwp/api/windows.system.display.displayrequest.requestactive) を呼び出して、プレビューの実行中にデバイスがスリープ状態にならないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="52958-139">Call [**RequestActive**](https://docs.microsoft.com/uwp/api/windows.system.display.displayrequest.requestactive) to make sure the device doesn't go to sleep while the preview is running.</span></span> <span data-ttu-id="52958-140">最後に、[**DisplayInformation.AutoRotationPreferences**](https://docs.microsoft.com/uwp/api/windows.graphics.display.displayinformation.autorotationpreferences) プロパティを [**Landscape**](https://docs.microsoft.com/uwp/api/Windows.Graphics.Display.DisplayOrientations) に設定して、ユーザーがデバイスの向きを変更したときに UI と **CaptureElement** が回転することを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="52958-140">Finally, set the [**DisplayInformation.AutoRotationPreferences**](https://docs.microsoft.com/uwp/api/windows.graphics.display.displayinformation.autorotationpreferences) property to [**Landscape**](https://docs.microsoft.com/uwp/api/Windows.Graphics.Display.DisplayOrientations) to prevent the UI and the **CaptureElement** from rotating when the user changes the device orientation.</span></span> <span data-ttu-id="52958-141">デバイスの向きの変更処理について詳しくは、「[**MediaCapture を使ってデバイスの向きを処理する**](handle-device-orientation-with-mediacapture.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="52958-141">For more information on handling device orientation changes, see [**Handle device orientation with MediaCapture**](handle-device-orientation-with-mediacapture.md).</span></span>  

[!code-cs[StartPreviewAsync](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetStartPreviewAsync)]

## <a name="handle-changes-in-exclusive-control"></a><span data-ttu-id="52958-142">排他的制御での変更を処理する</span><span class="sxs-lookup"><span data-stu-id="52958-142">Handle changes in exclusive control</span></span>
<span data-ttu-id="52958-143">前のセクションで説明したように、別のアプリがキャプチャ デバイスを排他的に制御している場合、**StartPreviewAsync** は **FileLoadException** をスローします。</span><span class="sxs-lookup"><span data-stu-id="52958-143">As stated in the previous section, **StartPreviewAsync** will throw a **FileLoadException** if another app has exclusive control of the capture device.</span></span> <span data-ttu-id="52958-144">Windows 10 Version 1703 以降では、デバイスの排他的制御の状態が変化するたびに発生する [MediaCapture.CaptureDeviceExclusiveControlStatusChanged](https://docs.microsoft.com/uwp/api/Windows.Media.Capture.MediaCapture.CaptureDeviceExclusiveControlStatusChanged) イベントのハンドラーを登録できます。</span><span class="sxs-lookup"><span data-stu-id="52958-144">Starting with Windows 10, version 1703, you can register a handler for the [MediaCapture.CaptureDeviceExclusiveControlStatusChanged](https://docs.microsoft.com/uwp/api/Windows.Media.Capture.MediaCapture.CaptureDeviceExclusiveControlStatusChanged) event, which is raised whenever the exclusive control status of the device changes.</span></span> <span data-ttu-id="52958-145">このイベントのハンドラーで、[MediaCaptureDeviceExclusiveControlStatusChangedEventArgs.Status](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapturedeviceexclusivecontrolstatuschangedeventargs.Status) プロパティを調べて、現在の状態を確認します。</span><span class="sxs-lookup"><span data-stu-id="52958-145">In the handler for this event, check the [MediaCaptureDeviceExclusiveControlStatusChangedEventArgs.Status](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapturedeviceexclusivecontrolstatuschangedeventargs.Status) property to see what the current status is.</span></span> <span data-ttu-id="52958-146">新しい状態が **SharedReadOnlyAvailable** である場合、現在プレビューを開始できないことがわかり、UI を更新してユーザーに警告することができます。</span><span class="sxs-lookup"><span data-stu-id="52958-146">If the new status is **SharedReadOnlyAvailable**, then you know you can't currently start the preview and you may want to update your UI to alert the user.</span></span> <span data-ttu-id="52958-147">新しい状態が **ExclusiveControlAvailable** である場合は、カメラのプレビューを再試行することができます。</span><span class="sxs-lookup"><span data-stu-id="52958-147">If the new status is **ExclusiveControlAvailable**, then you can try starting the camera preview again.</span></span>

[!code-cs[ExclusiveControlStatusChanged](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetExclusiveControlStatusChanged)]

## <a name="shut-down-the-preview-stream"></a><span data-ttu-id="52958-148">プレビュー ストリームをシャットダウンする</span><span class="sxs-lookup"><span data-stu-id="52958-148">Shut down the preview stream</span></span>

<span data-ttu-id="52958-149">プレビュー ストリームを使い終わったら、必ずストリームをシャットダウンして関連するリソースを適切に破棄し、デバイスで他のアプリがカメラを使うことができるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="52958-149">When you are done using the preview stream, you should always shut down the stream and properly dispose of the associated resources to ensure that the camera is available to other apps on the device.</span></span> <span data-ttu-id="52958-150">プレビュー ストリームをシャットダウンするために必要な手順は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="52958-150">The required steps for shutting down the preview stream are:</span></span>

-   <span data-ttu-id="52958-151">現在、カメラがプレビューを表示中の場合は、[**StopPreviewAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.stoppreviewasync) を呼び出してプレビュー ストリームを停止します。</span><span class="sxs-lookup"><span data-stu-id="52958-151">If the camera is currently previewing, call [**StopPreviewAsync**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.stoppreviewasync) to stop the preview stream.</span></span> <span data-ttu-id="52958-152">プレビューが実行されていないときに **StopPreviewAsync** を呼び出すと、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="52958-152">An exception will be thrown if you call **StopPreviewAsync** while the preview is not running.</span></span>
-   <span data-ttu-id="52958-153">**CaptureElement** の [**Source**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.captureelement.source) プロパティを null に設定します。</span><span class="sxs-lookup"><span data-stu-id="52958-153">Set the [**Source**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.captureelement.source) property of the **CaptureElement** to null.</span></span> <span data-ttu-id="52958-154">[  **CoreDispatcher.RunAsync**](https://docs.microsoft.com/uwp/api/windows.ui.core.coredispatcher.runasync) を使用して、この呼び出しが UI スレッドで実行されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="52958-154">Use [**CoreDispatcher.RunAsync**](https://docs.microsoft.com/uwp/api/windows.ui.core.coredispatcher.runasync) to make sure this call is executed on the UI thread.</span></span>
-   <span data-ttu-id="52958-155">**MediaCapture** オブジェクトの [**Dispose**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.dispose) メソッドを呼び出してオブジェクトを解放します。</span><span class="sxs-lookup"><span data-stu-id="52958-155">Call the **MediaCapture** object's [**Dispose**](https://docs.microsoft.com/uwp/api/windows.media.capture.mediacapture.dispose) method to release the object.</span></span> <span data-ttu-id="52958-156">再度、[**CoreDispatcher.RunAsync**](https://docs.microsoft.com/uwp/api/windows.ui.core.coredispatcher.runasync) を使用して、この呼び出しが UI スレッドで実行されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="52958-156">Again, use [**CoreDispatcher.RunAsync**](https://docs.microsoft.com/uwp/api/windows.ui.core.coredispatcher.runasync) to make sure this call is executed on the UI thread.</span></span>
-   <span data-ttu-id="52958-157">**MediaCapture** メンバー変数を null に設定します。</span><span class="sxs-lookup"><span data-stu-id="52958-157">Set the **MediaCapture** member variable to null.</span></span>
-   <span data-ttu-id="52958-158">[  **RequestRelease**](https://docs.microsoft.com/uwp/api/windows.system.display.displayrequest.requestrelease) を呼び出して、アクティブでないときに画面をオフにできるようにします。</span><span class="sxs-lookup"><span data-stu-id="52958-158">Call [**RequestRelease**](https://docs.microsoft.com/uwp/api/windows.system.display.displayrequest.requestrelease) to allow the screen to turn off when inactive.</span></span>

[!code-cs[CleanupCameraAsync](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetCleanupCameraAsync)]

<span data-ttu-id="52958-159">[  **OnNavigatedFrom**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.page.onnavigatedfrom) メソッドをオーバーライドすることで、ユーザーがページから離れるときにプレビュー ストリームをシャットダウンする必要があります。</span><span class="sxs-lookup"><span data-stu-id="52958-159">You should shut down the preview stream when the user navigates away from your page by overriding the [**OnNavigatedFrom**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.page.onnavigatedfrom) method.</span></span>

[!code-cs[OnNavigatedFrom](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetOnNavigatedFrom)]

<span data-ttu-id="52958-160">アプリの中断中もプレビュー ストリームを適切にシャットダウンする必要があります。</span><span class="sxs-lookup"><span data-stu-id="52958-160">You should also shut down the preview stream properly when your app is suspending.</span></span> <span data-ttu-id="52958-161">これを行うには、ページのコンストラクターで [**Application.Suspending**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.core.coreapplication.suspending) イベントのハンドラーを登録します。</span><span class="sxs-lookup"><span data-stu-id="52958-161">To do this, register a handler for the [**Application.Suspending**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.core.coreapplication.suspending) event in your page's constructor.</span></span>

[!code-cs[RegisterSuspending](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetRegisterSuspending)]

<span data-ttu-id="52958-162">**Suspending** イベント ハンドラーで、まずページの種類と [**CurrentSourcePageType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.frame.currentsourcepagetype) プロパティを比較することで、アプリケーションの [**Frame**](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.Frame) にページが表示されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="52958-162">In the **Suspending** event handler, first check to make sure that the page is being displayed the application's [**Frame**](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.Frame) by comparing the page type to the [**CurrentSourcePageType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.frame.currentsourcepagetype) property.</span></span> <span data-ttu-id="52958-163">ページが現在表示されていない場合、**OnNavigatedFrom** イベントが既に発生しており、プレビュー ストリームはシャットダウンしています。</span><span class="sxs-lookup"><span data-stu-id="52958-163">If the page is not currently being displayed, then the **OnNavigatedFrom** event should already have been raised and the preview stream shut down.</span></span> <span data-ttu-id="52958-164">現在ページが表示されている場合、ハンドラーに渡されるイベント引数から [**SuspendingDeferral**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.SuspendingDeferral) オブジェクトを取得し、プレビュー ストリームがシャットダウンするまでシステムがアプリを中断しないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="52958-164">If the page is currently being displayed, get a [**SuspendingDeferral**](https://docs.microsoft.com/uwp/api/Windows.ApplicationModel.SuspendingDeferral) object from the event args passed into the handler to make sure the system does not suspend your app until the preview stream has been shut down.</span></span> <span data-ttu-id="52958-165">ストリームをシャットダウンした後、保留の [**Complete**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.suspendingdeferral.complete) メソッドを呼び出し、システムがアプリの中断を続行できるようにします。</span><span class="sxs-lookup"><span data-stu-id="52958-165">After shutting down the stream, call the deferral's [**Complete**](https://docs.microsoft.com/uwp/api/windows.applicationmodel.suspendingdeferral.complete) method to let the system continue suspending your app.</span></span>

[!code-cs[SuspendingHandler](./code/SimpleCameraPreview_Win10/cs/MainPage.xaml.cs#SnippetSuspendingHandler)]


## <a name="related-topics"></a><span data-ttu-id="52958-166">関連トピック</span><span class="sxs-lookup"><span data-stu-id="52958-166">Related topics</span></span>

* [<span data-ttu-id="52958-167">カメラ</span><span class="sxs-lookup"><span data-stu-id="52958-167">Camera</span></span>](camera.md)
* [<span data-ttu-id="52958-168">MediaCapture で基本的な写真、ビデオ、およびオーディオのキャプチャします。</span><span class="sxs-lookup"><span data-stu-id="52958-168">Basic photo, video, and audio capture with MediaCapture</span></span>](basic-photo-video-and-audio-capture-with-MediaCapture.md)
* [<span data-ttu-id="52958-169">プレビュー フレームを取得します。</span><span class="sxs-lookup"><span data-stu-id="52958-169">Get a preview frame</span></span>](get-a-preview-frame.md)
