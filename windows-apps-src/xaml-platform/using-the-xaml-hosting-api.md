---
author: mcleanbyron
description: この資料では、デスクトップ アプリケーションで UWP の XAML UI をホストする方法について説明します。
title: デスクトップ アプリケーションで API をホストしている UWP の XAML を使用してください。
ms.author: mcleans
ms.date: 09/21/2018
ms.topic: article
keywords: windows 10、uwp、windows フォーム、wpf、win32
ms.localizationpriority: medium
ms.openlocfilehash: 2ba64e32a25feaee9245bbfe2b598c756b29df98
ms.sourcegitcommit: 70ab58b88d248de2332096b20dbd6a4643d137a4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/01/2018
ms.locfileid: "5919700"
---
# <a name="using-the-uwp-xaml-hosting-api-in-a-desktop-application"></a><span data-ttu-id="63a3c-104">デスクトップ アプリケーションで API をホストしている UWP の XAML を使用してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-104">Using the UWP XAML hosting API in a desktop application</span></span>

> [!NOTE]
> <span data-ttu-id="63a3c-105">UWP XAML API をホストしている現在は、開発者向けプレビュー版として。</span><span class="sxs-lookup"><span data-stu-id="63a3c-105">The UWP XAML hosting API is currently available as a developer preview.</span></span> <span data-ttu-id="63a3c-106">私たちをお勧めするプロトタイプのコードでは、この API を今すぐ試してが勧めしませんを使用すること、実稼働コードでこの時点で。</span><span class="sxs-lookup"><span data-stu-id="63a3c-106">Although we encourage you to try out this API in your own prototype code now, we do not recommend that you use it in production code at this time.</span></span> <span data-ttu-id="63a3c-107">この API は、成熟し、将来のリリースの Windows の安定化を続けます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-107">This API will continue to mature and stabilize in future Windows releases.</span></span> <span data-ttu-id="63a3c-108">ここに記載された情報について、Microsoft は明示または黙示を問わずいかなる保証をするものでもありません。</span><span class="sxs-lookup"><span data-stu-id="63a3c-108">Microsoft makes no warranties, express or implied, with respect to the information provided here.</span></span>

<span data-ttu-id="63a3c-109">17709 ビルド 10 内部プレビュー SDK の Windows では、UWP ではないデスクトップ ・ アプリケーション (WPF、Windows フォーム、および C++ の Win32 アプリケーションを含む) は、UWP のコントロールをホストする*API をホストしている UWP の XAML*を使用して、ウィンドウ ハンドルである (関連付けられている任意の UI 要素HWND)。</span><span class="sxs-lookup"><span data-stu-id="63a3c-109">Starting in Windows 10 Insider Preview SDK build 17709, non-UWP desktop applications (including WPF, Windows Forms, and C++ Win32 applications) can use the *UWP XAML hosting API* to host UWP controls in any UI element that is associated with a window handle (HWND).</span></span> <span data-ttu-id="63a3c-110">この API を使用すると、UWP コントロールによって提供される最新の Windows 10 UI 機能を使用するデスクトップ アプリケーションを UWP ではないです。</span><span class="sxs-lookup"><span data-stu-id="63a3c-110">This API enables non-UWP desktop applications to use the latest Windows 10 UI features that are only available via UWP controls.</span></span> <span data-ttu-id="63a3c-111">たとえば、UWP ではないのデスクトップ アプリケーションでは、[流暢な設計のシステム](../design/fluent-design-system/index.md)を使用し、 [Windows のインク](../design/input/pen-and-stylus-interactions.md)をサポートしている UWP コントロールをホストするには、この API を使用できます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-111">For example, non-UWP desktop applications can use this API to host UWP controls that use the [Fluent Design System](../design/fluent-design-system/index.md) and support [Windows Ink](../design/input/pen-and-stylus-interactions.md).</span></span>

<span data-ttu-id="63a3c-112">API をホストしている UWP の XAML では、広範な開発者がデスクトップ アプリケーション以外の UWP を Fluent UI を表示するを有効にするコントロールの基盤を提供します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-112">The UWP XAML hosting API provides the foundation for a broader set of controls that we are providing to enable developers to bring Fluent UI to non-UWP desktop applications.</span></span> <span data-ttu-id="63a3c-113">このシナリオは、 *XAML の島*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-113">This scenario is sometimes called *XAML islands*.</span></span> <span data-ttu-id="63a3c-114">このシナリオの詳細については、[デスクトップ アプリケーションで UWP のコントロール](xaml-host-controls.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-114">For more details about this developer scenario, see [UWP controls in desktop applications](xaml-host-controls.md).</span></span>

## <a name="is-the-uwp-xaml-hosting-api-right-for-your-desktop-application"></a><span data-ttu-id="63a3c-115">UWP XAML ホスト API をデスクトップ アプリケーションの右のでしょうか。</span><span class="sxs-lookup"><span data-stu-id="63a3c-115">Is the UWP XAML hosting API right for your desktop application?</span></span>

<span data-ttu-id="63a3c-116">API をホストしている UWP の XAML は、デスクトップ アプリケーションで UWP コントロールをホストするための低レベルのインフラストラクチャを提供します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-116">The UWP XAML hosting API provides the low-level infrastructure for hosting UWP controls in desktop applications.</span></span> <span data-ttu-id="63a3c-117">いくつかの種類のデスクトップ アプリケーションでは、この目標を達成するのには、代替の方が便利な Api を使用するオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-117">Some types of desktop applications have the option of using alternative, more convenient APIs to accomplish this goal.</span></span>  

* <span data-ttu-id="63a3c-118">C++ の Win32 デスクトップ アプリケーションがある場合、アプリケーションで UWP のコントロールをホストする場合は、API をホストしている UWP の XAML を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-118">If you have a C++ Win32 desktop application and you want to host UWP controls in your application, you must use the UWP XAML hosting API.</span></span> <span data-ttu-id="63a3c-119">これらの種類のアプリケーションのための代替手段はありません。</span><span class="sxs-lookup"><span data-stu-id="63a3c-119">There are no alternatives for these types of applications.</span></span>

* <span data-ttu-id="63a3c-120">WPF と Windows フォーム アプリケーションでは、お勧め UWP の XAML ではなく Windows コミュニティ Toolkit で[ラップされたコントロール](xaml-host-controls.md#wrapped-controls)と[ホスト コントロール](xaml-host-controls.md#host-controls)を使用すること API をホストします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-120">For WPF and Windows Forms applications, we recommend that you use the [wrapped controls](xaml-host-controls.md#wrapped-controls) and [host controls](xaml-host-controls.md#host-controls) in the Windows Community Toolkit instead of the UWP XAML hosting API.</span></span> <span data-ttu-id="63a3c-121">これらのコントロール ホスト API を内部的に UWP の XAML を使用して、シンプルな開発エクスペリエンスを提供</span><span class="sxs-lookup"><span data-stu-id="63a3c-121">These controls use the UWP XAML hosting API internally and provide a simpler development experience.</span></span> <span data-ttu-id="63a3c-122">ただし、選択した場合これらの種類のアプリケーションで直接 API をホストしている UWP の XAML を使用できます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-122">However, you can use the UWP XAML hosting API directly in these types of applications if you choose.</span></span>

## <a name="related-samples"></a><span data-ttu-id="63a3c-123">関連するサンプル</span><span class="sxs-lookup"><span data-stu-id="63a3c-123">Related samples</span></span>

<span data-ttu-id="63a3c-124">UWP XAML コード内のホスト API を使用する方法は、アプリケーション、およびその他の要因の設計、アプリケーションの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-124">The way you use the UWP XAML hosting API in your code depends on your application type, the design of your application, and other factors.</span></span> <span data-ttu-id="63a3c-125">完全なアプリケーションのコンテキストでこの API を使用する方法を説明するため、この資料はコードを次のサンプルです。</span><span class="sxs-lookup"><span data-stu-id="63a3c-125">To help illustrate how to use this API in the context of a complete application, this article refers to code from the following samples.</span></span>

### <a name="c-win32"></a><span data-ttu-id="63a3c-126">C++ の Win32</span><span class="sxs-lookup"><span data-stu-id="63a3c-126">C++ Win32</span></span>

<span data-ttu-id="63a3c-127">GitHub に C++ の Win32 アプリケーションでは API をホストしている UWP の XAML を使用する方法を示すサンプルがいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-127">There are several samples on GitHub that demonstrate how to use the UWP XAML hosting API in a C++ Win32 application:</span></span>

  * <span data-ttu-id="63a3c-128">[XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting)。</span><span class="sxs-lookup"><span data-stu-id="63a3c-128">[XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting).</span></span> <span data-ttu-id="63a3c-129">このサンプルでは、C++ の Win32 アプリケーションに UWP [InkCanvas](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inkcanvas)、 [InkToolbar](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inktoolbar)、 [MediaPlayerElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.mediaplayerelement)コントロールを追加する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-129">This sample demonstrates how to add the UWP [InkCanvas](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inkcanvas), [InkToolbar](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.inktoolbar), and [MediaPlayerElement](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.mediaplayerelement) controls to a C++ Win32 application.</span></span>
  * <span data-ttu-id="63a3c-130">[XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32)。</span><span class="sxs-lookup"><span data-stu-id="63a3c-130">[XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32).</span></span> <span data-ttu-id="63a3c-131">このサンプルでは、C++ の Win32 アプリケーションにいくつかの基本的な UWP コントロールを追加し、DPI の変更を処理する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-131">This sample demonstrates how to add several basic UWP controls to a C++ Win32 application and handle DPI changes.</span></span>

### <a name="wpf-and-windows-forms"></a><span data-ttu-id="63a3c-132">WPF と Windows フォーム</span><span class="sxs-lookup"><span data-stu-id="63a3c-132">WPF and Windows Forms</span></span>

<span data-ttu-id="63a3c-133">Windows コミュニティの Toolkit では、 [WindowsXamlHost](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost)コントロールは、WPF および Windows フォーム アプリケーションで API をホストしている UWP を使用するための参照例として機能します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-133">The [WindowsXamlHost](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) control in the Windows Community Toolkit acts as a reference sample for using the UWP hosting API in WPF and Windows Forms applications.</span></span> <span data-ttu-id="63a3c-134">ソース コードは、次の場所から入手できます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-134">The source code is available at the following locations:</span></span>

  * <span data-ttu-id="63a3c-135">[ここ](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost)に、コントロールの WPF バージョン。</span><span class="sxs-lookup"><span data-stu-id="63a3c-135">For the WPF version of the control, [go here](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost).</span></span> <span data-ttu-id="63a3c-136">WPF のバージョンは、 [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)から派生します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-136">The WPF version derives from [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost).</span></span>
  * <span data-ttu-id="63a3c-137">[ここ](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost)に、コントロールの Windows フォームのバージョン。</span><span class="sxs-lookup"><span data-stu-id="63a3c-137">For the Windows Forms version of the control, [go here](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost).</span></span> <span data-ttu-id="63a3c-138">Windows フォームのバージョンは、 [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)から派生します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-138">The Windows Forms version derives from [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="63a3c-139">前提条件</span><span class="sxs-lookup"><span data-stu-id="63a3c-139">Prerequisites</span></span>

<span data-ttu-id="63a3c-140">API をホストしている UWP の XAML では、これらの前提条件があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-140">The UWP XAML hosting API has these prerequisites.</span></span>

* <span data-ttu-id="63a3c-141">17709 (またはそれ以降のビルド) を構築する 10 内部者プレビューの Windows および Windows SDK の対応する内部関係者によるプレビュー ビルドします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-141">Windows 10 Insider Preview build 17709 (or a later build) and the corresponding Insider Preview build of the Windows SDK.</span></span> <span data-ttu-id="63a3c-142">これは、進化する機能であるため、最大限に活用できることをお勧め最新の利用可能なビルドを使用します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-142">Because this is an evolving feature, for the best experience we recommend using the latest available build.</span></span>

* <span data-ttu-id="63a3c-143">デスクトップ アプリケーションで API をホストしている UWP の XAML を使用するには、UWP Api を呼び出すことができますので、プロジェクトを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-143">To use the UWP XAML hosting API in your desktop application, you'll need to configure your project so you can call UWP APIs:</span></span>

    * <span data-ttu-id="63a3c-144">**C++ Win32:** 使用するプロジェクトを構成することをお勧めします。 [C + + WinRT](../cpp-and-winrt-apis/index.md)。</span><span class="sxs-lookup"><span data-stu-id="63a3c-144">**C++ Win32:** We recommend that you configure your project to use [C++/WinRT](../cpp-and-winrt-apis/index.md).</span></span> <span data-ttu-id="63a3c-145">ダウンロードしてインストール、 [C + + WinRT Visual Studio 拡張機能 (VSIX)](https://aka.ms/cppwinrt/vsix) Visual Studio のマーケットプ レースから、追加、```<CppWinRTEnabled>true</CppWinRTEnabled>```として説明されている[ここで](../cpp-and-winrt-apis/intro-to-using-cpp-with-winrt.md#visual-studio-support-for-cwinrt-and-the-vsix).vcxproj ファイルのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="63a3c-145">Download and install the [C++/WinRT Visual Studio Extension (VSIX)](https://aka.ms/cppwinrt/vsix) from the Visual Studio Marketplace and then add the ```<CppWinRTEnabled>true</CppWinRTEnabled>``` property to your .vcxproj file as described [here](../cpp-and-winrt-apis/intro-to-using-cpp-with-winrt.md#visual-studio-support-for-cwinrt-and-the-vsix).</span></span>

    * <span data-ttu-id="63a3c-146">**Windows フォームと WPF:**[これらの指示](../porting/desktop-to-uwp-enhance.md)に従います。</span><span class="sxs-lookup"><span data-stu-id="63a3c-146">**Windows Forms and WPF:** Follow [these instructions](../porting/desktop-to-uwp-enhance.md).</span></span>

## <a name="architecture-of-xaml-islands"></a><span data-ttu-id="63a3c-147">XAML の島のアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="63a3c-147">Architecture of XAML islands</span></span>

<span data-ttu-id="63a3c-148">API をホストしている UWP の XAML には、 [**Windows.UI.Xaml.Hosting**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting)名前空間内の[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)、 [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager)、およびその他の関連する型が含まれています。</span><span class="sxs-lookup"><span data-stu-id="63a3c-148">The UWP XAML hosting API includes [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource), [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager), and other related types in the [**Windows.UI.Xaml.Hosting**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting) namespace.</span></span> <span data-ttu-id="63a3c-149">デスクトップのアプリケーションでは、UWP コントロールをレンダリングし、キーボード フォーカスのナビゲーション要素との間をルーティングするこの API を使用できます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-149">Desktop applications can use this API to render UWP controls and route keyboard focus navigation into and out of the elements.</span></span> <span data-ttu-id="63a3c-150">デスクトップ ・ アプリケーションは、サイズもと必要に応じて、UWP コントロールを配置します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-150">Desktop applications can also size and position the UWP controls as desired.</span></span>

<span data-ttu-id="63a3c-151">ホスト API をデスクトップ アプリケーションで XAML を使用して XAML の島を作成するとき、次の階層構造のオブジェクトが用意されます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-151">When you create a XAML island using the XAML hosting API in a desktop application, you will have the following hierarchy of objects:</span></span>

* <span data-ttu-id="63a3c-152">基本レベルで XAML の島をホストするアプリケーションの UI 要素は、です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-152">At the base level is the UI element in your application where you want to host the XAML island.</span></span> <span data-ttu-id="63a3c-153">この UI 要素には、ウィンドウ ハンドル (HWND) が必要です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-153">This UI element must have a window handle (HWND).</span></span> <span data-ttu-id="63a3c-154">XAML 島をホストできる UI 要素の例には、WPF アプリケーション、Windows フォーム アプリケーションの場合は、 [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)および C++ の Win32 アプリケーションの[ウィンドウ](https://docs.microsoft.com/windows/desktop/winmsg/about-windows)の[**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)が含まれます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-154">Examples of UI elements in which you can host a XAML island include [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) for WPF applications, [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) for Windows Forms applications, and a [window](https://docs.microsoft.com/windows/desktop/winmsg/about-windows) for C++ Win32 applications.</span></span>

* <span data-ttu-id="63a3c-155">次のレベルは、 **DesktopWindowXamlSource**オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="63a3c-155">At the next level is a **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="63a3c-156">このオブジェクトは、XAML の島をホストするためのインフラストラクチャを提供します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-156">This object provides the infrastructure for hosting the XAML island.</span></span> <span data-ttu-id="63a3c-157">コードは、このオブジェクトを作成し、UI の親要素にアタッチします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-157">Your code is responsible for creating this object and attaching it to the parent UI element.</span></span>

* <span data-ttu-id="63a3c-158">の**DesktopWindowXamlSource**を作成するとき、このオブジェクトは自動的に UWP コントロールをホストするためのネイティブの子ウィンドウを作成します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-158">When you create a **DesktopWindowXamlSource**, this object automatically creates a native child window to host your UWP control.</span></span> <span data-ttu-id="63a3c-159">このネイティブの子ウィンドウはほとんどの場合、コードから抽象化されたが、ハンドル (HWND) 必要な場合にアクセスすることができます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-159">This native child window is mostly abstracted away from your code, but you can access its handle (HWND) if necessary.</span></span>

* <span data-ttu-id="63a3c-160">最後に、最上部には、デスクトップ アプリケーションでホストする UWP コントロールです。</span><span class="sxs-lookup"><span data-stu-id="63a3c-160">Finally, at the top level is the UWP control you want to host in your desktop application.</span></span> <span data-ttu-id="63a3c-161">[**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)などのカスタム ユーザー コントロールも、Windows SDK で提供される任意の UWP コントロールから派生した任意の UWP オブジェクトを指定できます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-161">This can be any UWP object that derives from [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement), including any UWP control provided by the Windows SDK as well as custom user controls.</span></span>

<span data-ttu-id="63a3c-162">次の図は、XAML のアイランド内のオブジェクトの階層を示しています。</span><span class="sxs-lookup"><span data-stu-id="63a3c-162">The following diagram illustrates the hierarchy of objects in a XAML island.</span></span>

![DesktopWindowXamlSource アーキテクチャ](images/xaml-hosting-api-rev2.png)

## <a name="how-to-host-uwp-xaml-controls"></a><span data-ttu-id="63a3c-164">UWP の XAML コントロールをホストする方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-164">How to host UWP XAML controls</span></span>

<span data-ttu-id="63a3c-165">UWP アプリケーションでコントロールをホストする API をホストしている UWP の XAML を使用する主な手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-165">Here are the main steps for using the UWP XAML hosting API to host a UWP control in your application.</span></span>

1. <span data-ttu-id="63a3c-166">[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)でそれをホストする[**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)オブジェクトのいずれかのアプリケーションを作成する前に、現在のスレッドの UWP の XAML フレームワークを初期化します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-166">Initialize the UWP XAML framework for the current thread before your application creates any of the [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) objects that it will host in the [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource).</span></span>

    * <span data-ttu-id="63a3c-167">**DesktopWindowXamlSource**オブジェクトをインスタンス化するときにこのフレームワークの初期化するアプリケーションは、任意の**Windows.UI.Xaml.UIElement**オブジェクトを作成する前に、 **DesktopWindowXamlSource**オブジェクトを作成する場合.</span><span class="sxs-lookup"><span data-stu-id="63a3c-167">If your application creates the **DesktopWindowXamlSource** object before it creates any of the **Windows.UI.Xaml.UIElement** objects, this framework will be initialized for you when you instantiate the **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="63a3c-168">このシナリオでは、フレームワークを初期化するために独自のコードを追加する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="63a3c-168">In this scenario, you don't need to add any code of your own to initialize the framework.</span></span>

    * <span data-ttu-id="63a3c-169">ただし、アプリケーションは、それらをホストする**DesktopWindowXamlSource**オブジェクトを作成する前に、 **Windows.UI.Xaml.UIElement**オブジェクトを作成する場合、アプリケーション呼び出す必要があります静的[**WindowsXamlManager.InitializeForCurrentThread**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread) **Windows.UI.Xaml.UIElement**オブジェクトをインスタンス化する前に明示的に UWP XAML フレームワークを初期化します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-169">However, if your application creates the **Windows.UI.Xaml.UIElement** objects before it creates the **DesktopWindowXamlSource** object that will host them, your application must call the static [**WindowsXamlManager.InitializeForCurrentThread**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread) method to explicitly initialize the UWP XAML framework before the **Windows.UI.Xaml.UIElement** objects are instantiated.</span></span> <span data-ttu-id="63a3c-170">**DesktopWindowXamlSource**をホストする親 UI 要素がインスタンス化されるとき、アプリケーションはこのメソッドを呼び出す一般的です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-170">Your application should typically call this method when the parent UI element that hosts the **DesktopWindowXamlSource** is instantiated.</span></span>

    ```cppwinrt
    Windows::UI::Xaml::Hosting::WindowsXamlManager windowsXamlManager =
        Windows::UI::Xaml::Hosting::WindowsXamlManager::InitializeForCurrentThread();
    ```

    ```csharp
    global::Windows.UI.Xaml.Hosting.WindowsXamlManager windowsXamlManager =
        global::Windows.UI.Xaml.Hosting.WindowsXamlManager.InitializeForCurrentThread();
    ```

    > [!NOTE]
    > <span data-ttu-id="63a3c-171">UWP の XAML フレームワークへの参照を格納する[**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager)オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-171">This method returns a [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) object that contains a reference to the UWP XAML framework.</span></span> <span data-ttu-id="63a3c-172">特定のスレッドで必要な数の**WindowsXamlManager**オブジェクトを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-172">You can create as many **WindowsXamlManager** objects as you want on a given thread.</span></span> <span data-ttu-id="63a3c-173">ただし、各オブジェクトは、UWP の XAML フレームワークへの参照を保持しているために、XAML リソースが最終的に解放されることを確認するのにはオブジェクトを破棄する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-173">However, because each object holds a reference to the UWP XAML framework, you should dispose the objects to ensure that XAML resources are eventually released.</span></span>

2. <span data-ttu-id="63a3c-174">[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)オブジェクトを作成し、親ウィンドウ ハンドルに関連付けられているアプリケーションの UI 要素にアタッチします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-174">Create a [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) object and attach it to a parent UI element in your application that is associated with a window handle.</span></span>

    <span data-ttu-id="63a3c-175">これを行うには、これらの手順を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-175">To do this, you'll need to follow these steps:</span></span>

    1. <span data-ttu-id="63a3c-176">**DesktopWindowXamlSource**オブジェクトを作成し、 **IDesktopWindowXamlSourceNative** COM インターフェイスにキャストします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-176">Create a **DesktopWindowXamlSource** object and cast it to the **IDesktopWindowXamlSourceNative** COM interface.</span></span> <span data-ttu-id="63a3c-177">このインターフェイスで宣言されている、 ```windows.ui.xaml.hosting.desktopwindowxamlsource.h``` 、Windows SDK のヘッダー ファイルです。</span><span class="sxs-lookup"><span data-stu-id="63a3c-177">This interface is declared in the ```windows.ui.xaml.hosting.desktopwindowxamlsource.h``` header file in the Windows SDK.</span></span> <span data-ttu-id="63a3c-178">C++ の Win32 プロジェクトでは、このヘッダー ファイルを直接参照することができます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-178">In a C++ Win32 project, you can reference this header file directly.</span></span> <span data-ttu-id="63a3c-179">WPF または Windows フォーム プロジェクトでは、 [**ComImport**](https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.comimportattribute)属性を使用して、アプリケーション コードでこのインターフェイスを宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-179">In a WPF or Windows Forms project, you'll need to declare this interface in your application code using the [**ComImport**](https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.comimportattribute) attribute.</span></span> <span data-ttu-id="63a3c-180">インターフェイス宣言の中では、インターフェイス宣言では、完全に一致するかどうかを確認```windows.ui.xaml.hosting.desktopwindowxamlsource.h```。</span><span class="sxs-lookup"><span data-stu-id="63a3c-180">Make sure your interface declaration exactly matches the interface declaration in ```windows.ui.xaml.hosting.desktopwindowxamlsource.h```.</span></span>

    2. <span data-ttu-id="63a3c-181">**IDesktopWindowXamlSourceNative**インタ フェースの**AttachToWindow**メソッドを呼び出すし、アプリケーションで親の UI 要素のウィンドウ ハンドルを渡します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-181">Call the **AttachToWindow** method of the **IDesktopWindowXamlSourceNative** interface, and pass in the window handle of the parent UI element in your application.</span></span>

    3. <span data-ttu-id="63a3c-182">**DesktopWindowXamlSource**に含まれる内部の子ウィンドウの初期サイズを設定します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-182">Set the initial size of the internal child window contained in the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="63a3c-183">既定では、この内部の子ウィンドウは、幅および高さが 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-183">By default, this internal child window is set to a width and height of 0.</span></span> <span data-ttu-id="63a3c-184">ウィンドウのサイズを設定しない場合は、 **DesktopWindowXamlSource**に追加するすべての UWP コントロールは表示されません。</span><span class="sxs-lookup"><span data-stu-id="63a3c-184">If you don't set the size of the window, any UWP controls you add to the **DesktopWindowXamlSource** will not be visible.</span></span> <span data-ttu-id="63a3c-185">**DesktopWindowXamlSource**で内部の子ウィンドウにアクセスするには、 **IDesktopWindowXamlSourceNative**インターフェイスの**WindowHandle**プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-185">To access the internal child window in the **DesktopWindowXamlSource**, use the **WindowHandle** property of the **IDesktopWindowXamlSourceNative** interface.</span></span> <span data-ttu-id="63a3c-186">次の例では、ウィンドウのサイズを設定するのには[SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos)関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-186">The following examples use the [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to set the size of the window.</span></span>

    <span data-ttu-id="63a3c-187">このプロセスを説明するいくつかのコード例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-187">Here are some code examples that demonstrate this process.</span></span>

    ```cppwinrt
    // This example assumes you already have an HWND variable named 'parentHwnd' that
    // contains the handle of the parent window.
    Windows::UI::Xaml::Hosting::DesktopWindowXamlSource desktopWindowXamlSource;
    auto interop = desktopWindowXamlSource.as<IDesktopWindowXamlSourceNative>();
    check_hresult(interop->AttachToWindow(parentHwnd));

    HWND childInteropHwnd = nullptr;
    interop->get_WindowHandle(&childInteropHwnd);

    SetWindowPos(childInteropHwnd, 0, 0, 0, 300, 300, SWP_SHOWWINDOW);
    ```

    ```csharp
    // This WPF example assumes you already have an HwndHost named 'parentHwndHost'
    // that will act as the parent UI elemnt for your XAML island. It also assumes
    // you have used the DllImport attribute to import SetWindowPos from user32.dll
    // as a static method into a class named NativeMethods.
    Windows.UI.Xaml.Hosting.DesktopWindowXamlSource desktopWindowXamlSource =
        new Windows.UI.Xaml.Hosting.DesktopWindowXamlSource();

    IntPtr iUnknownPtr = System.Runtime.InteropServices.Marshal.GetIUnknownForObject(
        desktopWindowXamlSource);
    IDesktopWindowXamlSourceNative desktopWindowXamlSourceNative =
        System.Runtime.InteropServices.Marshal.Marshal.GetTypedObjectForIUnknown(
            iUnknownPtr, typeof(IDesktopWindowXamlSourceNative))
            as IDesktopWindowXamlSourceNative;

    desktopWindowXamlSourceNative.AttachToWindow(parentHwndHost.Handle);

    var childInteropHwnd = desktopWindowXamlSourceNative.WindowHandle;
    NativeMethods.SetWindowPos(childInteropHwnd, HWND_TOP, 0, 0, 300, 300, SWP_SHOWWINDOW);
    ```

3. <span data-ttu-id="63a3c-188">[**コンテンツ**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content)オブジェクトのプロパティに、 **DesktopWindowXamlSource**をホストする**Windows.UI.Xaml.UIElement**を設定します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-188">Set the **Windows.UI.Xaml.UIElement** you want to host to the [**Content**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content) property of your **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="63a3c-189">次の例では、 [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid)という名前の```myGrid```**コンテンツ**のプロパティにします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-189">The following example sets a [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) named ```myGrid``` to the **Content** property.</span></span>

   ```cppwinrt
   desktopWindowXamlSource.Content(myGrid);
   ```

   ```csharp
   desktopWindowXamlSource.Content = myGrid;
   ```

<span data-ttu-id="63a3c-190">実用的なサンプル アプリケーションのコンテキストでこれらのタスクを示す完全な例については、次のコード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-190">For complete examples that demonstrate these tasks in the context of a working sample application, see the following code files:</span></span>

  * <span data-ttu-id="63a3c-191">**C++ Win32:**[Main.cpp](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting/blob/master/XamlHostingSample/Main.cpp)ファイル[XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting)のサンプルや、 [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) 、 [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32)のサンプル ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-191">**C++ Win32:** See the [Main.cpp](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting/blob/master/XamlHostingSample/Main.cpp) file in the [XamlHostingSample](https://github.com/Microsoft/Windows-appsample-Xaml-Hosting) sample or the [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) file in the [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) sample.</span></span>
  * <span data-ttu-id="63a3c-192">**WPF:** Windows コミュニティの Toolkit で[WindowsXamlHostBase.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.cs)と[WindowsXamlHost.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHost.cs)ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-192">**WPF:** See the [WindowsXamlHostBase.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.cs) and  [WindowsXamlHost.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHost.cs) files in the Windows Community Toolkit.</span></span>  
  * <span data-ttu-id="63a3c-193">**Windows フォーム:** Windows コミュニティの Toolkit で[WindowsXamlHostBase.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.cs)と[WindowsXamlHost.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHost.cs)ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-193">**Windows Forms:** See the [WindowsXamlHostBase.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.cs) and  [WindowsXamlHost.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHost.cs) files in the Windows Community Toolkit.</span></span>


## <a name="how-to-host-custom-uwp-xaml-controls"></a><span data-ttu-id="63a3c-194">どのようにコントロールするのにはカスタムのホスト UWP の XAML</span><span class="sxs-lookup"><span data-stu-id="63a3c-194">How to host custom UWP XAML controls</span></span>

> [!IMPORTANT]
> <span data-ttu-id="63a3c-195">現時点では、サード パーティから UWP の XAML のカスタム コントロールは、C# WPF および Windows フォーム アプリケーションでのみサポートされます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-195">Currently, custom UWP XAML controls from 3rd parties are only supported in C# WPF and Windows Forms applications.</span></span> <span data-ttu-id="63a3c-196">それに対して、アプリケーションにコンパイルするためのコントロールのソース コードが必要です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-196">You must have the source code for the controls so you can compile against it in your application.</span></span>

<span data-ttu-id="63a3c-197">カスタム UWP XAML コントロール (ユーザー定義コントロール、またはサード パーティによって提供されるコントロール) をホストする場合は、次の追加のタスクだけでなく、[前のセクション](#how-to-host-uwp-xaml-controls)で説明する処理を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-197">If you want to host a custom UWP XAML control (either a control you define yourself or a control provided by a 3rd party), you must perform the following additional tasks in addition to the process described in the [previous section](#how-to-host-uwp-xaml-controls).</span></span>

1. <span data-ttu-id="63a3c-198">[**Windows.UI.Xaml.Application**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application)から派生し、また[**IXamlMetadataProvider**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider)を実装するカスタム型を定義します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-198">Define a custom type that derives from [**Windows.UI.Xaml.Application**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application) and also implements [**IXamlMetadataProvider**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider).</span></span> <span data-ttu-id="63a3c-199">この型は、アプリケーションの現在のディレクトリ内のアセンブリにカスタムの UWP の XAML 型のメタデータを読み込むためのルートのメタデータ プロバイダーとして機能します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-199">This type acts as a root metadata provider for loading metadata for custom UWP XAML types in assemblies in the current directory of your application.</span></span>

    <span data-ttu-id="63a3c-200">これを行う方法を示す例では、Windows コミュニティの Toolkit では、 [XamlApplication.cs](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Windows.Interop.WindowsXamlHost.Shared/XamlApplication.cs)コード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-200">For an example that demonstrates how to do this, see the [XamlApplication.cs](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Windows.Interop.WindowsXamlHost.Shared/XamlApplication.cs) code file in the Windows Community Toolkit.</span></span> <span data-ttu-id="63a3c-201">このファイルは、WPF および Windows フォームは、これらの種類のアプリケーションで API をホストしている UWP の XAML を使用する方法を示すための**WindowsXamlHost**クラスの共有の実装の一部です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-201">This file is part of the shared implementation of the **WindowsXamlHost** classes for WPF and Windows Forms, which help illustrate how to use the UWP XAML hosting API in those types of apps.</span></span>

2. <span data-ttu-id="63a3c-202">UWP XAML コントロールの型名が割り当てられている場合に、ルートのメタデータ プロバイダーの[**GetXamlType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider.getxamltype)メソッドを呼び出します (この割り当てることができますコードの実行時、または Visual Studio のプロパティ] ウィンドウで指定するのにはこれを有効にすることもできます)。</span><span class="sxs-lookup"><span data-stu-id="63a3c-202">Call the [**GetXamlType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider.getxamltype) method of your root metadata provider when the type name of the UWP XAML control is assigned (this could be assigned in code at run time, or you might choose to enable this to be assigned in the Visual Studio Properties window).</span></span>

    <span data-ttu-id="63a3c-203">これを行う方法を示す例では、Windows コミュニティの Toolkit では、 [UWPTypeFactory.cs](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Windows.Interop.WindowsXamlHost.Shared/UWPTypeFactory.cs)コード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-203">For an example that demonstrates how to do this, see the [UWPTypeFactory.cs](https://github.com/Microsoft/WindowsCommunityToolkit/tree/master/Microsoft.Toolkit.Win32/Microsoft.Windows.Interop.WindowsXamlHost.Shared/UWPTypeFactory.cs) code file in the Windows Community Toolkit.</span></span> <span data-ttu-id="63a3c-204">このファイルは、WPF および Windows フォームの**WindowsXamlHost**クラスの共有の実装の一部です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-204">This file is part of the shared implementation of the **WindowsXamlHost** classes for WPF and Windows Forms.</span></span>

3. <span data-ttu-id="63a3c-205">UWP の XAML のカスタムのコントロールのソース コードをホスト アプリケーションのソリューションに統合、カスタム コントロールを作成、次の[手順](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost#add-a-custom-uwp-control)によって、アプリケーションで使用します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-205">Integrate the source code for the custom UWP XAML control into your host application solution, build the custom control, and use it in your application by following [these instructions](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost#add-a-custom-uwp-control).</span></span>

## <a name="how-to-handle-keyboard-focus-navigation"></a><span data-ttu-id="63a3c-206">キーボード フォーカスのナビゲーションを処理する方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-206">How to handle keyboard focus navigation</span></span>

<span data-ttu-id="63a3c-207">移動すると、ユーザー (たとえば、**タブ**と矢印キーを押す) をキーボードを使用してアプリケーション内の UI 要素をプログラムを使用して**DesktopWindowXamlSource**オブジェクトとの間にフォーカスを移動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-207">When the user navigates through the UI elements in your application using the keyboard (for example, by pressing **Tab** or direction/arrow key), you'll need to programmatically move focus into and out of the **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="63a3c-208">次にフォーカスを移動するのにはユーザーのキーボード ナビゲーションに達すると、 **DesktopWindowXamlSource**で、UI のナビゲーション順序内の最初の[**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)オブジェクトにフォーカスを移動を続ける**Windows.UI.Xaml.UIElement**オブジェクトを要素とし、 **DesktopWindowXamlSource**から戻ると、親の UI 要素にフォーカスを移動ユーザーのサイクルとして。</span><span class="sxs-lookup"><span data-stu-id="63a3c-208">When the user's keyboard navigation reaches the **DesktopWindowXamlSource**, move focus into the first [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) object in the navigation order for your UI, continue to move focus to the following **Windows.UI.Xaml.UIElement** objects as the user cycles through the elements, and then move focus back out of the **DesktopWindowXamlSource** and into the parent UI element.</span></span>  

<span data-ttu-id="63a3c-209">UWP XAML ホスト API は、これらのタスクを達成するために、いくつかの型およびメンバーを提供します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-209">The UWP XAML hosting API provides several types and members to help you accomplish these tasks.</span></span>

1. <span data-ttu-id="63a3c-210">キーボード ナビゲーション、 **DesktopWindowXamlSource**に入ると、 [**GotFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.gotfocus)イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-210">When the keyboard navigation enters your **DesktopWindowXamlSource**, the [**GotFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.gotfocus) event is raised.</span></span> <span data-ttu-id="63a3c-211">このイベントを処理し、プログラムを使用して、 [**NavigateFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.navigatefocus)メソッドを使用して、最初のホストされている**Windows.UI.Xaml.UIElement**にフォーカスを移動します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-211">Handle this event and programmatically move focus to the first hosted **Windows.UI.Xaml.UIElement** by using the [**NavigateFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.navigatefocus) method.</span></span>

2. <span data-ttu-id="63a3c-212">ユーザーが、 **DesktopWindowXamlSource**にフォーカスを設定できる最後の要素に、 **Tab**キーまたは方向キーを押すと、 [**TakeFocusRequested**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.takefocusrequested)イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-212">When the user is on the last focusable element in your **DesktopWindowXamlSource** and presses the **Tab** key or an arrow key, the [**TakeFocusRequested**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.takefocusrequested) event is raised.</span></span> <span data-ttu-id="63a3c-213">このイベントを処理し、プログラムを使用してホスト アプリケーションの次のフォーカス可能な要素にフォーカスを移動します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-213">Handle this event and programmatically move focus to the next focusable element in the host application.</span></span> <span data-ttu-id="63a3c-214">などの**DesktopWindowXamlSource**が、 [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)でホストされている WPF アプリケーションでは、ホスト アプリケーションの次のフォーカス可能な要素にフォーカスを移動するのには[**MoveFocus**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.movefocus)メソッドを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-214">For example, in a WPF application where the **DesktopWindowXamlSource** is hosted in a [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost), you can use the [**MoveFocus**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.movefocus) method to transfer focus to the next focusable element in the host application.</span></span>

<span data-ttu-id="63a3c-215">実用的なサンプル アプリケーションのコンテキストでこの操作を行う方法を示す例については、次のコード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-215">For examples that demonstrate how to do this in the context of a working sample application, see the following code files:</span></span>
  * <span data-ttu-id="63a3c-216">**WPF:** Windows コミュニティの Toolkit では、 [WindowsXamlHostBase.Focus.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs)ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-216">**WPF:** See the [WindowsXamlHostBase.Focus.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs) file in the Windows Community Toolkit.</span></span>  
  * <span data-ttu-id="63a3c-217">**Windows フォーム:** Windows コミュニティの Toolkit では、 [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs)ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-217">**Windows Forms:** See the [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs) file in the Windows Community Toolkit.</span></span>

## <a name="how-to-handle-layout-changes"></a><span data-ttu-id="63a3c-218">レイアウトの変更を処理する方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-218">How to handle layout changes</span></span>

<span data-ttu-id="63a3c-219">UI の親要素のサイズを変更するときは、UWP コントロールが期待どおりの表示を確認するために必要なレイアウト変更を処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-219">When the user changes the size of the parent UI element, you'll need to handle any necessary layout changes to make sure your UWP controls display as you expect.</span></span> <span data-ttu-id="63a3c-220">考慮すべきいくつかの重要なシナリオを次に示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-220">Here are some important scenarios to consider.</span></span>

1. <span data-ttu-id="63a3c-221">親の UI 要素では、 **DesktopWindowXamlSource**でホストしている**Windows.UI.Xaml.UIElement**が収まる四角形領域のサイズを取得する必要がある、 **Windows.UI.Xaml.UIElement の[**測定**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.measure)メソッドを呼び出す**.</span><span class="sxs-lookup"><span data-stu-id="63a3c-221">When the parent UI element needs to get the size of the rectangular area needed to fit the **Windows.UI.Xaml.UIElement** that you are hosting on the **DesktopWindowXamlSource**, call the [**Measure**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.measure) method of the **Windows.UI.Xaml.UIElement**.</span></span> <span data-ttu-id="63a3c-222">以下に例を示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-222">For example:</span></span>
    * <span data-ttu-id="63a3c-223">WPF アプリケーションで**DesktopWindowXamlSource**をホストする、 [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)の[**MeasureOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride)メソッドから実行することがあります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-223">In a WPF application you might do this from the [**MeasureOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride) method of the [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) that hosts the **DesktopWindowXamlSource**.</span></span>
    * <span data-ttu-id="63a3c-224">Windows フォーム アプリケーションで**DesktopWindowXamlSource**をホストしている[**コントロール**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)の[**推奨**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.getpreferredsize)メソッドから実行することがあります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-224">In a Windows Forms application you might do this from the [**GetPreferredSize**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.getpreferredsize) method of the [**Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) that hosts the **DesktopWindowXamlSource**.</span></span>

2. <span data-ttu-id="63a3c-225">、UI の要素の変更の親のサイズ、[**配置**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.arrange)のメソッドを呼び出すルート**Windows.UI.Xaml.UIElement**をするとき、 **DesktopWindowXamlSource**でホストしています。</span><span class="sxs-lookup"><span data-stu-id="63a3c-225">When the size of the parent UI element changes, call the [**Arrange**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.arrange) method of the root **Windows.UI.Xaml.UIElement** that you are hosting on the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="63a3c-226">以下に例を示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-226">For example:</span></span>
    * <span data-ttu-id="63a3c-227">WPF アプリケーションで**DesktopWindowXamlSource**をホストする、 [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)オブジェクトの[**ArrangeOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride)メソッドから実行することがあります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-227">In a WPF application you might do this from the [**ArrangeOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride) method of the [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) object that hosts the **DesktopWindowXamlSource**.</span></span>
    * <span data-ttu-id="63a3c-228">Windows フォーム アプリケーションでこれを行いますし、[**コントロール**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)の[**SizeChanged**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.sizechanged)イベントのハンドラーから**DesktopWindowXamlSource**をホストしています。</span><span class="sxs-lookup"><span data-stu-id="63a3c-228">In a Windows Forms application you might do this from the handler for the [**SizeChanged**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.sizechanged) event of the [**Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) that hosts the **DesktopWindowXamlSource**.</span></span>

<span data-ttu-id="63a3c-229">実用的なサンプル アプリケーションのコンテキストでこの操作を行う方法を示す例については、次のコード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-229">For examples that demonstrate how to do this in the context of a working sample application, see the following code files:</span></span>
  * <span data-ttu-id="63a3c-230">**WPF:** Windows コミュニティの Toolkit では、 [WindowsXamlHost.Layout.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs)ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-230">**WPF:** See the [WindowsXamlHost.Layout.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>  
  * <span data-ttu-id="63a3c-231">**Windows フォーム:** Windows コミュニティの Toolkit では、 [WindowsXamlHost.Layout.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs)ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-231">**Windows Forms:** See the [WindowsXamlHost.Layout.cs](https://github.com/Microsoft/WindowsCommunityToolkit/blob/master/Microsoft.Toolkit.Win32/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>

## <a name="how-to-handle-dpi-changes"></a><span data-ttu-id="63a3c-232">DPI の変更を処理する方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-232">How to handle DPI changes</span></span>

<span data-ttu-id="63a3c-233">UWP コントロールを構成する描画変換を使用して、アプリケーションでは、DPI の変更をリッスンする必要があります (たとえば、ユーザーは、さまざまな画面 DPI のモニター間でウィンドウをドラッグした) 場合に、UWP がコントロールをホストしている DPI の変更] ウィンドウを処理する場合は、、ウィンドウの位置を更新して、DPI の変更への応答で、UWP コントロールのトランス フォームをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-233">If you want to handle DPI changes in the window that hosts your UWP control (for example, if the user drags the window between monitors with different screen DPI), you'll need to configure the UWP control with a render transform, listen for DPI changes in your app, and update the window position and render transform of the UWP control in response to the DPI changes.</span></span>

<span data-ttu-id="63a3c-234">次の手順では、C++ の Win32 アプリケーションのコンテキストでは、このプロセスを処理する方法の 1 つを示しています。</span><span class="sxs-lookup"><span data-stu-id="63a3c-234">The following steps illustrate one way to handle this process in the context of a C++ Win32 application.</span></span> <span data-ttu-id="63a3c-235">完全な例では、GitHub に、 [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp)と[Desktop.h](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.h)のコード サンプル内のファイル[XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-235">For a complete example, see the [Desktop.cpp](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.cpp) and [Desktop.h](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/Desktop.h) code files in the [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) sample on GitHub.</span></span>

1. <span data-ttu-id="63a3c-236">アプリ、 [**ScaleTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.media.scaletransform)オブジェクトを管理し、UWP コントロールの[**調整**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.rendertransform)方法に割り当てます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-236">Maintain a [**ScaleTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.media.scaletransform) object in your app and assign it to the [**RenderTransform**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.rendertransform) method of your UWP control.</span></span> <span data-ttu-id="63a3c-237">次の使用例は、C++ の Win32 アプリケーションでは、 [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid)コントロールをします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-237">The following example does this for a [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) control in a C++ Win32 application.</span></span>

    ```cppwinrt
    // Private fields maintained by your app, such as in a window class you have defined.
    Windows::UI::Xaml::Media::ScaleTransform m_scale;
    Windows::UI::Xaml::Controls::Grid m_rootGrid;

    // Code that runs during initialization, such as the constructor for a window class you have defined.
    m_rootGrid.RenderTransform(m_scale);
    ```

2. <span data-ttu-id="63a3c-238">、 [**WindowProc**](https://msdn.microsoft.com/library/windows/desktop/ms633573.aspx)関数に[**WM_DPICHANGED**](https://docs.microsoft.com/windows/desktop/hidpi/wm-dpichanged)メッセージをリッスンします。</span><span class="sxs-lookup"><span data-stu-id="63a3c-238">In your [**WindowProc**](https://msdn.microsoft.com/library/windows/desktop/ms633573.aspx) function, listen for the [**WM_DPICHANGED**](https://docs.microsoft.com/windows/desktop/hidpi/wm-dpichanged) message.</span></span> <span data-ttu-id="63a3c-239">このメッセージに応答します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-239">In response to this message:</span></span>
    * <span data-ttu-id="63a3c-240">[**SetWindowPos**](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos)関数を使用すると、メッセージに渡される四角形に UWP コントロールを含むウィンドウのサイズを変更します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-240">Use the [**SetWindowPos**](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to resize the window that contains the UWP control to the rectangle passed to the message.</span></span>
    * <span data-ttu-id="63a3c-241">新しい DPI 値に従って**ScaleTransform**オブジェクトの x 軸と y 軸のスケール係数を更新します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-241">Update the x-axis and y-axis scale factors of your **ScaleTransform** object according to the new DPI value.</span></span>
    * <span data-ttu-id="63a3c-242">UWP コントロールのレイアウトと外観を必要な調整を行います。</span><span class="sxs-lookup"><span data-stu-id="63a3c-242">Make any necessary adjustments to the appearance and layout of your UWP control.</span></span> <span data-ttu-id="63a3c-243">次のコード例では、[**パディング**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid.padding)の DPI の変更への応答でホストされている**Windows.UI.Xaml.Controls.Grid**コントロールを調整します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-243">The following code example adjusts the [**Padding**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid.padding) of the hosted **Windows.UI.Xaml.Controls.Grid** control in response to DPI changes.</span></span>

    ```cppwinrt
    LRESULT HandleDpiChange(HWND hWnd, WPARAM wParam, LPARAM lParam)
    {
        HWND hWndStatic = GetWindow(hWnd, GW_CHILD);
        if (hWndStatic != nullptr)
        {
            UINT uDpi = HIWORD(wParam);

            // Resize the window
            auto lprcNewScale = reinterpret_cast<RECT*>(lParam);

            SetWindowPos(hWnd, nullptr, lprcNewScale->left, lprcNewScale->top,
                lprcNewScale->right - lprcNewScale->left, lprcNewScale->bottom - lprcNewScale->top,
                SWP_NOZORDER | SWP_NOACTIVATE);

            NewScale(uDpi);
          }
          return 0;
    }

    void NewScale(UINT dpi) {

        auto scaleFactor = (float)dpi / 100;

        if (m_scale != nullptr) {
            m_scale.ScaleX(scaleFactor);
            m_scale.ScaleY(scaleFactor);
        }

        ApplyCorrection(scaleFactor);
    }

    void ApplyCorrection(float scaleFactor) {
        float rightCorrection = (m_rootGrid.Width() * scaleFactor - m_rootGrid.Width()) / scaleFactor;
        float bottomCorrection = (m_rootGrid.Height() * scaleFactor - m_rootGrid.Height()) / scaleFactor;

        m_rootGrid.Padding(Windows::UI::Xaml::ThicknessHelper::FromLengths(0, 0, rightCorrection, bottomCorrection));
    }
    ```

2. <span data-ttu-id="63a3c-244">モニター DPI に対応するアプリケーションを構成するには、[サイド バイ サイド アセンブリ マニフェスト](https://docs.microsoft.com/windows/desktop/SbsCs/application-manifests)をプロジェクトに追加し、設定```<dpiAwareness>```要素を```PerMonitorV2```。</span><span class="sxs-lookup"><span data-stu-id="63a3c-244">To configure your application to be per-monitor DPI aware, add a [side-by-side assembly manifest](https://docs.microsoft.com/windows/desktop/SbsCs/application-manifests) to your project and set ```<dpiAwareness>``` element to ```PerMonitorV2```.</span></span> <span data-ttu-id="63a3c-245">この値の詳細については、 [**DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2**](https://docs.microsoft.com/windows/desktop/hidpi/dpi-awareness-context)の説明を参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-245">For more information about this value, see the description for [**DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2**](https://docs.microsoft.com/windows/desktop/hidpi/dpi-awareness-context).</span></span>

    ```xml
    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
        <application xmlns="urn:schemas-microsoft-com:asm.v3">
            <windowsSettings>
                <dpiAwareness xmlns="http://schemas.microsoft.com/SMI/2016/WindowsSettings">PerMonitorV2</dpiAwareness>
            </windowsSettings>
        </application>
    </assembly>
    ```

    <span data-ttu-id="63a3c-246">完全な例のサイド バイ サイド アセンブリ マニフェストでは、GitHub に、 [XamlIslandsWin32.exe.manifest](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/XamlIslandsWin32.exe.manifest) 、 [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32)のサンプル ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-246">For a complete example side-by-side assembly manifest, see the [XamlIslandsWin32.exe.manifest](https://github.com/clarkezone/cppwinrt/blob/master/Desktop/XamlIslandsWin32/XamlIslandsWin32.exe.manifest) file in the [XamlIslands32](https://github.com/clarkezone/cppwinrt/tree/master/Desktop/XamlIslandsWin32) sample on GitHub.</span></span>

## <a name="limitations"></a><span data-ttu-id="63a3c-247">制限事項</span><span class="sxs-lookup"><span data-stu-id="63a3c-247">Limitations</span></span>

<span data-ttu-id="63a3c-248">API をホストしている XAML は、Windows の 10 の他のすべての種類のホスト コントロールの XAML と同じ制限を共有します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-248">The XAML hosting API shares the same limitations as all other types of XAML host controls for Windows 10.</span></span> <span data-ttu-id="63a3c-249">詳細については、 [XAML のホスト コントロールの制限事項](xaml-host-controls.md#limitations)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="63a3c-249">For a detailed list, see [XAML host control limitations](xaml-host-controls.md#limitations).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="63a3c-250">トラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="63a3c-250">Troubleshooting</span></span>

### <a name="error-using-uwp-xaml-hosting-api-in-a-uwp-app"></a><span data-ttu-id="63a3c-251">UWP アプリケーションでは API をホストしている UWP の XAML を使用してエラー</span><span class="sxs-lookup"><span data-stu-id="63a3c-251">Error using UWP XAML hosting API in a UWP app</span></span>

| <span data-ttu-id="63a3c-252">問題</span><span class="sxs-lookup"><span data-stu-id="63a3c-252">Issue</span></span> | <span data-ttu-id="63a3c-253">解決方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-253">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="63a3c-254">アプリは次のメッセージでは、 **COMException**を受け取ります:"DesktopWindowXamlSource をアクティブにできません。</span><span class="sxs-lookup"><span data-stu-id="63a3c-254">Your app receives a **COMException** with the following message: "Cannot activate DesktopWindowXamlSource.</span></span> <span data-ttu-id="63a3c-255">この型では使用できません UWP アプリケーションです。」</span><span class="sxs-lookup"><span data-stu-id="63a3c-255">This type cannot be used in a UWP app."</span></span> <span data-ttu-id="63a3c-256">または、"WindowsXamlManager をアクティブにできません。</span><span class="sxs-lookup"><span data-stu-id="63a3c-256">or "Cannot activate WindowsXamlManager.</span></span> <span data-ttu-id="63a3c-257">この型では使用できません UWP アプリケーションです。」</span><span class="sxs-lookup"><span data-stu-id="63a3c-257">This type cannot be used in a UWP app."</span></span> | <span data-ttu-id="63a3c-258">このエラーは、API をホストしている UWP の XAML を使用しようとしていることを示します (具体的には、しようとする[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)または[**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager)の型のインスタンスを作成する) アプリケーションで UWP です。</span><span class="sxs-lookup"><span data-stu-id="63a3c-258">This error indicates you are trying to use the UWP XAML hosting API (specifically, you are trying to instantiate the [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) or [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) types) in a UWP app.</span></span> <span data-ttu-id="63a3c-259">UWP XAML API をホストしていることを目的以外の UWP のデスクトップ アプリケーション、WPF、Windows フォーム、および C++ の Win32 アプリケーションで使用します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-259">The UWP XAML hosting API is only intended to be used in non-UWP desktop apps, such as WPF, Windows Forms, and C++ Win32 applications.</span></span> |

### <a name="error-attaching-to-a-window-on-a-different-thread"></a><span data-ttu-id="63a3c-260">別のスレッド上のウィンドウへのアタッチ エラー</span><span class="sxs-lookup"><span data-stu-id="63a3c-260">Error attaching to a window on a different thread</span></span>

| <span data-ttu-id="63a3c-261">問題</span><span class="sxs-lookup"><span data-stu-id="63a3c-261">Issue</span></span> | <span data-ttu-id="63a3c-262">解決方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-262">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="63a3c-263">アプリは次のメッセージでは、 **COMException**を受け取ります。」AttachToWindow メソッドは、指定された HWND は、別のスレッドで作成されたため失敗しました」。</span><span class="sxs-lookup"><span data-stu-id="63a3c-263">Your app receives a **COMException** with the following message: "AttachToWindow method failed because the specified HWND was created on a different thread."</span></span> | <span data-ttu-id="63a3c-264">このエラーは、アプリケーションが**IDesktopWindowXamlSourceNative.AttachToWindow**メソッドを呼び出すし、別のスレッドで作成されたウィンドウの HWND を渡すことを示します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-264">This error indicates that your application called the **IDesktopWindowXamlSourceNative.AttachToWindow** method and passed it the HWND of a window that was created on a different thread.</span></span> <span data-ttu-id="63a3c-265">このメソッドにはメソッドの呼び出し元のコードと同じスレッドで作成されたウィンドウの HWND を渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="63a3c-265">You must pass this method the HWND of a window that was created on the same thread as the code from which you are calling the method.</span></span> |

### <a name="error-attaching-to-a-window-on-a-different-top-level-window"></a><span data-ttu-id="63a3c-266">別のトップレベル ウィンドウのウィンドウへのアタッチ エラー</span><span class="sxs-lookup"><span data-stu-id="63a3c-266">Error attaching to a window on a different top-level window</span></span>

| <span data-ttu-id="63a3c-267">問題</span><span class="sxs-lookup"><span data-stu-id="63a3c-267">Issue</span></span> | <span data-ttu-id="63a3c-268">解決方法</span><span class="sxs-lookup"><span data-stu-id="63a3c-268">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="63a3c-269">アプリは次のメッセージでは、 **COMException**を受け取ります:「AttachToWindow メソッドは、同じスレッドで以前 AttachToWindow に渡された HWND よりも別のトップレベル ウィンドウの HWND を指定した地点に降下ために失敗しました」。</span><span class="sxs-lookup"><span data-stu-id="63a3c-269">Your app receives a **COMException** with the following  message: "AttachToWindow method failed because the specified HWND descends from a different top-level window than the HWND that was previously passed to AttachToWindow on the same thread."</span></span> | <span data-ttu-id="63a3c-270">このエラーは、アプリケーションが**IDesktopWindowXamlSourceNative.AttachToWindow**メソッドを呼び出すし、このメソッドへの前回の呼び出しで指定したよりも別の最上位ウィンドウから降下するウィンドウの HWND に渡されることを示します。同じスレッドです。</span><span class="sxs-lookup"><span data-stu-id="63a3c-270">This error indicates that your application called the **IDesktopWindowXamlSourceNative.AttachToWindow** method and passed it the HWND of a window that descends from a different top-level window than a window you specified in a previous call to this method on the same thread.</span></span></p></p><span data-ttu-id="63a3c-271">特定のスレッドのアプリケーションが**IDesktopWindowXamlSourceNative.AttachToWindow**を呼び出すと、同じスレッドで他のすべての[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)オブジェクトを同じトップレベル ウィンドウの子孫である windows に接続のみ**IDesktopWindowXamlSourceNative.AttachToWindow**の最初の呼び出しで渡されました。</span><span class="sxs-lookup"><span data-stu-id="63a3c-271">After your application calls **IDesktopWindowXamlSourceNative.AttachToWindow** on a particular thread, all other [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) objects on the same thread can only attach to windows that are descendants of the same top-level window that was passed in the first call to **IDesktopWindowXamlSourceNative.AttachToWindow**.</span></span> <span data-ttu-id="63a3c-272">特定のスレッドのすべての**DesktopWindowXamlSource**オブジェクトが閉じられると、次の**DesktopWindowXamlSource**は自由に任意のウィンドウをもう一度接続します。</span><span class="sxs-lookup"><span data-stu-id="63a3c-272">When all the **DesktopWindowXamlSource** objects are closed for a particular thread, the next **DesktopWindowXamlSource** is then free to attach to any window again.</span></span></p></p><span data-ttu-id="63a3c-273">この問題を解決するには、いずれかの方法は、このスレッドで他のトップ レベル ウィンドウにバインドされているか、この**DesktopWindowXamlSource**の新しいスレッドを作成するすべての**DesktopWindowXamlSource**オブジェクトを閉じます。</span><span class="sxs-lookup"><span data-stu-id="63a3c-273">To resolve this issue, either close all **DesktopWindowXamlSource** objects that are bound to other top-level windows on this thread, or create a new thread for this **DesktopWindowXamlSource**.</span></span> |

## <a name="related-topics"></a><span data-ttu-id="63a3c-274">関連トピック</span><span class="sxs-lookup"><span data-stu-id="63a3c-274">Related topics</span></span>

* [<span data-ttu-id="63a3c-275">デスクトップ アプリケーションの UWP コントロール</span><span class="sxs-lookup"><span data-stu-id="63a3c-275">UWP controls in desktop applications</span></span>](xaml-host-controls.md)
