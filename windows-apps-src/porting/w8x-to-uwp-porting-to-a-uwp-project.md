---
description: 移植プロセスを開始するとき、2 つの方法から選ぶことができます。
title: Windows ランタイム 8.x プロジェクトの UWP プロジェクトへの移植'
ms.assetid: 2dee149f-d81e-45e0-99a4-209a178d415a
ms.date: 02/08/2017
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.openlocfilehash: fac31b773c2326f8a9e0ed50cdf876552fee5689
ms.sourcegitcommit: ac7f3422f8d83618f9b6b5615a37f8e5c115b3c4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/29/2019
ms.locfileid: "66372251"
---
# <a name="porting-a-windows-runtime-8x-project-to-a-uwp-project"></a><span data-ttu-id="a75ee-104">Windows ランタイム 8.x プロジェクトの UWP プロジェクトへの移植</span><span class="sxs-lookup"><span data-stu-id="a75ee-104">Porting a Windows Runtime 8.x project to a UWP project</span></span>



<span data-ttu-id="a75ee-105">移植プロセスを開始するとき、2 つの方法から選ぶことができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-105">You have two options when you begin the porting process.</span></span> <span data-ttu-id="a75ee-106">1 つは、既にあるプロジェクト ファイル (アプリ パッケージ マニフェストなど) のコピーを編集する方法です。この方法については、「[アプリをユニバーサル Windows プラットフォーム (UWP) へ移行する](https://docs.microsoft.com/visualstudio/misc/migrate-apps-to-the-universal-windows-platform-uwp?view=vs-2015)」に記載されているプロジェクト ファイルの更新に関する説明をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-106">One is to edit a copy of your existing project files, including the app package manifest (for that option, see the info about updating your project files in [Migrate apps to the Universal Windows Platform (UWP)](https://docs.microsoft.com/visualstudio/misc/migrate-apps-to-the-universal-windows-platform-uwp?view=vs-2015)).</span></span> <span data-ttu-id="a75ee-107">その他のオプションでは、Visual Studio で新しい Windows 10 プロジェクトを作成し、ファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-107">The other option is to create a new Windows 10 project in Visual Studio and copy your files into it.</span></span> <span data-ttu-id="a75ee-108">このトピックの最初のセクションでは、2 番目の方法について説明しますが、トピックの他の部分では、両方の方法に適用できる追加情報について説明します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-108">The first section in this topic describes that second option, but the rest of the topic has additional info applicable to both options.</span></span> <span data-ttu-id="a75ee-109">既存のプロジェクトと同じソリューションに新しい Windows 10 プロジェクトを保持し、共有プロジェクトを使用してソース コード ファイルを共有することもできます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-109">You can also choose to keep your new Windows 10 project in the same solution as your existing projects and share source code files using a shared project.</span></span> <span data-ttu-id="a75ee-110">また、新しいプロジェクトを独自のソリューションに保持しておき、Visual Studio のリンク ファイル機能を使ってソース コード ファイルを共有することもできます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-110">Or, you can keep the new project in a solution of its own and share source code files using the linked files feature in Visual Studio.</span></span>

## <a name="create-the-project-and-copy-files-to-it"></a><span data-ttu-id="a75ee-111">プロジェクトを作成し、ファイルをコピーする</span><span class="sxs-lookup"><span data-stu-id="a75ee-111">Create the project and copy files to it</span></span>

<span data-ttu-id="a75ee-112">次の手順は、Visual Studio で新しい Windows 10 プロジェクトを作成し、ファイルをコピーするオプションに注目します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-112">These steps focus on the option to create a new Windows 10 project in Visual Studio and copy your files into it.</span></span> <span data-ttu-id="a75ee-113">作成するプロジェクトの数およびコピーするファイルに関する一部の仕様は、「[ユニバーサル 8.1 アプリがある場合](w8x-to-uwp-root.md)」や、それに続くセクションで説明されている要因と決定事項によって異なります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-113">Some of the specifics around how many projects you create, and which files you copy over, will depend on the factors and decisions described in [If you have a Universal 8.1 app](w8x-to-uwp-root.md) and the sections that follow it.</span></span> <span data-ttu-id="a75ee-114">次の手順では、最もシンプルなケースを前提としています。</span><span class="sxs-lookup"><span data-stu-id="a75ee-114">These steps assume the simplest case.</span></span>

1.  <span data-ttu-id="a75ee-115">Microsoft Visual Studio 2015 を起動し、新しい空のアプリケーション (ユニバーサル Windows) プロジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-115">Launch Microsoft Visual Studio 2015 and create a new Blank Application (Windows Universal) project.</span></span> <span data-ttu-id="a75ee-116">詳細については、次を参照してください。 [Jumpstart、Windows ランタイム 8.x アプリのテンプレートを使用して (C#、C++、Visual Basic)](https://docs.microsoft.com/previous-versions/windows/apps/hh768232(v=win.10))します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-116">For more info, see [Jumpstart your Windows Runtime 8.x app using templates (C#, C++, Visual Basic)](https://docs.microsoft.com/previous-versions/windows/apps/hh768232(v=win.10)).</span></span> <span data-ttu-id="a75ee-117">新しいプロジェクトによって、すべてのデバイス ファミリで実行される 1 つのアプリ パッケージ (appx ファイル) が構築されます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-117">Your new project builds an app package (an appx file) that will run on all device families.</span></span>
2.  <span data-ttu-id="a75ee-118">ユニバーサル 8.1 アプリ プロジェクトで、再利用するすべてのソース コード ファイルとビジュアル アセット ファイルを確認します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-118">In your Universal 8.1 app project, identify all the source code files and visual asset files that you want to reuse.</span></span> <span data-ttu-id="a75ee-119">エクスプローラーを使って、データ モデル、ビュー モデル、ビジュアル アセット、リソース ディクショナリ、フォルダー構造、および再利用するその他すべての要素を、新しいプロジェクトにコピーします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-119">Using File Explorer, copy data models, view models, visual assets, Resource Dictionaries, folder structure, and anything else that you wish to re-use, to your new project.</span></span> <span data-ttu-id="a75ee-120">必要に応じて、ディスクにサブフォルダーをコピーするか、作成します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-120">Copy or create sub-folders on disk as necessary.</span></span>
3.  <span data-ttu-id="a75ee-121">新しいプロジェクトに、ビュー (たとえば MainPage.xaml、MainPage.xaml.cs など) もコピーします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-121">Copy views (for example, MainPage.xaml and MainPage.xaml.cs) into the new project, too.</span></span> <span data-ttu-id="a75ee-122">ここでも、必要に応じて新しいサブフォルダーを作成し、プロジェクトから既にあるビューを削除します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-122">Again, create new sub-folders as necessary, and remove the existing views from the project.</span></span> <span data-ttu-id="a75ee-123">ただし、Visual Studio が生成したビューを上書きまたは削除する前に、後で参照するときに役立つ場合があるため、コピーを保存しておきます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-123">But, before you over-write or remove a view that Visual Studio generated, keep a copy because it may be useful to refer to it later.</span></span> <span data-ttu-id="a75ee-124">ユニバーサル 8.1 アプリを移植する最初のフェーズでは、1 つのデバイス ファミリでアプリが適切に表示され機能することを重視します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-124">The first phase of porting a Universal 8.1 app focuses on getting it to look good and work well on one device family.</span></span> <span data-ttu-id="a75ee-125">その後で、すべてのフォーム ファクターに対してビューを適切に対応させることに重点を置きます。必要に応じて、特定のデバイス ファミリを最大限に活用できるように、アダプティブ コードを追加します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-125">Later, you'll turn your attention to making sure the views adapt themselves well to all form factors, and optionally to adding any adaptive code to get the most from a particular device family.</span></span>
4.  <span data-ttu-id="a75ee-126">**ソリューション エクスプローラー**で、 **[すべてのファイルを表示]** がオンであることを確認します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-126">In **Solution Explorer**, make sure **Show All Files** is toggled on.</span></span> <span data-ttu-id="a75ee-127">コピーしたファイルを選択して右クリックし、 **[プロジェクトに含める]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-127">Select the files that you copied, right-click them, and click **Include In Project**.</span></span> <span data-ttu-id="a75ee-128">これによって、含まれるフォルダーが自動的に取り込まれます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-128">This will automatically include their containing folders.</span></span> <span data-ttu-id="a75ee-129">後で必要に応じて、 **[すべてのファイルを表示]** をオフに切り替えることができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-129">You can then toggle **Show All Files** off if you like.</span></span> <span data-ttu-id="a75ee-130">代替ワークフローとして、 **[既存項目の追加]** コマンドを使って Visual Studio **ソリューション エクスプローラー**で必要なすべてのサブフォルダーを作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-130">An alternative workflow, if you prefer, is to use the **Add Existing Item** command, having created any necessary sub-folders in the Visual Studio **Solution Explorer**.</span></span> <span data-ttu-id="a75ee-131">ビジュアル アセットで、 **[ビルド アクション]** が **[コンテンツ]** に設定されており、 **[出力ディレクトリにコピー]** が **[コピーしない]** に設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-131">Double-check that your visual assets have **Build Action** set to **Content** and **Copy to Output Directory** set to **Do not copy**.</span></span>
5.  <span data-ttu-id="a75ee-132">この段階では、ビルド エラーが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-132">You are likely to see some build errors at this stage.</span></span> <span data-ttu-id="a75ee-133">ただし、どのような変更が必要であるかを理解している場合は、Visual Studio の **[検索と置換]** コマンドを使って、ソース コードに対して一括変更を実行できます。また Visual Studio の命令型コード エディターで、コンテキスト メニューの **[解決]** コマンドと **[using の整理]** コマンドを使って、よりターゲットを絞った変更を実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-133">But, if you know what you need to change, then you can use Visual Studio's **Find and Replace** command to make bulk changes to your source code; and in the imperative code editor in Visual Studio, use the **Resolve** and **Organize Usings** commands on the context menu for more targeted changes.</span></span>

## <a name="maximizing-markup-and-code-reuse"></a><span data-ttu-id="a75ee-134">マークアップとコードを最大限に再利用する</span><span class="sxs-lookup"><span data-stu-id="a75ee-134">Maximizing markup and code reuse</span></span>

<span data-ttu-id="a75ee-135">若干のリファクタリングを行い、アダプティブ コード (後で説明します) を追加することで、すべてのデバイス ファミリで動作するマークアップとコードを最大限に活用することができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-135">You will find that refactoring a little, and/or adding adaptive code (which is explained below), will allow you to maximize the markup and code that works across all device families.</span></span> <span data-ttu-id="a75ee-136">詳しい説明を次に示します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-136">Here are more details.</span></span>

-   <span data-ttu-id="a75ee-137">すべてのデバイス ファミリに共通するファイルについては、特に考慮する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="a75ee-137">Files that are common to all device families need no special consideration.</span></span> <span data-ttu-id="a75ee-138">これらのファイルは、実行対象となるすべてのデバイス ファミリで、アプリが使うファイルです。</span><span class="sxs-lookup"><span data-stu-id="a75ee-138">Those files will be used by the app on all the device families that it runs on.</span></span> <span data-ttu-id="a75ee-139">これには、XAML マークアップ ファイル、命令型ソース コード ファイル、アセット ファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-139">This includes XAML markup files, imperative source code files, and asset files.</span></span>
-   <span data-ttu-id="a75ee-140">実行されているデバイス ファミリをアプリで検出し、そのデバイス ファミリ専用に設計されたビューに移動させることができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-140">It is possible for your app to detect the device family that it is running on and navigate to a view that has been designed specifically for that device family.</span></span> <span data-ttu-id="a75ee-141">詳しくは、「[アプリが実行されているプラットフォームの検出](w8x-to-uwp-input-and-sensors.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-141">For more details, see [Detecting the platform your app is running on](w8x-to-uwp-input-and-sensors.md).</span></span>
-   <span data-ttu-id="a75ee-142">プラットフォームを検出するための代替方法がない場合に役立つと考えられる同様の手法として、マークアップ ファイルや **ResourceDictionary** ファイル (またはこのファイルが保存されているフォルダー) に対して特殊な名前を設定する方法があります。この特殊な名前によって、アプリが特定のデバイス ファミリで実行される場合にのみ、これらのファイルが実行時に自動的に読み込まれるようになります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-142">A similar technique that you may find useful if there is no alternative is give a markup file or **ResourceDictionary** file (or the folder that contains the file) a special name such that it is automatically loaded at runtime only when your app runs on a particular device family.</span></span> <span data-ttu-id="a75ee-143">この手法については、「[Bookstore1](w8x-to-uwp-case-study-bookstore1.md)」のケース スタディをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-143">This technique is illustrated in the [Bookstore1](w8x-to-uwp-case-study-bookstore1.md) case study.</span></span>
-   <span data-ttu-id="a75ee-144">Windows 10 をサポートするためにのみ必要がある場合は、8.1 ユニバーサル アプリのソース コードで、多くの条件付きコンパイル ディレクティブを削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-144">You should be able to remove a lot of the conditional compilation directives in your Universal 8.1 app's source code if you only need to support Windows 10.</span></span> <span data-ttu-id="a75ee-145">このトピックの「[条件付きコンパイルとアダプティブ コード](#conditional-compilation-and-adaptive-code)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-145">See [Conditional compilation and adaptive code](#conditional-compilation-and-adaptive-code) in this topic.</span></span>
-   <span data-ttu-id="a75ee-146">一部のデバイス ファミリでのみ利用できる機能 (プリンター、スキャナー、またはカメラのボタンなど) を使うには、アダプティブ コードを記述します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-146">To use features that are not available on all device families (for example, printers, scanners, or the camera button), you can write adaptive code.</span></span> <span data-ttu-id="a75ee-147">このトピックの「[条件付きコンパイルとアダプティブ コード](#conditional-compilation-and-adaptive-code)」に記載されている 3 番目の例をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-147">See the third example in [Conditional compilation and adaptive code](#conditional-compilation-and-adaptive-code) in this topic.</span></span>
-   <span data-ttu-id="a75ee-148">コード型の Windows 8.1、Windows Phone 8.1、および Windows 10 をサポートする場合は、同じソリューション内の 3 つのプロジェクトのまま共有プロジェクトでコードを共有したりできます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-148">If you want to support Windows 8.1, Windows Phone 8.1, and Windows 10, then you can keep three projects in the same solution and share code with a Shared project.</span></span> <span data-ttu-id="a75ee-149">または、プロジェクト間でソース コード ファイルを共有することができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-149">Alternatively, you can share source code files between projects.</span></span> <span data-ttu-id="a75ee-150">Visual Studio でこのような処理を行うには、**ソリューション エクスプローラー**でプロジェクトを右クリックして **[既存項目の追加]** を選択し、共有するファイルを選択して **[リンクとして追加]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-150">Here's how: in Visual Studio, right-click the project in **Solution Explorer**, select **Add Existing Item**, select the files to share, and then click **Add As Link**.</span></span> <span data-ttu-id="a75ee-151">リンクしたプロジェクトを確認できるファイル システム上の共通のフォルダーにソース コード ファイルを格納します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-151">Store your source code files in a common folder on the file system where the projects that link to them can see them.</span></span> <span data-ttu-id="a75ee-152">また、ソース コントロールに追加することを忘れないでください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-152">And don't forget to add them to source control.</span></span>
-   <span data-ttu-id="a75ee-153">ソース コード レベルではなくバイナリ レベルでの再利用については、「[C# および Visual Basic での Windows ランタイム コンポーネントの作成](https://docs.microsoft.com/previous-versions/windows/apps/br230301(v=vs.140))」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-153">For reuse at the binary level, rather than the source code level, see [Creating Windows Runtime Components in C# and Visual Basic](https://docs.microsoft.com/previous-versions/windows/apps/br230301(v=vs.140)).</span></span> <span data-ttu-id="a75ee-154">ポータブル クラス ライブラリでは、Windows 8.1、Windows Phone 8.1、および Windows 10 アプリ (.NET Core) の .NET Framework と完全な .NET Framework で利用できる .NET Api のサブセットのサポートもあります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-154">There are also Portable Class Libraries, which support the subset of .NET APIs that are available in the .NET Framework for Windows 8.1, Windows Phone 8.1, and Windows 10 apps (.NET Core), and the full .NET Framework.</span></span> <span data-ttu-id="a75ee-155">ポータブル クラス ライブラリ アセンブリは、これらのプラットフォームすべてとバイナリ レベルで互換性があります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-155">Portable Class Library assemblies are binary compatible with all these platforms.</span></span> <span data-ttu-id="a75ee-156">Visual Studio を使って、ポータブル クラス ライブラリをターゲットとするプロジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-156">Use Visual Studio to create a project that targets a Portable Class Library.</span></span> <span data-ttu-id="a75ee-157">「[汎用性のあるクラス ライブラリを使用したプラットフォーム間の開発](https://docs.microsoft.com/dotnet/standard/cross-platform/cross-platform-development-with-the-portable-class-library)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-157">See [Cross-Platform Development with the Portable Class Library](https://docs.microsoft.com/dotnet/standard/cross-platform/cross-platform-development-with-the-portable-class-library).</span></span>

## <a name="extension-sdks"></a><span data-ttu-id="a75ee-158">拡張 SDK</span><span class="sxs-lookup"><span data-stu-id="a75ee-158">Extension SDKs</span></span>

<span data-ttu-id="a75ee-159">ユニバーサル 8.1 アプリによって呼び出されている Windows ランタイム API のほとんどは、ユニバーサル デバイス ファミリと呼ばれる API のセットに実装されています。</span><span class="sxs-lookup"><span data-stu-id="a75ee-159">Most of the Windows Runtime APIs your Universal 8.1 app already calls are implemented in the set of APIs known as the universal device family.</span></span> <span data-ttu-id="a75ee-160">ただし、一部の API は拡張 SDK に実装されており、Visual Studio で認識されるのは、アプリのターゲット デバイス ファミリによって実装された API、または参照している拡張 SDK によって実装された API のみです。</span><span class="sxs-lookup"><span data-stu-id="a75ee-160">But, some are implemented in extension SDKs, and Visual Studio only recognizes APIs that are implemented by your app's target device family or by any extension SDKs that you have referenced.</span></span>

<span data-ttu-id="a75ee-161">検出できなかった名前空間、型、メンバーについてのコンパイル エラーが発生した場合は、上記のことが原因となる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-161">If you get compile errors about namespaces or types or members that could not be found, then this is likely to be the cause.</span></span> <span data-ttu-id="a75ee-162">API リファレンス ドキュメントで API のトピックを表示し、要件に関するセクションに移動します。このセクションでは、どのようなデバイス ファミリが API を実装するかが示されています。</span><span class="sxs-lookup"><span data-stu-id="a75ee-162">Open the API's topic in the API reference documentation and navigate to the Requirements section: that will tell you what the implementing device family is.</span></span> <span data-ttu-id="a75ee-163">ターゲット デバイス ファミリが示されていない場合は、プロジェクトで API を利用できるようにするために、そのデバイス ファミリ用の拡張 SDK に対する参照が必要になります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-163">If that's not your target device family, then to make the API available to your project, you will need a reference to the extension SDK for that device family.</span></span>

<span data-ttu-id="a75ee-164">をクリックして**プロジェクト** &gt; **参照の追加** &gt; **Windows Universal** &gt; **拡張**と適切な拡張機能 SDK を選択します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-164">Click **Project** &gt; **Add Reference** &gt; **Windows Universal** &gt; **Extensions** and select the appropriate extension SDK.</span></span> <span data-ttu-id="a75ee-165">たとえば、呼び出す API がモバイル デバイス ファミリでのみ利用可能であり、それらの API がバージョン 10.0.x.y で導入されている場合は、 **[Windows Mobile Extensions for the UWP]** を選びます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-165">For example, if the APIs you want to call are available only in the mobile device family, and they were introduced in version 10.0.x.y, then select **Windows Mobile Extensions for the UWP**.</span></span>

<span data-ttu-id="a75ee-166">これにより、次の参照がプロジェクト ファイルに追加されます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-166">That will add the following reference to your project file:</span></span>

```XML
<ItemGroup>
    <SDKReference Include="WindowsMobile, Version=10.0.x.y">
        <Name>Windows Mobile Extensions for the UWP</Name>
    </SDKReference>
</ItemGroup>
```

<span data-ttu-id="a75ee-167">名前とバージョン番号は、SDK がインストールされている場所にあるフォルダーと一致します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-167">The name and version number match the folders in the installed location of your SDK.</span></span> <span data-ttu-id="a75ee-168">たとえば、上記の情報は次のフォルダー名と一致します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-168">For example, the above information matches this folder name:</span></span>

`\Program Files (x86)\Windows Kits\10\Extension SDKs\WindowsMobile\10.0.x.y`

<span data-ttu-id="a75ee-169">API を実装するデバイス ファミリがアプリのターゲットではない場合は、[**ApiInformation**](https://docs.microsoft.com/uwp/api/Windows.Foundation.Metadata.ApiInformation) クラスを使って、API を呼び出す前に API の有無をテストする必要があります (これはアダプティブ コードと呼ばれます)。</span><span class="sxs-lookup"><span data-stu-id="a75ee-169">Unless your app targets the device family that implements the API, you'll need to use the [**ApiInformation**](https://docs.microsoft.com/uwp/api/Windows.Foundation.Metadata.ApiInformation) class to test for the presence of the API before you call it (this is called adaptive code).</span></span> <span data-ttu-id="a75ee-170">このテストの条件は、アプリの実行時に必ず評価されますが、API が存在するデバイスに対してのみ true と評価され、呼び出しが可能になります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-170">This condition will then be evaluated wherever your app runs, but it will only evaluate to true on devices where the API is present and therefore available to call.</span></span> <span data-ttu-id="a75ee-171">ユニバーサル API が存在するかどうかを最初に確認した後では、拡張 SDK とアダプティブ コードのみを使います。</span><span class="sxs-lookup"><span data-stu-id="a75ee-171">Only use extension SDKs and adaptive code after first checking whether a universal API exists.</span></span> <span data-ttu-id="a75ee-172">次のセクションで、例をいくつか示します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-172">Some examples are given in the section below.</span></span>

<span data-ttu-id="a75ee-173">「[アプリ パッケージ マニフェスト](#app-package-manifest)」もご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-173">Also, see [App package manifest](#app-package-manifest).</span></span>

## <a name="conditional-compilation-and-adaptive-code"></a><span data-ttu-id="a75ee-174">条件付きコンパイルとアダプティブ コード</span><span class="sxs-lookup"><span data-stu-id="a75ee-174">Conditional compilation and adaptive code</span></span>

<span data-ttu-id="a75ee-175">条件付きコンパイルを使用している場合 (でC#プリプロセッサ ディレクティブ)、コード ファイルは、Windows 8.1 と Windows Phone 8.1 の両方で作業、ようにし、確認できます Windows 10 で実行された収束作業からその条件付きコンパイルします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-175">If you're using conditional compilation (with C# preprocessor directives) so that your code files work on both Windows 8.1 and Windows Phone 8.1, then you can now review that conditional compilation in light of the convergence work done in Windows 10.</span></span> <span data-ttu-id="a75ee-176">収束は、Windows 10 アプリでいくつかの条件はまとめて削除することを意味します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-176">Convergence means that, in your Windows 10 app, some conditions can be removed altogether.</span></span> <span data-ttu-id="a75ee-177">削除されない条件は、次に説明するように実行時チェックに変更します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-177">Others change to run-time checks, as demonstrated in the examples below.</span></span>

<span data-ttu-id="a75ee-178">**注**  で 1 つのコード ファイルでは、Windows 8.1、Windows Phone 8.1、および Windows 10 をサポートするかどうかは、すぎることができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-178">**Note**   If you want to support Windows 8.1, Windows Phone 8.1, and Windows 10 in a single code file, then you can do that too.</span></span> <span data-ttu-id="a75ee-179">プロジェクトのプロパティ ページで、Windows 10 プロジェクトで参照する場合、プロジェクトが WINDOWS を定義が表示されます\_条件付きコンパイル シンボルとして UAP です。</span><span class="sxs-lookup"><span data-stu-id="a75ee-179">If you look in your Windows 10 project at the project properties pages, you'll see that the project defines WINDOWS\_UAP as a conditional compilation symbol.</span></span> <span data-ttu-id="a75ee-180">WINDOWS と組み合わせて使用するそのため、\_アプリと WINDOWS\_PHONE\_アプリ。</span><span class="sxs-lookup"><span data-stu-id="a75ee-180">So, you can use that in combination with WINDOWS\_APP and WINDOWS\_PHONE\_APP.</span></span> <span data-ttu-id="a75ee-181">これらの例では、条件付きコンパイルを 8.1 ユニバーサル アプリから削除して、Windows 10 アプリの同等のコードに置き換えるの単純なケースを示します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-181">These examples show the simpler case of removing the conditional compilation from a Universal 8.1 app and substituting the equivalent code for a Windows 10 app.</span></span>

<span data-ttu-id="a75ee-182">最初の例では、**PickSingleFileAsync** API (Windows 8.1 にのみ適用) と **PickSingleFileAndContinue** API (Windows Phone 8.1 にのみ適用) の使用パターンを示しています。</span><span class="sxs-lookup"><span data-stu-id="a75ee-182">This first example shows the usage pattern for the **PickSingleFileAsync** API (which applies only to Windows 8.1) and the **PickSingleFileAndContinue** API (which applies only to Windows Phone 8.1).</span></span>

```csharp
#if WINDOWS_APP
    // Use Windows.Storage.Pickers.FileOpenPicker.PickSingleFileAsync
#else
    // Use Windows.Storage.Pickers.FileOpenPicker.PickSingleFileAndContinue
#endif // WINDOWS_APP
```

<span data-ttu-id="a75ee-183">Windows 10 の集約、 [ **PickSingleFileAsync** ](https://docs.microsoft.com/uwp/api/windows.storage.pickers.fileopenpicker.picksinglefileasync) API は、このコードが簡素化します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-183">Windows 10 converges on the [**PickSingleFileAsync**](https://docs.microsoft.com/uwp/api/windows.storage.pickers.fileopenpicker.picksinglefileasync) API, so your code simplifies to this:</span></span>

```csharp
    // Use Windows.Storage.Pickers.FileOpenPicker.PickSingleFileAsync
```

<span data-ttu-id="a75ee-184">次の例では、ハードウェアの "戻る" ボタンを処理しますが、Windows Phone のみが対象となります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-184">In this example, we handle the hardware back button—but only on Windows Phone.</span></span>

```csharp
#if WINDOWS_PHONE_APP
        Windows.Phone.UI.Input.HardwareButtons.BackPressed += this.HardwareButtons_BackPressed;
#endif // WINDOWS_PHONE_APP

...

#if WINDOWS_PHONE_APP
    void HardwareButtons_BackPressed(object sender, Windows.Phone.UI.Input.BackPressedEventArgs e)
    {
        // Handle the event.
    }
#endif // WINDOWS_PHONE_APP
```

<span data-ttu-id="a75ee-185">Windows 10 では、[戻る] ボタンのイベントは、ユニバーサル概念です。</span><span class="sxs-lookup"><span data-stu-id="a75ee-185">In Windows 10, the back button event is a universal concept.</span></span> <span data-ttu-id="a75ee-186">ハードウェアまたはソフトウェアに実装されているすべての "戻る" ボタンでは [**BackRequested**](https://docs.microsoft.com/uwp/api/windows.ui.core.systemnavigationmanager.backrequested) イベントが発生するため、このイベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-186">Back buttons implemented in hardware or in software will all raise the [**BackRequested**](https://docs.microsoft.com/uwp/api/windows.ui.core.systemnavigationmanager.backrequested) event, so that's the one to handle.</span></span>

```csharp
    Windows.UI.Core.SystemNavigationManager.GetForCurrentView().BackRequested +=
        this.ViewModelLocator_BackRequested;

...

private void ViewModelLocator_BackRequested(object sender, Windows.UI.Core.BackRequestedEventArgs e)
{
    // Handle the event.
}
```

<span data-ttu-id="a75ee-187">最後の例は、前の例に類似しています。</span><span class="sxs-lookup"><span data-stu-id="a75ee-187">This final example is similar to the previous one.</span></span> <span data-ttu-id="a75ee-188">ここでは、ハードウェアの "カメラ" ボタンを処理しますが、この場合も Windows Phone アプリ パッケージにコンパイルされるコードのみが対象となります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-188">Here, we handle the hardware camera button—but again, only in the code compiled into the Windows Phone app package.</span></span>

```csharp
#if WINDOWS_PHONE_APP
    Windows.Phone.UI.Input.HardwareButtons.CameraPressed += this.HardwareButtons_CameraPressed;
#endif // WINDOWS_PHONE_APP

...

#if WINDOWS_PHONE_APP
void HardwareButtons_CameraPressed(object sender, Windows.Phone.UI.Input.CameraEventArgs e)
{
    // Handle the event.
}
#endif // WINDOWS_PHONE_APP
```

<span data-ttu-id="a75ee-189">Windows 10 では、ハードウェア カメラ ボタンは、モバイル デバイス ファミリに特定の概念です。</span><span class="sxs-lookup"><span data-stu-id="a75ee-189">In Windows 10, the hardware camera button is a concept particular to the mobile device family.</span></span> <span data-ttu-id="a75ee-190">1 つのアプリ パッケージがすべてのデバイスで実行されるため、アダプティブ コードと呼ばれる手法を使って、コンパイル時の条件を実行時の条件に変更します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-190">Because one app package will be running on all devices, we change our compile-time condition into a run-time condition using what is known as adaptive code.</span></span> <span data-ttu-id="a75ee-191">そのためには、[**ApiInformation**](https://docs.microsoft.com/uwp/api/Windows.Foundation.Metadata.ApiInformation) クラスを使って、実行時に [**HardwareButtons**](https://docs.microsoft.com/uwp/api/Windows.Phone.UI.Input.HardwareButtons) クラスの有無を照会します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-191">To do that, we use the [**ApiInformation**](https://docs.microsoft.com/uwp/api/Windows.Foundation.Metadata.ApiInformation) class to query at run-time for the presence of the [**HardwareButtons**](https://docs.microsoft.com/uwp/api/Windows.Phone.UI.Input.HardwareButtons) class.</span></span> <span data-ttu-id="a75ee-192">**HardwareButtons** は、モバイル拡張 SDK で定義されているため、その SDK への参照をプロジェクトに追加して、このコードをコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a75ee-192">**HardwareButtons** is defined in the mobile extension SDK, so we'll need to add a reference to that SDK to our project for this code to compile.</span></span> <span data-ttu-id="a75ee-193">ただし、ハンドラーはモバイル拡張 SDK で定義されている型を実装するデバイスでのみ実行されることに注意してください。このようなデバイスは、モバイル デバイス ファミリに該当します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-193">Note, though, that the handler will only be executed on a device that implements the types defined in the mobile extension SDK, and that's the mobile device family.</span></span> <span data-ttu-id="a75ee-194">このコードは事実上ユニバーサル 8.1 コードと同等のコードとなるため、このコードでは存在する機能のみを使うように注意してください。これは、別の方法で実施することもできます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-194">So, this code is morally equivalent to the Universal 8.1 code in that it is careful only to use features that are present, although it achieves that in a different way.</span></span>

```csharp
    // Note: Cache the value instead of querying it more than once.
    bool isHardwareButtonsAPIPresent = Windows.Foundation.Metadata.ApiInformation.IsTypePresent
        ("Windows.Phone.UI.Input.HardwareButtons");

    if (isHardwareButtonsAPIPresent)
    {
        Windows.Phone.UI.Input.HardwareButtons.CameraPressed +=
            this.HardwareButtons_CameraPressed;
    }

    ...

private void HardwareButtons_CameraPressed(object sender, Windows.Phone.UI.Input.CameraEventArgs e)
{
    // Handle the event.
}
```

<span data-ttu-id="a75ee-195">「[アプリが実行されているプラットフォームの検出](w8x-to-uwp-input-and-sensors.md)」もご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-195">Also, see [Detecting the platform your app is running on](w8x-to-uwp-input-and-sensors.md).</span></span>

## <a name="app-package-manifest"></a><span data-ttu-id="a75ee-196">アプリ パッケージ マニフェスト</span><span class="sxs-lookup"><span data-stu-id="a75ee-196">App package manifest</span></span>

<span data-ttu-id="a75ee-197">[Windows 10 での変更点](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/what-s-changed-in-windows-10)トピックでは、追加、削除されると、および変更された要素を含む、Windows 10 用パッケージのマニフェスト スキーマ リファレンスへの変更を示します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-197">The [What's changed in Windows 10](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/what-s-changed-in-windows-10) topic lists changes to the package manifest schema reference for Windows 10, including elements that have been added, removed, and changed.</span></span> <span data-ttu-id="a75ee-198">このスキーマのすべての要素、属性、タイプに関するリファレンス情報については、「[要素の階層](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/root-elements)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-198">For reference info on all elements, attributes, and types in the schema, see [Element Hierarchy](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/root-elements).</span></span> <span data-ttu-id="a75ee-199">Windows Phone ストア アプリを移植する場合、または Windows Phone ストアのアプリに対する更新となるアプリを作成する場合は、**pm:PhoneIdentity** 要素が、以前のアプリのアプリ マニフェストの値と一致していることを確認してください (ストアからアプリに割り当てられたものと同じ GUID を使用してください)。</span><span class="sxs-lookup"><span data-stu-id="a75ee-199">If you're porting a Windows Phone Store app, or if your app is an update to an app from the Windows Phone Store, ensure that the **pm:PhoneIdentity** element matches what's in the app manifest of your previous app (use the same GUIDs that were assigned to the app by the Store).</span></span> <span data-ttu-id="a75ee-200">これにより、アプリのユーザーが Windows 10 にアップグレードした場合に、新しいアプリが確実に更新プログラムとして配布され、アプリの重複を避けることができます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-200">This will ensure that users of your app who are upgrading to Windows 10 will receive your new app as an update, not a duplicate.</span></span> <span data-ttu-id="a75ee-201">詳しくは、[**pm:PhoneIdentity**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-pm-phoneidentity) のリファレンス トピックをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-201">See the [**pm:PhoneIdentity**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-pm-phoneidentity) reference topic for more details.</span></span>

<span data-ttu-id="a75ee-202">プロジェクトの設定 (すべての拡張 SDK の参照を含む) により、アプリが呼び出すことができる API サーフェス領域が決定されます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-202">The settings in your project (including any extension SDKs references) determine the API surface area that your app can call.</span></span> <span data-ttu-id="a75ee-203">ただし、ユーザーがアプリをストアからインストールできる実際のデバイスのセットを決定するのは、アプリ パッケージ マニフェストです。</span><span class="sxs-lookup"><span data-stu-id="a75ee-203">But, your app package manifest is what determines the actual set of devices that your customers can install your app onto from the Store.</span></span> <span data-ttu-id="a75ee-204">詳しくは、「[**TargetDeviceFamily**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-targetdevicefamily)」の例をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="a75ee-204">For more info, see examples in [**TargetDeviceFamily**](https://docs.microsoft.com/uwp/schemas/appxpackage/uapmanifestschema/element-targetdevicefamily).</span></span>

<span data-ttu-id="a75ee-205">さまざまな宣言、機能、および一部の機能で必要となる他の設定を指定するように、アプリ パッケージ マニフェストを編集できます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-205">You can edit the app package manifest to set various declarations, capabilities, and other settings that some features need.</span></span> <span data-ttu-id="a75ee-206">Visual Studio アプリ パッケージ マニフェスト エディターを使って、編集できます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-206">You can use the Visual Studio app package manifest editor to edit it.</span></span> <span data-ttu-id="a75ee-207">**ソリューション エクスプローラー**が表示されていない場合は、 **[表示]** メニューから選択します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-207">If the **Solution Explorer** is not shown, choose it from the **View** menu.</span></span> <span data-ttu-id="a75ee-208">**[Package.appxmanifest]** をダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="a75ee-208">Double-click **Package.appxmanifest**.</span></span> <span data-ttu-id="a75ee-209">マニフェスト エディター ウィンドウが開きます。</span><span class="sxs-lookup"><span data-stu-id="a75ee-209">This opens the manifest editor window.</span></span> <span data-ttu-id="a75ee-210">変更する適切なタブを選び、保存します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-210">Select the appropriate tab to make changes and then save.</span></span>

<span data-ttu-id="a75ee-211">次のトピックは「[トラブルシューティング](w8x-to-uwp-troubleshooting.md)」です。</span><span class="sxs-lookup"><span data-stu-id="a75ee-211">The next topic is [Troubleshooting](w8x-to-uwp-troubleshooting.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="a75ee-212">関連トピック</span><span class="sxs-lookup"><span data-stu-id="a75ee-212">Related topics</span></span>

* [<span data-ttu-id="a75ee-213">ユニバーサル Windows プラットフォーム用アプリを開発します。</span><span class="sxs-lookup"><span data-stu-id="a75ee-213">Develop apps for the Universal Windows Platform</span></span>](https://docs.microsoft.com/visualstudio/cross-platform/develop-apps-for-the-universal-windows-platform-uwp?view=vs-2015)
* <span data-ttu-id="a75ee-214">[Jumpstart、Windows ランタイム 8.x アプリのテンプレートを使用して (C#、C++、Visual Basic)](https://docs.microsoft.com/previous-versions/windows/apps/hh768232(v=win.10))</span><span class="sxs-lookup"><span data-stu-id="a75ee-214">[Jumpstart your Windows Runtime 8.x app using templates (C#, C++, Visual Basic)](https://docs.microsoft.com/previous-versions/windows/apps/hh768232(v=win.10))</span></span>
* <span data-ttu-id="a75ee-215">[Windows ランタイム コンポーネントの作成](https://docs.microsoft.com/previous-versions/windows/apps/hh441572(v=vs.140))</span><span class="sxs-lookup"><span data-stu-id="a75ee-215">[Creating Windows Runtime Components](https://docs.microsoft.com/previous-versions/windows/apps/hh441572(v=vs.140))</span></span>
* [<span data-ttu-id="a75ee-216">ポータブル クラス ライブラリを使用したクロス プラットフォーム開発</span><span class="sxs-lookup"><span data-stu-id="a75ee-216">Cross-Platform Development with the Portable Class Library</span></span>](https://docs.microsoft.com/dotnet/standard/cross-platform/cross-platform-development-with-the-portable-class-library)

