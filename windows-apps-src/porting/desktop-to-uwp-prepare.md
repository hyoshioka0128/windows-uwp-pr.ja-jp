---
author: normesta
Description: "この記事では、デスクトップ ブリッジを使用してアプリをパッケージ化する前に理解しておく必要のあることについて説明します。 アプリのパッケージ化プロセスの準備に多くの作業は必要ありません。"
Search.Product: eADQiWindows 10XVcnh
title: "アプリのパッケージ化の準備 (デスクトップ ブリッジ)"
ms.author: normesta
ms.date: 05/25/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: windows 10, uwp
ms.assetid: 71a57ca2-ca00-471d-8ad9-52f285f3022e
ms.openlocfilehash: f7337ee7bf78730e2300a11d7d606f328c7c418b
ms.sourcegitcommit: 77bbd060f9253f2b03f0b9d74954c187bceb4a30
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/11/2017
---
# <a name="prepare-to-package-an-app-desktop-bridge"></a><span data-ttu-id="5aff5-105">アプリのパッケージ化の準備 (デスクトップ ブリッジ)</span><span class="sxs-lookup"><span data-stu-id="5aff5-105">Prepare to package an app (Desktop Bridge)</span></span>

<span data-ttu-id="5aff5-106">この記事では、デスクトップ アプリをパッケージ化する前に理解しておく必要のあることについて説明します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-106">This article lists the things you need to know before you package your desktop app.</span></span> <span data-ttu-id="5aff5-107">パッケージ化プロセス用にアプリを準備するためには多くの作業を行う必要はありませんが、以下の項目のいずれかがアプリケーションに当てはまる場合には、パッケージ化の前に対処する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-107">You might not have to do much to get your app ready for the packaging process, but if any of the items below applies to your application, you need to address it before packaging.</span></span> <span data-ttu-id="5aff5-108">ライセンスと自動更新は Windows ストアで処理されるため、これらのタスクに関連した機能はコードベースから削除できます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-108">Remember that the Windows Store handles licensing and automatic updating for you, so you can remove any features that relate to those tasks from your codebase.</span></span>

+ <span data-ttu-id="5aff5-109">__アプリでバージョン 4.6.1 よりも前のバージョンの .NET を使用している__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-109">__Your app uses a version of .NET earlier than 4.6.1__.</span></span> <span data-ttu-id="5aff5-110">.NET 4.6.1 のみがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="5aff5-110">Only .NET 4.6.1 is supported.</span></span> <span data-ttu-id="5aff5-111">パッケージ化する前に、アプリのターゲットを .NET 4.6.1に変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-111">You'll have to retarget your app to .NET 4.6.1 before you package it.</span></span>

+ <span data-ttu-id="5aff5-112">__常に管理者特権のセキュリティ権限でアプリを実行する__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-112">__Your app always runs with elevated security privileges__.</span></span> <span data-ttu-id="5aff5-113">アプリは、対話ユーザーとして実行中にも機能する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-113">Your app needs to work while running as the interactive user.</span></span> <span data-ttu-id="5aff5-114">Windows ストアからアプリをインストールするユーザーはシステム管理者ではない可能性があります。そのため、アプリは、標準ユーザーでは正しく動作しない、管理者だけが実行できる方法で実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-114">Users who install your app from the Windows Store may not be system administrators, so requiring your app to run elevated means that it won't run correctly for standard users.</span></span>

+ <span data-ttu-id="5aff5-115">__アプリにカーネル モード ドライバーや Windows サービスが必要__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-115">__Your app requires a kernel-mode driver or a Windows service__.</span></span> <span data-ttu-id="5aff5-116">ブリッジはアプリには適していますが、システム アカウントで実行する必要があるカーネル モード ドライバーや Windows サービスはサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-116">The bridge is suitable for an app, but it does not support a kernel-mode driver or a Windows service that needs to run under a system account.</span></span> <span data-ttu-id="5aff5-117">Windows サービスの代わりに、[バックグラウンド タスク](https://msdn.microsoft.com/windows/uwp/launch-resume/create-and-register-a-background-task)を使います。</span><span class="sxs-lookup"><span data-stu-id="5aff5-117">Instead of a Windows service, use a [background task](https://msdn.microsoft.com/windows/uwp/launch-resume/create-and-register-a-background-task).</span></span>

+ <span data-ttu-id="5aff5-118">__アプリのモジュールが、Windows アプリ パッケージに含まれていないプロセスに読み込まれるインプロセスである__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-118">__Your app's modules are loaded in-process to processes that are not in your Windows app package__.</span></span> <span data-ttu-id="5aff5-119">これは許可されていません。つまり、[シェルの拡張機能](https://msdn.microsoft.com/library/windows/desktop/dd758089.aspx)などのインプロセスの拡張機能はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-119">This isn't permitted, which means that in-process extensions, like [shell extensions](https://msdn.microsoft.com/library/windows/desktop/dd758089.aspx), aren't supported.</span></span> <span data-ttu-id="5aff5-120">ただし、同じパッケージに 2 つのアプリが含まれている場合に、そのアプリ間でプロセス間通信することはできます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-120">But if you have two apps in the same package, you can do inter-process communication between them.</span></span>

+ <span data-ttu-id="5aff5-121">__アプリでカスタム アプリケーション ユーザー モデル ID (AUMID) を使う__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-121">__Your app uses a custom Application User Model ID (AUMID)__.</span></span> <span data-ttu-id="5aff5-122">プロセスから [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422.aspx) を呼び出して独自の AUMID を設定する場合、アプリ モデル環境/Windows アプリ パッケージでその目的で生成された AUMID しか使えません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-122">If your process calls [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422.aspx) to set its own AUMID, then it may only use the AUMID generated for it by the app model environment/Windows app package.</span></span> <span data-ttu-id="5aff5-123">カスタムの AUMID を定義することはできません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-123">You can't define custom AUMIDs.</span></span>

+ <span data-ttu-id="5aff5-124">__アプリが HKEY_LOCAL_MACHINE (HKLM) レジストリ ハイブを変更する__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-124">__Your app modifies the HKEY_LOCAL_MACHINE (HKLM) registry hive__.</span></span> <span data-ttu-id="5aff5-125">アプリから HKLM キーを作成しようとしたり、変更のために開こうとしたりすると、アクセス拒否エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-125">Any attempt by your app to create an HKLM key, or to open one for modification, will result in an access-denied failure.</span></span> <span data-ttu-id="5aff5-126">アプリには、レジストリを仮想化した独自のプライベート ビューがあるため、ユーザーやマシン全体のレジストリ ハイブ (HKLM はこれに相当) の概念は適用されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-126">Remember that your app has its own private virtualized view of the registry, so the notion of a user- and machine-wide registry hive (which is what HKLM is) does not apply.</span></span> <span data-ttu-id="5aff5-127">HKLM を使って実現していたことを、HKEY_CURRENT_USER (HKCU) に書き込むなど別の方法で実現する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-127">You will need to find another way of achieving what you were using HKLM for, like writing to HKEY_CURRENT_USER (HKCU) instead.</span></span>

+ <span data-ttu-id="5aff5-128">__アプリで、別のアプリを起動する手段として ddeexec レジストリ サブキーを使っている__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-128">__Your app uses a ddeexec registry subkey as a means of launching another app__.</span></span> <span data-ttu-id="5aff5-129">代わりに、[アプリ パッケージ マニフェスト](https://msdn.microsoft.com/library/windows/apps/br211474.aspx)のさまざまなアクティブ化可能* な拡張機能で構成する DelegateExecute verb ハンドラーの 1 つを使います。</span><span class="sxs-lookup"><span data-stu-id="5aff5-129">Instead, use one of the DelegateExecute verb handlers as configured by the various Activatable* extensions in your [app package manifest](https://msdn.microsoft.com/library/windows/apps/br211474.aspx).</span></span>

+ <span data-ttu-id="5aff5-130">__アプリが、別のアプリとデータを共有するために AppData フォルダーまたはレジストリに書き込みを行う__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-130">__Your app writes to the AppData folder or to the registry with the intention of sharing data with another app__.</span></span> <span data-ttu-id="5aff5-131">変換後、AppData はローカル アプリ データ ストアにリダイレクトされます。このストアは、各 UWP アプリのプライベート ストアです。</span><span class="sxs-lookup"><span data-stu-id="5aff5-131">After conversion, AppData is redirected to the local app data store, which is a private store for each UWP app.</span></span>

  <span data-ttu-id="5aff5-132">アプリが HKEY_LOCAL_MACHINE レジストリ ハイブに書き込んだすべてのエントリが、分離されたバイナリ ファイルにリダイレクトされ、アプリが HKEY_CURRENT_USER レジストリ ハイブに書き込んだすべてのエントリが、ユーザーごと、アプリごとのプライベートな場所に配置されます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-132">All entries that your app writes to the HKEY_LOCAL_MACHINE registry hive are redirected to an isolated binary file and any entries that your app writes to the HKEY_CURRENT_USER registry hive are placed into a private per-user, per-app location.</span></span> <span data-ttu-id="5aff5-133">ファイルとレジストリのリダイレクトの詳細については、「[デスクトップ ブリッジの内側](desktop-to-uwp-behind-the-scenes.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-133">For more details about file and registry redirection, see [Behind the scenes of the Desktop Bridge](desktop-to-uwp-behind-the-scenes.md).</span></span>  

  <span data-ttu-id="5aff5-134">プロセス間データ共有に別の方法を使います。</span><span class="sxs-lookup"><span data-stu-id="5aff5-134">Use a different means of inter-process data sharing.</span></span> <span data-ttu-id="5aff5-135">詳しくは、「[設定と他のアプリ データを保存して取得する](https://msdn.microsoft.com/windows/uwp/app-settings/store-and-retrieve-app-data)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-135">For more info, see [Store and retrieve settings and other app data](https://msdn.microsoft.com/windows/uwp/app-settings/store-and-retrieve-app-data).</span></span>

+ <span data-ttu-id="5aff5-136">__アプリが、アプリのインストール ディレクトリに書き込みを行う__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-136">__Your app writes to the install directory for your app__.</span></span> <span data-ttu-id="5aff5-137">たとえば、exe と同じディレクトリに置いたログ ファイルにアプリが書き込む場合などです。</span><span class="sxs-lookup"><span data-stu-id="5aff5-137">For example, your app writes to a log file that you put in the same directory as your exe.</span></span> <span data-ttu-id="5aff5-138">この書き込みは、サポートされていないため、ローカル アプリ データ ストアなどの別の場所にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-138">This isn't supported, so you'll need to find another location, like the local app data store.</span></span>

+ <span data-ttu-id="5aff5-139">__アプリのインストールでユーザーの対話式操作を求める__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-139">__Your app installation requires user interaction__.</span></span> <span data-ttu-id="5aff5-140">アプリ インストーラーはサイレント実行でき、クリーンな状態の OS イメージには既定では存在しないすべての前提条件をインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-140">Your app installer must be able to run silently, and it must install all of its prerequisites that aren't on by default on a clean OS image.</span></span>

+ <span data-ttu-id="5aff5-141">__アプリで現在の作業ディレクトリを使う__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-141">__Your app uses the Current Working Directory__.</span></span> <span data-ttu-id="5aff5-142">パッケージ デスクトップ アプリでは、実行時に、デスクトップで以前に指定していたのと同じ作業ディレクトリ (.LNK ショートカット) を取得しません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-142">At runtime, your packaged desktop app won't get the same Working Directory that you previously specified in your desktop .LNK shortcut.</span></span> <span data-ttu-id="5aff5-143">アプリを正しく動作させるために現在のディレクトリを取得することが重要な場合は、実行時に CWD を変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-143">You need to change your CWD at runtime if having the correct directory is important for your app to function correctly.</span></span>

+ <span data-ttu-id="5aff5-144">__アプリで UIAccess が必要__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-144">__Your app requires UIAccess__.</span></span> <span data-ttu-id="5aff5-145">アプリケーションが UAC マニフェストの `requestedExecutionLevel` 要素で `UIAccess=true` を指定している場合の UWP への変換は現在サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-145">If your application specifies `UIAccess=true` in the `requestedExecutionLevel` element of the UAC manifest, conversion to UWP isn't supported currently.</span></span> <span data-ttu-id="5aff5-146">詳しくは、「[UI オートメーション セキュリティの概要](https://msdn.microsoft.com/library/ms742884.aspx)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-146">For more info, see [UI Automation Security Overview](https://msdn.microsoft.com/library/ms742884.aspx).</span></span>

+ <span data-ttu-id="5aff5-147">__COM オブジェクトをアプリで公開している__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-147">__Your app exposes COM objects__.</span></span> <span data-ttu-id="5aff5-148">パッケージ内のプロセスと拡張機能は、インプロセスとアウト プロセス (OOP) の両方で、COM サーバーおよび OLE サーバーを登録して使用できます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-148">Processes and extensions from within the package can register and use COM & OLE servers, both in-process and out-of-process (OOP).</span></span>  <span data-ttu-id="5aff5-149">Creators Update では、Packaged COM のサポートが追加されています。これにより、パッケージ外部で表示されるようになった OOP COM サーバーおよび OLE サーバーを登録できるようになります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-149">The Creators Update adds Packaged COM support which provides the ability to register OOP COM & OLE servers that are now visible outside the package.</span></span>  <span data-ttu-id="5aff5-150">[COM サーバーおよび OLE ドキュメントのデスクトップ ブリッジ用サポート](https://blogs.windows.com/buildingapps/2017/04/13/com-server-ole-document-support-desktop-bridge/#bjPyETFgtpZBGrS1.97)に関するブログをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-150">See [COM Server and OLE Document support for Desktop Bridge](https://blogs.windows.com/buildingapps/2017/04/13/com-server-ole-document-support-desktop-bridge/#bjPyETFgtpZBGrS1.97).</span></span>

   <span data-ttu-id="5aff5-151">Packaged COM のサポートは、既存の COM API に使用できますが、Packaged COM の場所はプライベートであるため、レジストリの読み取りに直接依存するアプリケーションの拡張機能には使用できません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-151">Packaged COM support works with existing COM APIs, but will not work for application extensions that rely upon directly reading the registry, as the location for Packaged COM is in a private location.</span></span>

+ <span data-ttu-id="5aff5-152">__他のプロセスで使用できるように GAC アセンブリをアプリで公開している__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-152">__Your app exposes GAC assemblies for use by other processes__.</span></span> <span data-ttu-id="5aff5-153">現在のリリースでは、Windows アプリ パッケージ外部の実行可能ファイルから生成されたプロセスで使用できるようにアプリが GAC アセンブリを公開することはできません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-153">In the current release, your app cannot expose GAC assemblies for use by processes originating from executables external to your Windows app package.</span></span> <span data-ttu-id="5aff5-154">パッケージ内のプロセスは、通常どおり、GAC アセンブリを登録して使用できますが、外部からは認識されません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-154">Processes from within the package can register and use GAC assemblies as normal, but they will not be visible externally.</span></span> <span data-ttu-id="5aff5-155">つまり、OLE などの相互運用機能のシナリオは、外部プロセスによって呼び出された場合、機能しません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-155">This means interop scenarios like OLE will not function if invoked by external processes.</span></span>

+ <span data-ttu-id="5aff5-156">__サポートされていない方法でアプリが C ランタイム ライブラリ (CRT) にリンクされている__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-156">__Your app is linking C runtime libraries (CRT) in an unsupported manner__.</span></span> <span data-ttu-id="5aff5-157">Microsoft C/C++ ランタイム ライブラリは、Microsoft Windows オペレーティング システムのプログラミングのルーチンを提供します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-157">The Microsoft C/C++ runtime library provides routines for programming for the Microsoft Windows operating system.</span></span> <span data-ttu-id="5aff5-158">これらのルーチンは、C および C++ 言語では提供されない、多くの一般的なプログラミング タスクを自動化します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-158">These routines automate many common programming tasks that are not provided by the C and C++ languages.</span></span> <span data-ttu-id="5aff5-159">アプリで C/C++ ランタイム ライブラリを使用している場合、サポートされている方法でリンクされていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-159">If your app utilizes C/C++ runtime library, you need to ensure it is linked in a supported manner.</span></span>

    <span data-ttu-id="5aff5-160">Visual Studio 2015 は、現在のバージョンの CRT に対して、コードで共通の DLL ファイルを使用できるようにするダイナミック リンクと、コードに直接ライブラリをリンクするスタティック リンクの両方をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="5aff5-160">Visual Studio 2015 supports both dynamic linking, to let your code use common DLL files, or static linking, to link the library directly into your code, to the current version of the CRT.</span></span> <span data-ttu-id="5aff5-161">可能であれば、アプリで VS 2015 へのダイナミック リンクを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="5aff5-161">If possible, we recommend your app use dynamic linking with VS 2015.</span></span>

    <span data-ttu-id="5aff5-162">以前のバージョンの Visual Studio でのサポートは異なります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-162">Support in previous versions of Visual Studio varies.</span></span> <span data-ttu-id="5aff5-163">詳しくは、次の表をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-163">See the following table for details:</span></span>

    <table>
    <th><span data-ttu-id="5aff5-164">Visual Studio のバージョン</span><span class="sxs-lookup"><span data-stu-id="5aff5-164">Visual Studio version</span></span></td><th><span data-ttu-id="5aff5-165">ダイナミック リンク</span><span class="sxs-lookup"><span data-stu-id="5aff5-165">Dynamic linking</span></span></th><th><span data-ttu-id="5aff5-166">スタティック リンク</span><span class="sxs-lookup"><span data-stu-id="5aff5-166">Static linking</span></span></th></th>
    <tr><td><span data-ttu-id="5aff5-167">2005 (VC 8)</span><span class="sxs-lookup"><span data-stu-id="5aff5-167">2005 (VC 8)</span></span></td><td><span data-ttu-id="5aff5-168">サポートされない</span><span class="sxs-lookup"><span data-stu-id="5aff5-168">Not supported</span></span></td><td><span data-ttu-id="5aff5-169">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-169">Supported</span></span></td>
    <tr><td><span data-ttu-id="5aff5-170">2008 (VC 9)</span><span class="sxs-lookup"><span data-stu-id="5aff5-170">2008 (VC 9)</span></span></td><td><span data-ttu-id="5aff5-171">サポートされない</span><span class="sxs-lookup"><span data-stu-id="5aff5-171">Not supported</span></span></td><td><span data-ttu-id="5aff5-172">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-172">Supported</span></span></td>
    <tr><td><span data-ttu-id="5aff5-173">2010 (VC 10)</span><span class="sxs-lookup"><span data-stu-id="5aff5-173">2010 (VC 10)</span></span></td><td><span data-ttu-id="5aff5-174">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-174">Supported</span></span></td><td><span data-ttu-id="5aff5-175">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-175">Supported</span></span></td>
    <tr><td><span data-ttu-id="5aff5-176">2012 (VC 11)</span><span class="sxs-lookup"><span data-stu-id="5aff5-176">2012 (VC 11)</span></span></td><td><span data-ttu-id="5aff5-177">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-177">Supported</span></span></td><td><span data-ttu-id="5aff5-178">サポートされない</span><span class="sxs-lookup"><span data-stu-id="5aff5-178">Not supported</span></span></td>
    <tr><td><span data-ttu-id="5aff5-179">2013 (VC 12)</span><span class="sxs-lookup"><span data-stu-id="5aff5-179">2013 (VC 12)</span></span></td><td><span data-ttu-id="5aff5-180">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-180">Supported</span></span></td><td><span data-ttu-id="5aff5-181">サポートされない</span><span class="sxs-lookup"><span data-stu-id="5aff5-181">Not supported</span></span></td>
    <tr><td><span data-ttu-id="5aff5-182">2015 (VC 14)</span><span class="sxs-lookup"><span data-stu-id="5aff5-182">2015 (VC 14)</span></span></td><td><span data-ttu-id="5aff5-183">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-183">Supported</span></span></td><td><span data-ttu-id="5aff5-184">サポートされる</span><span class="sxs-lookup"><span data-stu-id="5aff5-184">Supported</span></span></td>
    </table>

    <span data-ttu-id="5aff5-185">注: いずれの場合も、最新の公開されている CRT にリンクする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-185">Note: In all cases, you must link to the latest publically available CRT.</span></span>

+ <span data-ttu-id="5aff5-186">__アプリが Windows サイドバイサイド フォルダーからアセンブリをインストールする/読み込む__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-186">__Your app installs and loads assemblies from the Windows side-by-side folder__.</span></span> <span data-ttu-id="5aff5-187">たとえば、アプリが C ランタイム ライブラリ VC8 または VC9 を使用しており、Windows サイドバイサイド フォルダーから動的にリンクしている、つまり、コードが共有フォルダーから共通の DLL ファイルを使用しているとします。</span><span class="sxs-lookup"><span data-stu-id="5aff5-187">For example, your app uses C runtime libraries VC8 or VC9 and is dynamically linking them from Windows side-by-side folder, meaning your code is using the common DLL files from a shared folder.</span></span> <span data-ttu-id="5aff5-188">これはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-188">This is not supported.</span></span> <span data-ttu-id="5aff5-189">再頒布可能なライブラリ ファイルをコードに直接リンクして、静的にリンクする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-189">You will need to statically link them by linking to the redistributable library files directly into your code.</span></span>

+ <span data-ttu-id="5aff5-190">__アプリが、System32/SysWOW64 フォルダーの依存関係を使っている__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-190">__Your app uses a dependency in the System32/SysWOW64 folder__.</span></span> <span data-ttu-id="5aff5-191">DLL が機能するためには、Windows アプリ パッケージの仮想ファイル システム部分にそれらの DLL を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-191">To get these DLLs to work, you must include them in the virtual file system portion of your Windows app package.</span></span> <span data-ttu-id="5aff5-192">これにより、アプリは DLL が **System32**/**SysWOW64** フォルダーにインストールされている場合と同じように動作します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-192">This ensures that the app behaves as if the DLLs were installed in the **System32**/**SysWOW64** folder.</span></span> <span data-ttu-id="5aff5-193">パッケージのルートで **VFS** という名前のフォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-193">In the root of the package, create a folder called **VFS**.</span></span> <span data-ttu-id="5aff5-194">そのフォルダー内に、**SystemX64** フォルダーと **SystemX86**フォルダーを作成します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-194">Inside that folder create a **SystemX64** and **SystemX86** folder.</span></span> <span data-ttu-id="5aff5-195">**SystemX86** フォルダーに DLL の 32 ビット バージョンを格納し、**SystemX64** フォルダーに 64 ビット バージョンを格納します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-195">Then, place the 32-bit version of your DLL in the **SystemX86** folder, and place the 64-bit version in the **SystemX64** folder.</span></span>

+ <span data-ttu-id="5aff5-196">__アプリが Dev11 VCLibs フレームワーク パッケージを使っている__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-196">__Your app uses the Dev11 VCLibs framework package__.</span></span> <span data-ttu-id="5aff5-197">VCLibs 11 ライブラリは、Windows アプリ パッケージで依存関係として定義されている場合、Windows ストアから直接インストールできます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-197">The VCLibs 11 libraries can be directly installed from the Windows Store if they are defined as a dependency in the Windows app package.</span></span> <span data-ttu-id="5aff5-198">これを行うには、`<Dependencies>` ノードの下に、以下を追加して変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-198">To do this, make the following change to your app package manifest: Under the `<Dependencies>` node, add:</span></span>  
`<PackageDependency Name="Microsoft.VCLibs.110.00.UWPDesktop" MinVersion="11.0.24217.0" Publisher="CN=Microsoft Corporation, O=Microsoft Corporation, L=Redmond, S=Washington, C=US" />`  
<span data-ttu-id="5aff5-199">Windows ストアからインストールするとき、アプリをインストールする前に VCLibs 11 フレームワークの適切なバージョン (x86 または x64) がインストールされます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-199">During installation from the Windows Store, the appropriate version (x86 or x64) of the VCLibs 11 framework will get installed prior to the installation of the app.</span></span>  
<span data-ttu-id="5aff5-200">アプリがサイドローディングによってインストールされる場合は、依存関係がインストールされません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-200">The dependencies will not get installed if the app is installed by sideloading.</span></span> <span data-ttu-id="5aff5-201">コンピューター上に依存関係を手動でインストールするには、[VC 11.0 Desktop Bridge 用フレームワーク パッケージ](https://www.microsoft.com/download/details.aspx?id=53340&WT.mc_id=DX_MVP4025064)をダウンロードしてインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-201">To install the dependencies manually on your machine, you must download and install the [VC 11.0 framework packages for Desktop Bridge](https://www.microsoft.com/download/details.aspx?id=53340&WT.mc_id=DX_MVP4025064).</span></span> <span data-ttu-id="5aff5-202">これらのシナリオについて詳しくは、「[Using Visual C++ Runtime in Centennial project (Centennial プロジェクトで Visual C++ ラインタイムを使用する)](https://blogs.msdn.microsoft.com/vcblog/2016/07/07/using-visual-c-runtime-in-centennial-project/)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-202">For more information on these scenarios, see [Using Visual C++ Runtime in Centennial project](https://blogs.msdn.microsoft.com/vcblog/2016/07/07/using-visual-c-runtime-in-centennial-project/).</span></span>

+ <span data-ttu-id="5aff5-203">__アプリにカスタム ジャンプ リストが含まれる__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-203">__Your app contains a custom jump list__.</span></span> <span data-ttu-id="5aff5-204">ジャンプ リストを使用する場合は、いくつかの問題と注意事項があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-204">There are several issues and caveats to aware of when using jump lists.</span></span>

    - __<span data-ttu-id="5aff5-205">アプリのアーキテクチャが OS と一致しない。</span><span class="sxs-lookup"><span data-stu-id="5aff5-205">Your app's architecture does not match the OS.</span></span>__  <span data-ttu-id="5aff5-206">現在、アプリと OS のアーキテクチャが一致しない場合 (x64 Windows で実行されている x86 アプリなど)、ジャンプ リストは正しく機能しません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-206">Jump lists currently do not function correctly if the app and OS architectures do not match (e.g., an x86 app running on x64 Windows).</span></span> <span data-ttu-id="5aff5-207">現時点では、アプリを再コンパイルしてアーキテクチャを一致させる以外に回避策はありません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-207">At this time, there is no workaround other than to recompile your app to the matching architecture.</span></span>

    - <span data-ttu-id="5aff5-208">__アプリがジャンプ リストの項目を作成して、[ICustomDestinationList::SetAppID](https://msdn.microsoft.com/library/windows/desktop/dd378403(v=vs.85).aspx) または [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422(v=vs.85).aspx) を呼び出す__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-208">__Your app creates jump list entries and calls [ICustomDestinationList::SetAppID](https://msdn.microsoft.com/library/windows/desktop/dd378403(v=vs.85).aspx) or [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422(v=vs.85).aspx)__.</span></span> <span data-ttu-id="5aff5-209">プログラムによって AppID をコードに設定しないでください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-209">Do not programmatically set your AppID in code.</span></span> <span data-ttu-id="5aff5-210">そうすると、ジャンプ リストの項目が表示されません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-210">Doing so will cause your jump list entries to not appear.</span></span> <span data-ttu-id="5aff5-211">アプリにカスタム ID が必要な場合は、マニフェスト ファイルを使用して指定してください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-211">If your app needs a custom Id, specify it using the manifest file.</span></span> <span data-ttu-id="5aff5-212">手順については、「[アプリを手動でパッケージ化する (デスクトップ ブリッジ)](desktop-to-uwp-manual-conversion.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-212">Refer to [Package an app manually (Desktop Bridge)](desktop-to-uwp-manual-conversion.md) for instructions.</span></span> <span data-ttu-id="5aff5-213">アプリケーションの AppID は *YOUR_PRAID_HERE* セクションに指定されます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-213">The AppID for your application is specified in the *YOUR_PRAID_HERE* section.</span></span>

    - <span data-ttu-id="5aff5-214">__アプリが、パッケージ内の実行可能ファイルを参照するジャンプ リスト シェル リンクを追加します__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-214">__Your app adds a jump list shell link that references an executable in your package__.</span></span> <span data-ttu-id="5aff5-215">ジャンプ リストから直接、パッケージ内の実行可能ファイルを起動することはできません (アプリ自体の .exe の絶対パスを使用する場合は除く)。</span><span class="sxs-lookup"><span data-stu-id="5aff5-215">You cannot directly launch executables in your package from a jump list (with the exception of the absolute path of an app’s own .exe).</span></span> <span data-ttu-id="5aff5-216">アプリの実行エイリアスを登録し (これで、まるで PATH に指定されているかのように、キーワードを使ってパッケージ デスクトップ アプリを起動できます)、リンク先のパスにこのエイリアスを設定します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-216">Instead, register an app execution alias (which allows your packaged desktop app to start via a keyword as though it were on the PATH) and set the link target path to the alias instead.</span></span> <span data-ttu-id="5aff5-217">appExecutionAlias 拡張機能の使用方法については、「[Windows 10 にアプリを統合する (デスクトップ ブリッジ)](desktop-to-uwp-extensions.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-217">For details on how to use the appExecutionAlias extension, see [Integrate your app with Windows 10 (Desktop Bridge)](desktop-to-uwp-extensions.md).</span></span> <span data-ttu-id="5aff5-218">元の .exe に一致するジャンプ リストのリンク アセットが必要な場合は、他のカスタム項目と同様に、[**SetIconLocation**](https://msdn.microsoft.com/library/windows/desktop/bb761047(v=vs.85).aspx) を使用してアイコンなどのアセットを設定し、PKEY_Title を使用して名前を表示します。</span><span class="sxs-lookup"><span data-stu-id="5aff5-218">Note that if you require assets of the link in jump list to match the original .exe, you will need to set assets such as the icon using [**SetIconLocation**](https://msdn.microsoft.com/library/windows/desktop/bb761047(v=vs.85).aspx) and the display name with PKEY_Title like you would for other custom entries.</span></span>

    - <span data-ttu-id="5aff5-219">__アプリが、絶体パスを使用して、アプリのパッケージ内のアセットを参照するジャンプ リスト項目を追加します__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-219">__Your app adds a jump list entries that references assets in the app's package by absolute paths__.</span></span> <span data-ttu-id="5aff5-220">アプリのインストール パスが、パッケージが更新されるときに変更され、アセット (アイコン、ドキュメント、実行可能ファイルなど) の場所が変わる場合があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-220">The installation path of an app may change when its packages are updated, changing the location of assets (such as icons, documents, executable, and so on).</span></span> <span data-ttu-id="5aff5-221">ジャンプ リストの項目が、そのようなアセットを絶対パスで参照している場合、アプリのジャンプ リストを定期的に (アプリの起動時など) 更新して、パスが正しく解決されるようにします。</span><span class="sxs-lookup"><span data-stu-id="5aff5-221">If jump list entries reference such assets by absolute paths, then the app should refresh its jump list periodically (such as on app launch) to ensure paths resolve correctly.</span></span> <span data-ttu-id="5aff5-222">または、UWP [**Windows.UI.StartScreen.JumpList**](https://msdn.microsoft.com/library/windows/apps/windows.ui.startscreen.jumplist.aspx) API を使用します。この API では、package-relative ms-resource URI スキーマ (これは言語、DPI、ハイ コントラストにも対応します) を使用して、文字列アセットと画像アセットを参照できます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-222">Alternatively, use the UWP [**Windows.UI.StartScreen.JumpList**](https://msdn.microsoft.com/library/windows/apps/windows.ui.startscreen.jumplist.aspx) APIs instead, which allow you to reference string and image assets using the package-relative ms-resource URI scheme (which is also language, DPI, and high contrast aware).</span></span>

+ <span data-ttu-id="5aff5-223">__タスクを実行するユーティリティがアプリによって起動される__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-223">__Your app starts a utility to perform tasks__.</span></span> <span data-ttu-id="5aff5-224">PowerShell や Cmd.exe など、コマンド ユーティリティの起動は避けてください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-224">Avoid starting command utilities such as PowerShell and Cmd.exe.</span></span> <span data-ttu-id="5aff5-225">Windows 10 S を実行するシステムにユーザーが対象アプリをインストールした場合、アプリではこのようなユーティリティを一切起動できません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-225">In fact, if users install your app onto a system that runs the Windows 10 S, then your app won’t be able to start them at all.</span></span> <span data-ttu-id="5aff5-226">Windows ストアへのアプリの申請がブロックされる可能性があります。これは、Windows ストアに申請されるすべてのアプリが Windows 10 S に対応している必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="5aff5-226">This could block your app from submission to the Windows Store because all apps submitted to the Windows Store must be compatible with Windows 10 S.</span></span>

<span data-ttu-id="5aff5-227">ユーティリティの起動は、オペレーティング システムからの情報の取得、レジストリへのアクセス、システム機能へのアクセスなどを行うための手段として便利であることが少なくありません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-227">Starting a utility can often provide a convenient way to obtain information from the operating system, access the registry, or access system capabilities.</span></span> <span data-ttu-id="5aff5-228">ただし、このような作業を実行するには、代わりに UWP API を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-228">However, you can use UWP APIs to accomplish these sorts of tasks instead.</span></span> <span data-ttu-id="5aff5-229">個別の実行可能ファイルを必要としないため、これらの API の方が高効率ですが、さらに重要な点は、この方法を使用するとパッケージ外でアプリにアクセスされないよう分離できることです。</span><span class="sxs-lookup"><span data-stu-id="5aff5-229">Those APIs are more performant because they don’t need a separate executable to run, but more importantly, they keep the app from reaching outside of the package.</span></span> <span data-ttu-id="5aff5-230">アプリの設計が、デスクトップ ブリッジ アプリで提供される分離、信頼性、セキュリティに従った形に維持されるため、Windows 10 S で実行されるシステムで、アプリを正しく実行できます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-230">The app’s design stays consistent with the isolation, trust, and security that comes with a desktop bridge app, and your app will behave as expected on systems running Windows 10 S.</span></span>

+ <span data-ttu-id="5aff5-231">__アプリで、アドイン、プラグイン、または拡張機能をホストしている__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-231">__Your app hosts add-ins, plug-ins, or extensions__.</span></span>   <span data-ttu-id="5aff5-232">多くの場合、COM スタイルの拡張機能は、引き続き動作します。ただし、拡張機能がパッケージ化されておらず、完全信頼としてインストールされている場合に限られます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-232">In many cases, COM-style extensions will likely continue to work as long as the extension has not been packaged, and it installs as full trust.</span></span> <span data-ttu-id="5aff5-233">これは、インストーラーによって、完全信頼機能を使用してレジストリを変更し、ホスト アプリで検出できる任意の場所に拡張機能を配置することが可能であるためです。</span><span class="sxs-lookup"><span data-stu-id="5aff5-233">That's because those installers can use their full-trust capabilities to modify the registry and place extension files wherever your host app expects to find them.</span></span>

   <span data-ttu-id="5aff5-234">ただし、これらの拡張機能がパッケージ化され、Windows アプリ パッケージとしてインストールされた場合は、各パッケージ (ホスト アプリと拡張機能) が互いに分離されるため、正しく動作しません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-234">However, if those extensions are packaged, and then installed as a Windows app package, they won't work because each package (the host app and the extension) will be isolated from one another.</span></span> <span data-ttu-id="5aff5-235">デスクトップ ブリッジによってアプリケーションがシステムから分離されるしくみについては、「[デスクトップ ブリッジの内側](desktop-to-uwp-behind-the-scenes.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-235">To read more about how desktop bridge isolates applications from the system, see [Behind the scenes of the Desktop Bridge](desktop-to-uwp-behind-the-scenes.md).</span></span>

 <span data-ttu-id="5aff5-236">Windows 10 S を実行するシステムにユーザーがインストールするすべてのアプリケーションおよび拡張機能は、Windows アプリ パッケージとしてインストールされる必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-236">All applications and extensions that users install to a system running Windows 10 S must be installed as Windows App packages.</span></span> <span data-ttu-id="5aff5-237">このため、拡張機能をパッケージ化する予定がある場合や、関係者にパッケージ化を奨励する場合は、ホスト アプリ パッケージと拡張機能パッケージの間でのやり取りをどのように実現するか、検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-237">So if you intend to package your extensions, or you plan to encourage your contributors to package them, consider how you might facilitate communication between the host app package and any extension packages.</span></span> <span data-ttu-id="5aff5-238">1 つの方法として、[アプリ サービス](../launch-resume/app-services.md)を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="5aff5-238">One way that you might be able to do this is by using an [app service](../launch-resume/app-services.md).</span></span>

+ <span data-ttu-id="5aff5-239">__アプリがコードを生成する__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-239">__Your app generates code__.</span></span> <span data-ttu-id="5aff5-240">アプリは、メモリ内で消費されるコードを生成できますが、生成されたコードはディスクに書き込まないでください。このようなコードは、アプリの提出前に Windows アプリ認定プロセスで検証することができません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-240">Your app can generate code that it consumes in memory, but avoid writing generated code to disk because the Windows App Certification process can't validate that code prior to app submission.</span></span> <span data-ttu-id="5aff5-241">また、Windows 10 S を実行するシステムでは、ディスクにコードを書き込むアプリは正しく動作しません。Windows ストアに申請されるすべてのアプリが Windows 10 S に対応している必要があるため、Windows ストアへのアプリの申請がブロックされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5aff5-241">Also, apps that write code to disk won’t run properly on systems running Windows 10 S. This could block your app from submission to the Windows Store because all apps submitted to the Windows Store must be compatible with Windows 10 S.</span></span>

+ <span data-ttu-id="5aff5-242">__アプリが MAPI API を使用している__。</span><span class="sxs-lookup"><span data-stu-id="5aff5-242">__Your app uses the MAPI API__.</span></span> <span data-ttu-id="5aff5-243">現在、[Outlook MAPI API](https://msdn.microsoft.com/library/office/cc765775.aspx(d=robot)) はデスクトップ ブリッジ アプリでサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="5aff5-243">The [Outlook MAPI API](https://msdn.microsoft.com/library/office/cc765775.aspx(d=robot)) is not currently supported in desktop bridge apps.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5aff5-244">次のステップ</span><span class="sxs-lookup"><span data-stu-id="5aff5-244">Next steps</span></span>

**<span data-ttu-id="5aff5-245">デスクトップ アプリの Windows アプリ パッケージを作成する</span><span class="sxs-lookup"><span data-stu-id="5aff5-245">Create a Windows app packge for your desktop app</span></span>**

<span data-ttu-id="5aff5-246">「[Windows アプリ パッケージを作成する](desktop-to-uwp-root.md#convert)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-246">See [Create a Windows app package](desktop-to-uwp-root.md#convert)</span></span>

**<span data-ttu-id="5aff5-247">特定の質問に対する回答を見つける</span><span class="sxs-lookup"><span data-stu-id="5aff5-247">Find answers to specific questions</span></span>**

<span data-ttu-id="5aff5-248">マイクロソフトのチームでは、[StackOverflow タグ](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge)をチェックしています。</span><span class="sxs-lookup"><span data-stu-id="5aff5-248">Our team monitors these [StackOverflow tags](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge).</span></span>

**<span data-ttu-id="5aff5-249">この記事に関するフィードバックを送信する</span><span class="sxs-lookup"><span data-stu-id="5aff5-249">Give feedback about this article</span></span>**

<span data-ttu-id="5aff5-250">下のコメント セクションをご利用ください。</span><span class="sxs-lookup"><span data-stu-id="5aff5-250">Use the comments section below.</span></span>
