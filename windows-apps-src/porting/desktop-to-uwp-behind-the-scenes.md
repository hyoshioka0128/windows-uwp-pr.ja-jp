---
author: normesta
Description: "この記事では、デスクトップ ブリッジの内部的な処理について詳しく説明します。"
title: "デスクトップ ブリッジの内側"
ms.author: normesta
ms.date: 05/25/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP
ms.assetid: a399fae9-122c-46c4-a1dc-a1a241e5547a
ms.openlocfilehash: 050499baaf383fc135d833ae1e4733c95f2b5fa1
ms.sourcegitcommit: 7540962003b38811e6336451bb03d46538b35671
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/26/2017
---
# <a name="behind-the-scenes-of-the-desktop-bridge"></a><span data-ttu-id="134bf-104">デスクトップ ブリッジの内側</span><span class="sxs-lookup"><span data-stu-id="134bf-104">Behind the scenes of the Desktop Bridge</span></span>

<span data-ttu-id="134bf-105">この記事では、デスクトップ ブリッジの内部的な処理について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="134bf-105">This article provides a deeper dive on how the Desktop Bridge works under the covers.</span></span>

<span data-ttu-id="134bf-106">デスクトップ ブリッジの主な目的は、他のアプリとの互換性を維持しつつ、アプリケーションの状態をシステムの状態からできるだけ分離することです。</span><span class="sxs-lookup"><span data-stu-id="134bf-106">A key goal of the Desktop Bridge is to separate application state from system state as much as possible while maintaining compatibility with other apps.</span></span> <span data-ttu-id="134bf-107">ブリッジではこれを行うために、アプリケーションをユニバーサル Windows プラットフォーム (UWP) パッケージ内に配置し、実行時にファイル システムとレジストリに行われる変更を検出して、一部の変更のリダイレクトを行います。</span><span class="sxs-lookup"><span data-stu-id="134bf-107">The bridge accomplishes this by placing the application inside a Universal Windows Platform (UWP) package, and then detecting and redirecting some changes  it makes to the file system and registry at runtime.</span></span>

<span data-ttu-id="134bf-108">デスクトップ アプリ用に作成されたパッケージは、完全に信頼できるデスクトップ専用アプリケーションであり、仮想化やサンド ボックス化は行われません。</span><span class="sxs-lookup"><span data-stu-id="134bf-108">Packages that you create for your desktop app are desktop-only, full-trust applications and are not virtualized or sandboxed.</span></span> <span data-ttu-id="134bf-109">このため、従来のデスクトップ アプリケーションと同じように、他のアプリとやり取りすることが可能です。</span><span class="sxs-lookup"><span data-stu-id="134bf-109">This allows them to interact with other apps the same way classic desktop applications do.</span></span>

## <a name="installation"></a><span data-ttu-id="134bf-110">インストール</span><span class="sxs-lookup"><span data-stu-id="134bf-110">Installation</span></span>

<span data-ttu-id="134bf-111">アプリ パッケージは *C:\Program Files\WindowsApps\package_name* にインストールされ、実行可能プログラム名は *app_name.exe* になります。</span><span class="sxs-lookup"><span data-stu-id="134bf-111">App packages are installed under *C:\Program Files\WindowsApps\package_name*, with the executable titled *app_name.exe*.</span></span> <span data-ttu-id="134bf-112">各パッケージ フォルダーには、パッケージ アプリ用の XML 名前空間を含むマニフェスト (AppxManifest.xml という名前) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="134bf-112">Each package folder contains a manifest (named AppxManifest.xml) that contains a special XML namespace for packaged apps.</span></span> <span data-ttu-id="134bf-113">マニフェスト ファイル内の ```<EntryPoint>``` 要素で、完全信頼アプリを参照します。</span><span class="sxs-lookup"><span data-stu-id="134bf-113">Inside that manifest file is an ```<EntryPoint>``` element, which references the full-trust app.</span></span> <span data-ttu-id="134bf-114">アプリが起動されると、アプリ コンテナー内では実行されず、ユーザーが通常実行するように実行されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-114">When that app is launched, it does not run inside an app container, but instead it runs as the user as it normally would.</span></span>

<span data-ttu-id="134bf-115">展開後、パッケージ ファイルは読み取り専用としてマークされ、オペレーティング システムによって厳重にロックダウンされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-115">After deployment, package files are marked read-only and heavily locked down by the operating system.</span></span> <span data-ttu-id="134bf-116">これらのファイルが改ざんされると、Windows によりアプリの起動が回避されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-116">Windows prevents apps from launching if these files are tampered with.</span></span>

## <a name="file-system"></a><span data-ttu-id="134bf-117">ファイル システム</span><span class="sxs-lookup"><span data-stu-id="134bf-117">File system</span></span>

<span data-ttu-id="134bf-118">ブリッジでは、アプリの状態を含めるために、アプリによる AppData への変更がキャプチャされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-118">In order to contain app state, the bridge attempts to capture changes the app makes to AppData.</span></span> <span data-ttu-id="134bf-119">作成、削除、更新など、ユーザーの AppData フォルダー (例: *C:\Users\user_name\AppData*) に対する書き込みはすべて、書き込み時にユーザーごと、アプリごとのプライベートな場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-119">All write to the user's AppData folder (e.g., *C:\Users\user_name\AppData*), including create, delete, and update, are copied on write to a private per-user, per-app location.</span></span> <span data-ttu-id="134bf-120">つまり、パッケージ アプリが AppData への編集を行っているように見えても、実際に行われているのはプライベート コピーへの変更です。</span><span class="sxs-lookup"><span data-stu-id="134bf-120">This creates the illusion that the packaged app is editing the real AppData when it is actually modifying a private copy.</span></span> <span data-ttu-id="134bf-121">このように書き込みのリダイレクトを行うことで、アプリによって行われたすべてのファイル変更をシステムで追跡できます。</span><span class="sxs-lookup"><span data-stu-id="134bf-121">By redirecting writes this way, the system can track all file modifications made by the app.</span></span> <span data-ttu-id="134bf-122">これにより、アプリのアンインストール時にシステムがこれらのファイルをクリーンアップできるため、システムの "劣化" を抑え、ユーザーから見たアプリ削除の操作を改善することができます。</span><span class="sxs-lookup"><span data-stu-id="134bf-122">This allows the system to clean up those files when the app is uninstalled, thus reducing system "rot" and providing a better app removal experience for the user.</span></span>

<span data-ttu-id="134bf-123">ブリッジでは、AppData のリダイレクトに加えて、Windows の既知のフォルダー (System32、Program Files (x86) など) がアプリ パッケージ内の対応するディレクトリに動的にマージされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-123">In addition to redirecting AppData, the bridge also dynamically merges Windows' well-known folders (System32, Program Files (x86), etc) with corresponding directories in the app package.</span></span> <span data-ttu-id="134bf-124">それぞれのパッケージのルート ディレクトリには、"VFS" という名前のフォルダーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="134bf-124">Each package contains a folder named "VFS" at its root.</span></span> <span data-ttu-id="134bf-125">この VFS ディレクトリ内のディレクトリまたはファイルに対する読み取り操作は、実行時にそれぞれ対応するネイティブ部分にマージされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-125">Any reads of directories or files in the VFS directory are merged at runtime with their respective native counterparts.</span></span> <span data-ttu-id="134bf-126">たとえば、アプリ パッケージに *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\vc10.dll* が含まれている場合、このファイルは *C:\Windows\System32\vc10.dll* にインストールされているように表示されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-126">For example, an app could contain *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\vc10.dll* as part of its app package, but the file would appear to be installed at *C:\Windows\System32\vc10.dll*.</span></span>  <span data-ttu-id="134bf-127">これにより、ファイルがパッケージ外の場所にあることを想定しているデスクトップ アプリケーションとの互換性が維持されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-127">This maintains compatibility with desktop applications that may expect files to live in non-package locations.</span></span>

<span data-ttu-id="134bf-128">アプリ パッケージ内のファイルまたはフォルダーへの書き込みは、許可されていません。</span><span class="sxs-lookup"><span data-stu-id="134bf-128">Writes to files/folders in the app package are not allowed.</span></span> <span data-ttu-id="134bf-129">パッケージに含まれないファイルやフォルダーへの書き込みは、ブリッジでは無視され、ユーザーにアクセス許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-129">Writes to files and folders that are not part of the package are ignored by the bridge and are allowed as long as the user has permission.</span></span>

### <a name="common-operations"></a><span data-ttu-id="134bf-130">一般的な操作</span><span class="sxs-lookup"><span data-stu-id="134bf-130">Common operations</span></span>

<span data-ttu-id="134bf-131">一般的なファイル システム操作とブリッジでの処理方法を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="134bf-131">This short reference table shows common file system operations and how the bridge handles them.</span></span>

<span data-ttu-id="134bf-132">操作</span><span class="sxs-lookup"><span data-stu-id="134bf-132">Operation</span></span> | <span data-ttu-id="134bf-133">結果</span><span class="sxs-lookup"><span data-stu-id="134bf-133">Result</span></span> | <span data-ttu-id="134bf-134">例</span><span class="sxs-lookup"><span data-stu-id="134bf-134">Example</span></span>
:--- | :--- | :---
<span data-ttu-id="134bf-135">既知の Windows ファイルまたはフォルダーに対する読み取りまたは列挙</span><span class="sxs-lookup"><span data-stu-id="134bf-135">Read or enumerate a well-known Windows file or folder</span></span> | <span data-ttu-id="134bf-136">*C:\Program Files\package_name\VFS\well_known_folder* がローカル システムの対応部分に動的にマージされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-136">A dynamic merge of *C:\Program Files\package_name\VFS\well_known_folder* with the local system counterpart.</span></span> | <span data-ttu-id="134bf-137">*C:\Windows\System32* の読み取りでは、*C:\Windows\System32* の内容と *C:\Program Files\WindowsApps\package_name\VFS\SystemX86* の内容が返されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-137">Reading *C:\Windows\System32* returns the contents of *C:\Windows\System32* plus the contents of *C:\Program Files\WindowsApps\package_name\VFS\SystemX86*.</span></span>
<span data-ttu-id="134bf-138">AppData 内の書き込み</span><span class="sxs-lookup"><span data-stu-id="134bf-138">Write under AppData</span></span> | <span data-ttu-id="134bf-139">書き込み時に、ユーザーごと、アプリごとの場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-139">Copy-on-written to a per-user, per-app location.</span></span> | <span data-ttu-id="134bf-140">AppData は通常、*C:\Users\user_name\AppData* です。</span><span class="sxs-lookup"><span data-stu-id="134bf-140">AppData is typically *C:\Users\user_name\AppData*.</span></span>  
<span data-ttu-id="134bf-141">パッケージ内の書き込み</span><span class="sxs-lookup"><span data-stu-id="134bf-141">Write inside the package</span></span> | <span data-ttu-id="134bf-142">許可されていません。</span><span class="sxs-lookup"><span data-stu-id="134bf-142">Not allowed.</span></span> <span data-ttu-id="134bf-143">パッケージは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="134bf-143">The package is read-only.</span></span> | <span data-ttu-id="134bf-144">*C:\Program Files\WindowsApps\package_name* 内の書き込みは、許可されていません。</span><span class="sxs-lookup"><span data-stu-id="134bf-144">Writes under *C:\Program Files\WindowsApps\package_name* are not allowed.</span></span>
<span data-ttu-id="134bf-145">パッケージ外の書き込み</span><span class="sxs-lookup"><span data-stu-id="134bf-145">Writes outside the package</span></span> | <span data-ttu-id="134bf-146">ブリッジでは無視されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-146">Ignored by the bridge.</span></span> <span data-ttu-id="134bf-147">ユーザーにアクセス許可があれば、許可されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-147">Allowed if the user has permissions.</span></span> | <span data-ttu-id="134bf-148">*C:\Windows\System32\foo.dll* への書き込みは、パッケージに *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\foo.dll* が含まれておらずユーザーにアクセス許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-148">A write to *C:\Windows\System32\foo.dll* is allowed if the package does not contain *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\foo.dll* and the user has permissions.</span></span>

### <a name="packaged-vfs-locations"></a><span data-ttu-id="134bf-149">パッケージ化された VFS の場所</span><span class="sxs-lookup"><span data-stu-id="134bf-149">Packaged VFS locations</span></span>

<span data-ttu-id="134bf-150">次の表は、パッケージの一部として含まれるファイルが、システム上でアプリのためにどのように配置されるかを示しています。</span><span class="sxs-lookup"><span data-stu-id="134bf-150">The following table shows where files shipping as part of your package are overlaid on the system for the app.</span></span> <span data-ttu-id="134bf-151">これらのファイルは、アプリではここに示されているシステム内の場所にあると認識されますが、実際にはリダイレクトされており、*C:\Program Files\WindowsApps\package_name\VFS* 内の場所に配置されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-151">Your app will perceive these files to be in the listed system locations, when in fact they are in the redirected locations inside *C:\Program Files\WindowsApps\package_name\VFS*.</span></span> <span data-ttu-id="134bf-152">FOLDERID の場所は [**KNOWNFOLDERID**](https://msdn.microsoft.com/library/windows/desktop/dd378457.aspx) 定数で示されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-152">The FOLDERID locations are from the [**KNOWNFOLDERID**](https://msdn.microsoft.com/library/windows/desktop/dd378457.aspx) constants.</span></span>

<span data-ttu-id="134bf-153">システムの場所</span><span class="sxs-lookup"><span data-stu-id="134bf-153">System Location</span></span> | <span data-ttu-id="134bf-154">リダイレクトされた場所 ([PackageRoot]\VFS\ の下)</span><span class="sxs-lookup"><span data-stu-id="134bf-154">Redirected Location (Under [PackageRoot]\VFS\)</span></span> | <span data-ttu-id="134bf-155">有効なアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="134bf-155">Valid on architectures</span></span>
 :--- | :--- | :---
<span data-ttu-id="134bf-156">FOLDERID_SystemX86</span><span class="sxs-lookup"><span data-stu-id="134bf-156">FOLDERID_SystemX86</span></span> | <span data-ttu-id="134bf-157">SystemX86</span><span class="sxs-lookup"><span data-stu-id="134bf-157">SystemX86</span></span> | <span data-ttu-id="134bf-158">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-158">x86, amd64</span></span>
<span data-ttu-id="134bf-159">FOLDERID_System</span><span class="sxs-lookup"><span data-stu-id="134bf-159">FOLDERID_System</span></span> | <span data-ttu-id="134bf-160">SystemX64</span><span class="sxs-lookup"><span data-stu-id="134bf-160">SystemX64</span></span> | <span data-ttu-id="134bf-161">amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-161">amd64</span></span>
<span data-ttu-id="134bf-162">FOLDERID_ProgramFilesX86</span><span class="sxs-lookup"><span data-stu-id="134bf-162">FOLDERID_ProgramFilesX86</span></span> | <span data-ttu-id="134bf-163">ProgramFilesX86</span><span class="sxs-lookup"><span data-stu-id="134bf-163">ProgramFilesX86</span></span> | <span data-ttu-id="134bf-164">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-164">x86, amd6</span></span>
<span data-ttu-id="134bf-165">FOLDERID_ProgramFilesX64</span><span class="sxs-lookup"><span data-stu-id="134bf-165">FOLDERID_ProgramFilesX64</span></span> | <span data-ttu-id="134bf-166">ProgramFilesX64</span><span class="sxs-lookup"><span data-stu-id="134bf-166">ProgramFilesX64</span></span> | <span data-ttu-id="134bf-167">amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-167">amd64</span></span>
<span data-ttu-id="134bf-168">FOLDERID_ProgramFilesCommonX86</span><span class="sxs-lookup"><span data-stu-id="134bf-168">FOLDERID_ProgramFilesCommonX86</span></span> | <span data-ttu-id="134bf-169">ProgramFilesCommonX86</span><span class="sxs-lookup"><span data-stu-id="134bf-169">ProgramFilesCommonX86</span></span> | <span data-ttu-id="134bf-170">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-170">x86, amd64</span></span>
<span data-ttu-id="134bf-171">FOLDERID_ProgramFilesCommonX64</span><span class="sxs-lookup"><span data-stu-id="134bf-171">FOLDERID_ProgramFilesCommonX64</span></span> | <span data-ttu-id="134bf-172">ProgramFilesCommonX64</span><span class="sxs-lookup"><span data-stu-id="134bf-172">ProgramFilesCommonX64</span></span> | <span data-ttu-id="134bf-173">amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-173">amd64</span></span>
<span data-ttu-id="134bf-174">FOLDERID_Windows</span><span class="sxs-lookup"><span data-stu-id="134bf-174">FOLDERID_Windows</span></span> | <span data-ttu-id="134bf-175">Windows</span><span class="sxs-lookup"><span data-stu-id="134bf-175">Windows</span></span> | <span data-ttu-id="134bf-176">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-176">x86, amd64</span></span>
<span data-ttu-id="134bf-177">FOLDERID_ProgramData</span><span class="sxs-lookup"><span data-stu-id="134bf-177">FOLDERID_ProgramData</span></span> | <span data-ttu-id="134bf-178">一般的な AppData</span><span class="sxs-lookup"><span data-stu-id="134bf-178">Common AppData</span></span> | <span data-ttu-id="134bf-179">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-179">x86, amd64</span></span>
<span data-ttu-id="134bf-180">FOLDERID_System\catroot</span><span class="sxs-lookup"><span data-stu-id="134bf-180">FOLDERID_System\catroot</span></span> | <span data-ttu-id="134bf-181">AppVSystem32Catroot</span><span class="sxs-lookup"><span data-stu-id="134bf-181">AppVSystem32Catroot</span></span> | <span data-ttu-id="134bf-182">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-182">x86, amd64</span></span>
<span data-ttu-id="134bf-183">FOLDERID_System\catroot2</span><span class="sxs-lookup"><span data-stu-id="134bf-183">FOLDERID_System\catroot2</span></span> | <span data-ttu-id="134bf-184">AppVSystem32Catroot2</span><span class="sxs-lookup"><span data-stu-id="134bf-184">AppVSystem32Catroot2</span></span> | <span data-ttu-id="134bf-185">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-185">x86, amd64</span></span>
<span data-ttu-id="134bf-186">FOLDERID_System\drivers\etc</span><span class="sxs-lookup"><span data-stu-id="134bf-186">FOLDERID_System\drivers\etc</span></span> | <span data-ttu-id="134bf-187">AppVSystem32DriversEtc</span><span class="sxs-lookup"><span data-stu-id="134bf-187">AppVSystem32DriversEtc</span></span> | <span data-ttu-id="134bf-188">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-188">x86, amd64</span></span>
<span data-ttu-id="134bf-189">FOLDERID_System\driverstore</span><span class="sxs-lookup"><span data-stu-id="134bf-189">FOLDERID_System\driverstore</span></span> | <span data-ttu-id="134bf-190">AppVSystem32Driverstore</span><span class="sxs-lookup"><span data-stu-id="134bf-190">AppVSystem32Driverstore</span></span> | <span data-ttu-id="134bf-191">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-191">x86, amd64</span></span>
<span data-ttu-id="134bf-192">FOLDERID_System\logfiles</span><span class="sxs-lookup"><span data-stu-id="134bf-192">FOLDERID_System\logfiles</span></span> | <span data-ttu-id="134bf-193">AppVSystem32Logfiles</span><span class="sxs-lookup"><span data-stu-id="134bf-193">AppVSystem32Logfiles</span></span> | <span data-ttu-id="134bf-194">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-194">x86, amd64</span></span>
<span data-ttu-id="134bf-195">FOLDERID_System\spool</span><span class="sxs-lookup"><span data-stu-id="134bf-195">FOLDERID_System\spool</span></span> | <span data-ttu-id="134bf-196">AppVSystem32Spool</span><span class="sxs-lookup"><span data-stu-id="134bf-196">AppVSystem32Spool</span></span> | <span data-ttu-id="134bf-197">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="134bf-197">x86, amd64</span></span>

## <a name="registry"></a><span data-ttu-id="134bf-198">レジストリ</span><span class="sxs-lookup"><span data-stu-id="134bf-198">Registry</span></span>

<span data-ttu-id="134bf-199">ブリッジでは、レジストリがファイル システムと同じように処理されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-199">The bridge handles the registry similarly to the file system.</span></span> <span data-ttu-id="134bf-200">アプリ パッケージには、registry.dat ファイルが含まれています。このファイルは、実際のレジストリ内の *HKLM\Software* に論理的に対応しています。</span><span class="sxs-lookup"><span data-stu-id="134bf-200">App packages contain a registry.dat file, which serves as the logical equivalent of *HKLM\Software* in the real registry.</span></span> <span data-ttu-id="134bf-201">実行時には、この仮想レジストリのハイブの内容がネイティブ システム ハイブにマージされ、両方が一括して表示されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-201">At runtime, this virtual registry merges the contents of this hive into the native system hive to provide a singular view of both.</span></span> <span data-ttu-id="134bf-202">たとえば、registry.dat に単一のキー "Foo" が含まれている場合、実行時に *HKLM\Software* を読み取ると、(すべてのネイティブ システム キーに加えて) "Foo" も含まれているように表示されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-202">For example, if registry.dat contains a single key "Foo", then a read of *HKLM\Software* at runtime will also appear to contain "Foo" (in addition to all the native system keys).</span></span>

<span data-ttu-id="134bf-203">パッケージに含まれる部分は *HKLM\Software* 以下のキーのみです。*HKCU* 以下のキーやレジストリの他の部分は、パッケージに含まれていません。</span><span class="sxs-lookup"><span data-stu-id="134bf-203">Only keys under *HKLM\Software* are part of the package; keys under *HKCU* or other parts of the registry are not.</span></span> <span data-ttu-id="134bf-204">パッケージ内のキーまたは値への書き込みは許可されていません。</span><span class="sxs-lookup"><span data-stu-id="134bf-204">Writes to keys or values in the package are not allowed.</span></span> <span data-ttu-id="134bf-205">パッケージに含まれないキーまたは値への書き込みは、ブリッジでは無視され、ユーザーに書き込み許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-205">Writes to keys or values not part of the package are ignored by the bridge and allowed as long as the user has permission.</span></span>

<span data-ttu-id="134bf-206">HKCU 以下の書き込みはすべて、書き込み時にユーザーごと、アプリごとのプライベートな場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-206">All writes under HKCU are copy-on-written to a private per-user, per-app location.</span></span> <span data-ttu-id="134bf-207">これにより、アンインストールのクリーンアップが、ブリッジによるファイル システムの処理と同じように行われるという利点があります。</span><span class="sxs-lookup"><span data-stu-id="134bf-207">This provides the same benefits as the bridge's handling of the file system with respect to uninstall cleanup.</span></span> <span data-ttu-id="134bf-208">従来、ログアウトしたユーザーのレジストリ データはマウント解除され使用できなくなるため、アンインストーラーが *HKEY_CURRENT_USER* をクリーンアップできませんでした。</span><span class="sxs-lookup"><span data-stu-id="134bf-208">Traditionally, uninstallers are unable to clean *HKEY_CURRENT_USER* because the registry data for logged out users is unmounted and unavailable.</span></span>

<span data-ttu-id="134bf-209">書き込みはすべて、パッケージのアップグレード中には保持され、アプリが完全に削除された場合にのみ削除されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-209">All writes are kept during package upgrade and only deleted when the app is removed entirely.</span></span>

### <a name="common-operations"></a><span data-ttu-id="134bf-210">一般的な操作</span><span class="sxs-lookup"><span data-stu-id="134bf-210">Common operations</span></span>

<span data-ttu-id="134bf-211">一般的なレジストリ操作とブリッジでの処理方法を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="134bf-211">This short reference table shows common registry operations and how the bridge handles them.</span></span>

<span data-ttu-id="134bf-212">操作</span><span class="sxs-lookup"><span data-stu-id="134bf-212">Operation</span></span> | <span data-ttu-id="134bf-213">結果</span><span class="sxs-lookup"><span data-stu-id="134bf-213">Result</span></span> | <span data-ttu-id="134bf-214">例</span><span class="sxs-lookup"><span data-stu-id="134bf-214">Example</span></span>
:--- | :--- | :---
<span data-ttu-id="134bf-215">*HKLM\Software* に対する読み取りまたは列挙</span><span class="sxs-lookup"><span data-stu-id="134bf-215">Read or enumerate *HKLM\Software*</span></span> | <span data-ttu-id="134bf-216">パッケージのハイブがローカル システムの対応部分に動的にマージされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-216">A dynamic merge of the package hive with the local system counterpart.</span></span> | <span data-ttu-id="134bf-217">registry.dat に単一のキー "Foo" が含まれている場合、実行時に *HKLM\Software* を読み取ると、*HKLM\Software* と *HKLM\Software\Foo* の内容がどちらも表示されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-217">If registry.dat contains a single key "Foo," at runtime a read of *HKLM\Software* will show the contents of both *HKLM\Software* plus *HKLM\Software\Foo*.</span></span>
<span data-ttu-id="134bf-218">HKCU 以下の書き込み</span><span class="sxs-lookup"><span data-stu-id="134bf-218">Writes under HKCU</span></span> | <span data-ttu-id="134bf-219">書き込み時に、ユーザーごと、アプリごとのプライベートな場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="134bf-219">Copy-on-written to a per-user, per-app private location.</span></span> | <span data-ttu-id="134bf-220">ファイルの AppData と同じです。</span><span class="sxs-lookup"><span data-stu-id="134bf-220">The same as AppData for files.</span></span>
<span data-ttu-id="134bf-221">パッケージ内の書き込み</span><span class="sxs-lookup"><span data-stu-id="134bf-221">Writes inside the package.</span></span> | <span data-ttu-id="134bf-222">許可されていません。</span><span class="sxs-lookup"><span data-stu-id="134bf-222">Not allowed.</span></span> <span data-ttu-id="134bf-223">パッケージは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="134bf-223">The package is read-only.</span></span> | <span data-ttu-id="134bf-224">対応するキー/値がパッケージ ハイブに存在する場合、*HKLM\Software* 以下の書き込みは許可されません。</span><span class="sxs-lookup"><span data-stu-id="134bf-224">Writes under *HKLM\Software* are not allowed if a corresponding key/value exist in the package hive.</span></span>
<span data-ttu-id="134bf-225">パッケージ外の書き込み</span><span class="sxs-lookup"><span data-stu-id="134bf-225">Writes outside the package</span></span> | <span data-ttu-id="134bf-226">ブリッジでは無視されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-226">Ignored by the bridge.</span></span> <span data-ttu-id="134bf-227">ユーザーにアクセス許可があれば、許可されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-227">Allowed if the user has permissions.</span></span> | <span data-ttu-id="134bf-228">*HKLM\Software* 以下の書き込みは、対応するキー/値がパッケージに含まれておらずユーザーに適切なアクセス許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-228">Writes under *HKLM\Software* are allowed as long as a corresponding key/value does not exist in the package hive and the user has the correct access permissions.</span></span>

## <a name="uninstallation"></a><span data-ttu-id="134bf-229">アンインストール</span><span class="sxs-lookup"><span data-stu-id="134bf-229">Uninstallation</span></span>

<span data-ttu-id="134bf-230">パッケージがユーザーによってアンインストールされると、*C:\Program Files\WindowsApps\package_name* 以下にあるすべてのファイルとフォルダーが削除されます。また、AppData またはレジストリにリダイレクトされ、ブリッジによってキャプチャされた書き込みも削除されます。</span><span class="sxs-lookup"><span data-stu-id="134bf-230">When a package is uninstalled by the user, all files and folders located under *C:\Program Files\WindowsApps\package_name* are removed, as well as any redirected writes to AppData or the registry that were captured by the bridge.</span></span>

## <a name="next-steps"></a><span data-ttu-id="134bf-231">次のステップ</span><span class="sxs-lookup"><span data-stu-id="134bf-231">Next steps</span></span>

**<span data-ttu-id="134bf-232">特定の質問に対する回答を見つける</span><span class="sxs-lookup"><span data-stu-id="134bf-232">Find answers to specific questions</span></span>**

<span data-ttu-id="134bf-233">マイクロソフトのチームでは、[StackOverflow タグ](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge)をチェックしています。</span><span class="sxs-lookup"><span data-stu-id="134bf-233">Our team monitors these [StackOverflow tags](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge).</span></span>

**<span data-ttu-id="134bf-234">この記事に関するフィードバックを送信する</span><span class="sxs-lookup"><span data-stu-id="134bf-234">Give feedback about this article</span></span>**

<span data-ttu-id="134bf-235">下のコメント セクションをご利用ください。</span><span class="sxs-lookup"><span data-stu-id="134bf-235">Use the comments section below.</span></span>
