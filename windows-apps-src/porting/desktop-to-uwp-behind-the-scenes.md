---
author: normesta
Description: This article provides a deeper dive on how the Desktop Bridge works under the covers.
title: Desktop Bridge の内側
ms.author: normesta
ms.date: 05/25/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP
ms.assetid: a399fae9-122c-46c4-a1dc-a1a241e5547a
ms.localizationpriority: medium
ms.openlocfilehash: 4e6cd2b305a9d52a2239be46cc7f77650cdd6531
ms.sourcegitcommit: c4d3115348c8b54fcc92aae8e18fdabc3deb301d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/22/2018
ms.locfileid: "5407190"
---
# <a name="behind-the-scenes-of-your-packaged-desktop-application"></a><span data-ttu-id="f5571-103">パッケージ デスクトップ アプリケーションの内側</span><span class="sxs-lookup"><span data-stu-id="f5571-103">Behind the scenes of your packaged desktop application</span></span>

<span data-ttu-id="f5571-104">この記事では、デスクトップ アプリケーションの Windows アプリ パッケージを作成するときのファイルとレジストリ エントリを動作で、について詳しく説明を提供します。</span><span class="sxs-lookup"><span data-stu-id="f5571-104">This article provides a deeper dive on what happens to files and registry entries when you create a Windows app package for your desktop application.</span></span>

<span data-ttu-id="f5571-105">他のアプリとの互換性を維持しながら可能な限り多くのシステムの状態からアプリケーションの状態を分離する、最新のパッケージの主な目標ことです。</span><span class="sxs-lookup"><span data-stu-id="f5571-105">A key goal of a modern package is to separate application state from system state as much as possible while maintaining compatibility with other apps.</span></span> <span data-ttu-id="f5571-106">ブリッジではこれを行うために、アプリケーションをユニバーサル Windows プラットフォーム (UWP) パッケージ内に配置し、実行時にファイル システムとレジストリに行われる変更を検出して、一部の変更のリダイレクトを行います。</span><span class="sxs-lookup"><span data-stu-id="f5571-106">The bridge accomplishes this by placing the application inside a Universal Windows Platform (UWP) package, and then detecting and redirecting some changes  it makes to the file system and registry at runtime.</span></span>

<span data-ttu-id="f5571-107">デスクトップ アプリケーション用に作成されたパッケージは、完全信頼できるデスクトップ専用アプリケーションし、仮想化やサンド ボックス化されていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-107">Packages that you create for your desktop application are desktop-only, full-trust applications and are not virtualized or sandboxed.</span></span> <span data-ttu-id="f5571-108">このため、従来のデスクトップ アプリケーションと同じように、他のアプリとやり取りすることが可能です。</span><span class="sxs-lookup"><span data-stu-id="f5571-108">This allows them to interact with other apps the same way classic desktop applications do.</span></span>

## <a name="installation"></a><span data-ttu-id="f5571-109">インストール</span><span class="sxs-lookup"><span data-stu-id="f5571-109">Installation</span></span>

<span data-ttu-id="f5571-110">アプリ パッケージは *C:\Program Files\WindowsApps\package_name* にインストールされ、実行可能プログラム名は *app_name.exe* になります。</span><span class="sxs-lookup"><span data-stu-id="f5571-110">App packages are installed under *C:\Program Files\WindowsApps\package_name*, with the executable titled *app_name.exe*.</span></span> <span data-ttu-id="f5571-111">各パッケージ フォルダーには、パッケージ アプリ用の XML 名前空間を含むマニフェスト (AppxManifest.xml という名前) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5571-111">Each package folder contains a manifest (named AppxManifest.xml) that contains a special XML namespace for packaged apps.</span></span> <span data-ttu-id="f5571-112">マニフェスト ファイル内の ```<EntryPoint>``` 要素で、完全信頼アプリを参照します。</span><span class="sxs-lookup"><span data-stu-id="f5571-112">Inside that manifest file is an ```<EntryPoint>``` element, which references the full-trust app.</span></span> <span data-ttu-id="f5571-113">そのアプリケーションを起動すると、アプリ コンテナー内では実行されず、代わりに、ユーザーとして実行されるが通常します。</span><span class="sxs-lookup"><span data-stu-id="f5571-113">When that application is launched, it does not run inside an app container, but instead it runs as the user as it normally would.</span></span>

<span data-ttu-id="f5571-114">展開後、パッケージ ファイルは読み取り専用としてマークされ、オペレーティング システムによって厳重にロックダウンされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-114">After deployment, package files are marked read-only and heavily locked down by the operating system.</span></span> <span data-ttu-id="f5571-115">これらのファイルが改ざんされると、Windows によりアプリの起動が回避されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-115">Windows prevents apps from launching if these files are tampered with.</span></span>

## <a name="file-system"></a><span data-ttu-id="f5571-116">ファイル システム</span><span class="sxs-lookup"><span data-stu-id="f5571-116">File system</span></span>

<span data-ttu-id="f5571-117">アプリの状態を含めるためには、アプリケーションによる AppData への変更がキャプチャされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-117">In order to contain app state, changes that the application makes to AppData are captured.</span></span> <span data-ttu-id="f5571-118">作成、削除、更新など、ユーザーの AppData フォルダー (例: *C:\Users\user_name\AppData*) に対する書き込みはすべて、書き込み時にユーザーごと、アプリごとのプライベートな場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-118">All write to the user's AppData folder (e.g., *C:\Users\user_name\AppData*), including create, delete, and update, are copied on write to a private per-user, per-app location.</span></span> <span data-ttu-id="f5571-119">これは、実際にはプライベート コピーを変更するときに、パッケージ化されたアプリケーションが、AppData を編集、奥行きを作成します。</span><span class="sxs-lookup"><span data-stu-id="f5571-119">This creates the illusion that the packaged application is editing the real AppData when it is actually modifying a private copy.</span></span> <span data-ttu-id="f5571-120">このように書き込みのリダイレクトを行うことで、アプリによって行われたすべてのファイル変更をシステムで追跡できます。</span><span class="sxs-lookup"><span data-stu-id="f5571-120">By redirecting writes this way, the system can track all file modifications made by the app.</span></span> <span data-ttu-id="f5571-121">これにより、アプリケーションがアンインストールされると、それらのファイルをクリーンアップするシステムで、したがってシステム「劣化」を削減しより優れたアプリケーションの削除を提供する、ユーザー操作します。</span><span class="sxs-lookup"><span data-stu-id="f5571-121">This allows the system to clean up those files when the application is uninstalled, thus reducing system "rot" and providing a better application removal experience for the user.</span></span>

<span data-ttu-id="f5571-122">AppData のリダイレクトに加えて Windows の既知のフォルダー (System32、Program Files (x86) など) は、アプリ パッケージ内の対応するディレクトリに動的にマージされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-122">In addition to redirecting AppData, Windows' well-known folders (System32, Program Files (x86), etc) are dynamically merged with corresponding directories in the app package.</span></span> <span data-ttu-id="f5571-123">それぞれのパッケージのルート ディレクトリには、"VFS" という名前のフォルダーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f5571-123">Each package contains a folder named "VFS" at its root.</span></span> <span data-ttu-id="f5571-124">この VFS ディレクトリ内のディレクトリまたはファイルに対する読み取り操作は、実行時にそれぞれ対応するネイティブ部分にマージされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-124">Any reads of directories or files in the VFS directory are merged at runtime with their respective native counterparts.</span></span> <span data-ttu-id="f5571-125">たとえば、アプリケーションは、アプリ パッケージの一部として*C:\Program Files\WindowsApps\package_name\VFS\SystemX86\vc10.dll*を含めることができますが、ファイル*C:\Windows\System32\vc10.dll*でインストールされるように表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-125">For example, an application could contain *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\vc10.dll* as part of its app package, but the file would appear to be installed at *C:\Windows\System32\vc10.dll*.</span></span>  <span data-ttu-id="f5571-126">これにより、ファイルがパッケージ外の場所にあることを想定しているデスクトップ アプリケーションとの互換性が維持されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-126">This maintains compatibility with desktop applications that may expect files to live in non-package locations.</span></span>

<span data-ttu-id="f5571-127">アプリ パッケージ内のファイルまたはフォルダーへの書き込みは、許可されていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-127">Writes to files/folders in the app package are not allowed.</span></span> <span data-ttu-id="f5571-128">パッケージに含まれないファイルやフォルダーへの書き込みは、ブリッジでは無視され、ユーザーにアクセス許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-128">Writes to files and folders that are not part of the package are ignored by the bridge and are allowed as long as the user has permission.</span></span>

### <a name="common-operations"></a><span data-ttu-id="f5571-129">一般的な操作</span><span class="sxs-lookup"><span data-stu-id="f5571-129">Common operations</span></span>

<span data-ttu-id="f5571-130">一般的なファイル システム操作とブリッジでの処理方法を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="f5571-130">This short reference table shows common file system operations and how the bridge handles them.</span></span>

<span data-ttu-id="f5571-131">操作</span><span class="sxs-lookup"><span data-stu-id="f5571-131">Operation</span></span> | <span data-ttu-id="f5571-132">結果</span><span class="sxs-lookup"><span data-stu-id="f5571-132">Result</span></span> | <span data-ttu-id="f5571-133">例</span><span class="sxs-lookup"><span data-stu-id="f5571-133">Example</span></span>
:--- | :--- | :---
<span data-ttu-id="f5571-134">既知の Windows ファイルまたはフォルダーに対する読み取りまたは列挙</span><span class="sxs-lookup"><span data-stu-id="f5571-134">Read or enumerate a well-known Windows file or folder</span></span> | <span data-ttu-id="f5571-135">*C:\Program Files\package_name\VFS\well_known_folder* がローカル システムの対応部分に動的にマージされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-135">A dynamic merge of *C:\Program Files\package_name\VFS\well_known_folder* with the local system counterpart.</span></span> | <span data-ttu-id="f5571-136">*C:\Windows\System32* の読み取りでは、*C:\Windows\System32* の内容と *C:\Program Files\WindowsApps\package_name\VFS\SystemX86* の内容が返されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-136">Reading *C:\Windows\System32* returns the contents of *C:\Windows\System32* plus the contents of *C:\Program Files\WindowsApps\package_name\VFS\SystemX86*.</span></span>
<span data-ttu-id="f5571-137">AppData 内の書き込み</span><span class="sxs-lookup"><span data-stu-id="f5571-137">Write under AppData</span></span> | <span data-ttu-id="f5571-138">書き込み時に、ユーザーごと、アプリごとの場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-138">Copy-on-written to a per-user, per-app location.</span></span> | <span data-ttu-id="f5571-139">AppData は通常、*C:\Users\user_name\AppData* です。</span><span class="sxs-lookup"><span data-stu-id="f5571-139">AppData is typically *C:\Users\user_name\AppData*.</span></span>  
<span data-ttu-id="f5571-140">パッケージ内の書き込み</span><span class="sxs-lookup"><span data-stu-id="f5571-140">Write inside the package</span></span> | <span data-ttu-id="f5571-141">許可されていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-141">Not allowed.</span></span> <span data-ttu-id="f5571-142">パッケージは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="f5571-142">The package is read-only.</span></span> | <span data-ttu-id="f5571-143">*C:\Program Files\WindowsApps\package_name* 内の書き込みは、許可されていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-143">Writes under *C:\Program Files\WindowsApps\package_name* are not allowed.</span></span>
<span data-ttu-id="f5571-144">パッケージ外の書き込み</span><span class="sxs-lookup"><span data-stu-id="f5571-144">Writes outside the package</span></span> | <span data-ttu-id="f5571-145">ユーザーにアクセス許可があれば、許可されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-145">Allowed if the user has permissions.</span></span> | <span data-ttu-id="f5571-146">*C:\Windows\System32\foo.dll* への書き込みは、パッケージに *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\foo.dll* が含まれておらずユーザーにアクセス許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-146">A write to *C:\Windows\System32\foo.dll* is allowed if the package does not contain *C:\Program Files\WindowsApps\package_name\VFS\SystemX86\foo.dll* and the user has permissions.</span></span>

### <a name="packaged-vfs-locations"></a><span data-ttu-id="f5571-147">パッケージ化された VFS の場所</span><span class="sxs-lookup"><span data-stu-id="f5571-147">Packaged VFS locations</span></span>

<span data-ttu-id="f5571-148">次の表は、パッケージの一部として含まれるファイルが、システム上でアプリのためにどのように配置されるかを示しています。</span><span class="sxs-lookup"><span data-stu-id="f5571-148">The following table shows where files shipping as part of your package are overlaid on the system for the app.</span></span> <span data-ttu-id="f5571-149">これらのファイル内にある一覧表示されているシステムの場所、 *C:\Program \windowsapps\package_name\vfs*内のリダイレクトされた場所に実際には、アプリケーションと感じます。</span><span class="sxs-lookup"><span data-stu-id="f5571-149">Your application will perceive these files to be in the listed system locations, when in fact they are in the redirected locations inside *C:\Program Files\WindowsApps\package_name\VFS*.</span></span> <span data-ttu-id="f5571-150">FOLDERID の場所は [**KNOWNFOLDERID**](https://msdn.microsoft.com/library/windows/desktop/dd378457.aspx) 定数で示されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-150">The FOLDERID locations are from the [**KNOWNFOLDERID**](https://msdn.microsoft.com/library/windows/desktop/dd378457.aspx) constants.</span></span>

<span data-ttu-id="f5571-151">システムの場所</span><span class="sxs-lookup"><span data-stu-id="f5571-151">System Location</span></span> | <span data-ttu-id="f5571-152">リダイレクトされた場所 ([PackageRoot]\VFS\ の下)</span><span class="sxs-lookup"><span data-stu-id="f5571-152">Redirected Location (Under [PackageRoot]\VFS\)</span></span> | <span data-ttu-id="f5571-153">有効なアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="f5571-153">Valid on architectures</span></span>
 :--- | :--- | :---
<span data-ttu-id="f5571-154">FOLDERID_SystemX86</span><span class="sxs-lookup"><span data-stu-id="f5571-154">FOLDERID_SystemX86</span></span> | <span data-ttu-id="f5571-155">SystemX86</span><span class="sxs-lookup"><span data-stu-id="f5571-155">SystemX86</span></span> | <span data-ttu-id="f5571-156">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-156">x86, amd64</span></span>
<span data-ttu-id="f5571-157">FOLDERID_System</span><span class="sxs-lookup"><span data-stu-id="f5571-157">FOLDERID_System</span></span> | <span data-ttu-id="f5571-158">SystemX64</span><span class="sxs-lookup"><span data-stu-id="f5571-158">SystemX64</span></span> | <span data-ttu-id="f5571-159">amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-159">amd64</span></span>
<span data-ttu-id="f5571-160">FOLDERID_ProgramFilesX86</span><span class="sxs-lookup"><span data-stu-id="f5571-160">FOLDERID_ProgramFilesX86</span></span> | <span data-ttu-id="f5571-161">ProgramFilesX86</span><span class="sxs-lookup"><span data-stu-id="f5571-161">ProgramFilesX86</span></span> | <span data-ttu-id="f5571-162">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-162">x86, amd6</span></span>
<span data-ttu-id="f5571-163">FOLDERID_ProgramFilesX64</span><span class="sxs-lookup"><span data-stu-id="f5571-163">FOLDERID_ProgramFilesX64</span></span> | <span data-ttu-id="f5571-164">ProgramFilesX64</span><span class="sxs-lookup"><span data-stu-id="f5571-164">ProgramFilesX64</span></span> | <span data-ttu-id="f5571-165">amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-165">amd64</span></span>
<span data-ttu-id="f5571-166">FOLDERID_ProgramFilesCommonX86</span><span class="sxs-lookup"><span data-stu-id="f5571-166">FOLDERID_ProgramFilesCommonX86</span></span> | <span data-ttu-id="f5571-167">ProgramFilesCommonX86</span><span class="sxs-lookup"><span data-stu-id="f5571-167">ProgramFilesCommonX86</span></span> | <span data-ttu-id="f5571-168">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-168">x86, amd64</span></span>
<span data-ttu-id="f5571-169">FOLDERID_ProgramFilesCommonX64</span><span class="sxs-lookup"><span data-stu-id="f5571-169">FOLDERID_ProgramFilesCommonX64</span></span> | <span data-ttu-id="f5571-170">ProgramFilesCommonX64</span><span class="sxs-lookup"><span data-stu-id="f5571-170">ProgramFilesCommonX64</span></span> | <span data-ttu-id="f5571-171">amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-171">amd64</span></span>
<span data-ttu-id="f5571-172">FOLDERID_Windows</span><span class="sxs-lookup"><span data-stu-id="f5571-172">FOLDERID_Windows</span></span> | <span data-ttu-id="f5571-173">Windows</span><span class="sxs-lookup"><span data-stu-id="f5571-173">Windows</span></span> | <span data-ttu-id="f5571-174">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-174">x86, amd64</span></span>
<span data-ttu-id="f5571-175">FOLDERID_ProgramData</span><span class="sxs-lookup"><span data-stu-id="f5571-175">FOLDERID_ProgramData</span></span> | <span data-ttu-id="f5571-176">一般的な AppData</span><span class="sxs-lookup"><span data-stu-id="f5571-176">Common AppData</span></span> | <span data-ttu-id="f5571-177">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-177">x86, amd64</span></span>
<span data-ttu-id="f5571-178">FOLDERID_System\catroot</span><span class="sxs-lookup"><span data-stu-id="f5571-178">FOLDERID_System\catroot</span></span> | <span data-ttu-id="f5571-179">AppVSystem32Catroot</span><span class="sxs-lookup"><span data-stu-id="f5571-179">AppVSystem32Catroot</span></span> | <span data-ttu-id="f5571-180">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-180">x86, amd64</span></span>
<span data-ttu-id="f5571-181">FOLDERID_System\catroot2</span><span class="sxs-lookup"><span data-stu-id="f5571-181">FOLDERID_System\catroot2</span></span> | <span data-ttu-id="f5571-182">AppVSystem32Catroot2</span><span class="sxs-lookup"><span data-stu-id="f5571-182">AppVSystem32Catroot2</span></span> | <span data-ttu-id="f5571-183">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-183">x86, amd64</span></span>
<span data-ttu-id="f5571-184">FOLDERID_System\drivers\etc</span><span class="sxs-lookup"><span data-stu-id="f5571-184">FOLDERID_System\drivers\etc</span></span> | <span data-ttu-id="f5571-185">AppVSystem32DriversEtc</span><span class="sxs-lookup"><span data-stu-id="f5571-185">AppVSystem32DriversEtc</span></span> | <span data-ttu-id="f5571-186">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-186">x86, amd64</span></span>
<span data-ttu-id="f5571-187">FOLDERID_System\driverstore</span><span class="sxs-lookup"><span data-stu-id="f5571-187">FOLDERID_System\driverstore</span></span> | <span data-ttu-id="f5571-188">AppVSystem32Driverstore</span><span class="sxs-lookup"><span data-stu-id="f5571-188">AppVSystem32Driverstore</span></span> | <span data-ttu-id="f5571-189">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-189">x86, amd64</span></span>
<span data-ttu-id="f5571-190">FOLDERID_System\logfiles</span><span class="sxs-lookup"><span data-stu-id="f5571-190">FOLDERID_System\logfiles</span></span> | <span data-ttu-id="f5571-191">AppVSystem32Logfiles</span><span class="sxs-lookup"><span data-stu-id="f5571-191">AppVSystem32Logfiles</span></span> | <span data-ttu-id="f5571-192">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-192">x86, amd64</span></span>
<span data-ttu-id="f5571-193">FOLDERID_System\spool</span><span class="sxs-lookup"><span data-stu-id="f5571-193">FOLDERID_System\spool</span></span> | <span data-ttu-id="f5571-194">AppVSystem32Spool</span><span class="sxs-lookup"><span data-stu-id="f5571-194">AppVSystem32Spool</span></span> | <span data-ttu-id="f5571-195">x86、amd64</span><span class="sxs-lookup"><span data-stu-id="f5571-195">x86, amd64</span></span>

## <a name="registry"></a><span data-ttu-id="f5571-196">レジストリ</span><span class="sxs-lookup"><span data-stu-id="f5571-196">Registry</span></span>

<span data-ttu-id="f5571-197">アプリ パッケージには、registry.dat ファイルが含まれています。このファイルは、実際のレジストリ内の *HKLM\Software* に論理的に対応しています。</span><span class="sxs-lookup"><span data-stu-id="f5571-197">App packages contain a registry.dat file, which serves as the logical equivalent of *HKLM\Software* in the real registry.</span></span> <span data-ttu-id="f5571-198">実行時には、この仮想レジストリのハイブの内容がネイティブ システム ハイブにマージされ、両方が一括して表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-198">At runtime, this virtual registry merges the contents of this hive into the native system hive to provide a singular view of both.</span></span> <span data-ttu-id="f5571-199">たとえば、registry.dat に単一のキー "Foo" が含まれている場合、実行時に *HKLM\Software* を読み取ると、(すべてのネイティブ システム キーに加えて) "Foo" も含まれているように表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-199">For example, if registry.dat contains a single key "Foo", then a read of *HKLM\Software* at runtime will also appear to contain "Foo" (in addition to all the native system keys).</span></span>

<span data-ttu-id="f5571-200">パッケージに含まれる部分は *HKLM\Software* 以下のキーのみです。*HKCU* 以下のキーやレジストリの他の部分は、パッケージに含まれていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-200">Only keys under *HKLM\Software* are part of the package; keys under *HKCU* or other parts of the registry are not.</span></span> <span data-ttu-id="f5571-201">パッケージ内のキーまたは値への書き込みは許可されていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-201">Writes to keys or values in the package are not allowed.</span></span> <span data-ttu-id="f5571-202">書き込むキーまたは値へユーザー権限を持っている限り、パッケージの一部を許可します。</span><span class="sxs-lookup"><span data-stu-id="f5571-202">Writes to keys or values not part of the package are allowed as long as the user has permission.</span></span>

<span data-ttu-id="f5571-203">HKCU 以下の書き込みはすべて、書き込み時にユーザーごと、アプリごとのプライベートな場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-203">All writes under HKCU are copy-on-written to a private per-user, per-app location.</span></span> <span data-ttu-id="f5571-204">従来、ログアウトしたユーザーのレジストリ データはマウント解除され使用できなくなるため、アンインストーラーが *HKEY_CURRENT_USER* をクリーンアップできませんでした。</span><span class="sxs-lookup"><span data-stu-id="f5571-204">Traditionally, uninstallers are unable to clean *HKEY_CURRENT_USER* because the registry data for logged out users is unmounted and unavailable.</span></span>

<span data-ttu-id="f5571-205">すべての書き込みはパッケージのアップグレード中に保持し、アプリケーションが完全に削除するときにのみ削除します。</span><span class="sxs-lookup"><span data-stu-id="f5571-205">All writes are kept during package upgrade and only deleted when the application is removed entirely.</span></span>

### <a name="common-operations"></a><span data-ttu-id="f5571-206">一般的な操作</span><span class="sxs-lookup"><span data-stu-id="f5571-206">Common operations</span></span>

<span data-ttu-id="f5571-207">一般的なレジストリ操作とブリッジでの処理方法を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="f5571-207">This short reference table shows common registry operations and how the bridge handles them.</span></span>

<span data-ttu-id="f5571-208">操作</span><span class="sxs-lookup"><span data-stu-id="f5571-208">Operation</span></span> | <span data-ttu-id="f5571-209">結果</span><span class="sxs-lookup"><span data-stu-id="f5571-209">Result</span></span> | <span data-ttu-id="f5571-210">例</span><span class="sxs-lookup"><span data-stu-id="f5571-210">Example</span></span>
:--- | :--- | :---
<span data-ttu-id="f5571-211">*HKLM\Software* に対する読み取りまたは列挙</span><span class="sxs-lookup"><span data-stu-id="f5571-211">Read or enumerate *HKLM\Software*</span></span> | <span data-ttu-id="f5571-212">パッケージのハイブがローカル システムの対応部分に動的にマージされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-212">A dynamic merge of the package hive with the local system counterpart.</span></span> | <span data-ttu-id="f5571-213">registry.dat に単一のキー "Foo" が含まれている場合、実行時に *HKLM\Software* を読み取ると、*HKLM\Software* と *HKLM\Software\Foo* の内容がどちらも表示されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-213">If registry.dat contains a single key "Foo," at runtime a read of *HKLM\Software* will show the contents of both *HKLM\Software* plus *HKLM\Software\Foo*.</span></span>
<span data-ttu-id="f5571-214">HKCU 以下の書き込み</span><span class="sxs-lookup"><span data-stu-id="f5571-214">Writes under HKCU</span></span> | <span data-ttu-id="f5571-215">書き込み時に、ユーザーごと、アプリごとのプライベートな場所にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="f5571-215">Copy-on-written to a per-user, per-app private location.</span></span> | <span data-ttu-id="f5571-216">ファイルの AppData と同じです。</span><span class="sxs-lookup"><span data-stu-id="f5571-216">The same as AppData for files.</span></span>
<span data-ttu-id="f5571-217">パッケージ内の書き込み</span><span class="sxs-lookup"><span data-stu-id="f5571-217">Writes inside the package.</span></span> | <span data-ttu-id="f5571-218">許可されていません。</span><span class="sxs-lookup"><span data-stu-id="f5571-218">Not allowed.</span></span> <span data-ttu-id="f5571-219">パッケージは読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="f5571-219">The package is read-only.</span></span> | <span data-ttu-id="f5571-220">対応するキー/値がパッケージ ハイブに存在する場合、*HKLM\Software* 以下の書き込みは許可されません。</span><span class="sxs-lookup"><span data-stu-id="f5571-220">Writes under *HKLM\Software* are not allowed if a corresponding key/value exist in the package hive.</span></span>
<span data-ttu-id="f5571-221">パッケージ外の書き込み</span><span class="sxs-lookup"><span data-stu-id="f5571-221">Writes outside the package</span></span> | <span data-ttu-id="f5571-222">ブリッジでは無視されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-222">Ignored by the bridge.</span></span> <span data-ttu-id="f5571-223">ユーザーにアクセス許可があれば、許可されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-223">Allowed if the user has permissions.</span></span> | <span data-ttu-id="f5571-224">*HKLM\Software* 以下の書き込みは、対応するキー/値がパッケージに含まれておらずユーザーに適切なアクセス許可があれば許可されます。</span><span class="sxs-lookup"><span data-stu-id="f5571-224">Writes under *HKLM\Software* are allowed as long as a corresponding key/value does not exist in the package hive and the user has the correct access permissions.</span></span>

## <a name="uninstallation"></a><span data-ttu-id="f5571-225">アンインストール</span><span class="sxs-lookup"><span data-stu-id="f5571-225">Uninstallation</span></span>

<span data-ttu-id="f5571-226">ユーザーによってパッケージがアンインストールされると、ファイルとフォルダー *C:\Program \windowsapps\package_name*の下にあるすべて削除されます。 パッケージ化プロセス中にキャプチャされた AppData またはレジストリにリダイレクトされた書き込みも。</span><span class="sxs-lookup"><span data-stu-id="f5571-226">When a package is uninstalled by the user, all files and folders located under *C:\Program Files\WindowsApps\package_name* are removed, as well as any redirected writes to AppData or the registry that were captured during the packaging process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f5571-227">次のステップ</span><span class="sxs-lookup"><span data-stu-id="f5571-227">Next steps</span></span>

**<span data-ttu-id="f5571-228">質問に対する回答を見つける</span><span class="sxs-lookup"><span data-stu-id="f5571-228">Find answers to your questions</span></span>**

<span data-ttu-id="f5571-229">ご質問がある場合は、</span><span class="sxs-lookup"><span data-stu-id="f5571-229">Have questions?</span></span> <span data-ttu-id="f5571-230">Stack Overflow でお問い合わせください。</span><span class="sxs-lookup"><span data-stu-id="f5571-230">Ask us on Stack Overflow.</span></span> <span data-ttu-id="f5571-231">Microsoft のチームでは、これらの[タグ](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge)をチェックしています。</span><span class="sxs-lookup"><span data-stu-id="f5571-231">Our team monitors these [tags](http://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge).</span></span> <span data-ttu-id="f5571-232">[こちら](https://social.msdn.microsoft.com/Forums/en-US/home?filter=alltypes&sort=relevancedesc&searchTerm=%5BDesktop%20Converter%5D)から質問することもできます。</span><span class="sxs-lookup"><span data-stu-id="f5571-232">You can also ask us [here](https://social.msdn.microsoft.com/Forums/en-US/home?filter=alltypes&sort=relevancedesc&searchTerm=%5BDesktop%20Converter%5D).</span></span>

**<span data-ttu-id="f5571-233">フィードバックの提供または機能の提案を行う</span><span class="sxs-lookup"><span data-stu-id="f5571-233">Give feedback or make feature suggestions</span></span>**

<span data-ttu-id="f5571-234">[UserVoice](https://wpdev.uservoice.com/forums/110705-universal-windows-platform/category/161895-desktop-bridge-centennial) のページをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f5571-234">See [UserVoice](https://wpdev.uservoice.com/forums/110705-universal-windows-platform/category/161895-desktop-bridge-centennial).</span></span>
