---
title: x86 デスクトップ アプリのトラブルシューティング
description: ARM で実行する際の x86 アプリの一般的な問題とその解決方法。
ms.author: misatran
ms.date: 02/15/2018
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: windows 10 s, 常時接続, ARM での x86 エミュレーション, トラブルシューティング
ms.localizationpriority: medium
ms.openlocfilehash: 55737790db00adb3104d12ae44df0ea07679d699
ms.sourcegitcommit: 14c37e23b8966468e8c28a3b34d21aaa4e6b571b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/23/2018
ms.locfileid: "1614208"
---
# <a name="troubleshooting-x86-desktop-apps"></a><span data-ttu-id="bdfa4-104">x86 デスクトップ アプリのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="bdfa4-104">Troubleshooting x86 desktop apps</span></span>
<span data-ttu-id="bdfa4-105">x86 デスクトップ アプリが x86 コンピューターで実行したときのように動作しない場合、トラブルシューティングに役立つガイダンスを次に示します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-105">If an x86 desktop app doesn't work the way it does on an x86 machine, here's some guidance to help you troubleshoot.</span></span>

|<span data-ttu-id="bdfa4-106">問題</span><span class="sxs-lookup"><span data-stu-id="bdfa4-106">Issue</span></span>|<span data-ttu-id="bdfa4-107">解決策</span><span class="sxs-lookup"><span data-stu-id="bdfa4-107">Solution</span></span>|
|-----|--------|
| <span data-ttu-id="bdfa4-108">アプリが ARM 用に設計されていないドライバーに依存している。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-108">Your app relies on a driver that isn't designed for ARM.</span></span> | <span data-ttu-id="bdfa4-109">x86 ドライバーを ARM64 に再コンパイルします。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-109">Recompile your x86 driver to ARM64.</span></span> <span data-ttu-id="bdfa4-110">「[WDK を使った ARM64 ドライバーのビルド](https://docs.microsoft.com/en-us/windows-hardware/drivers/develop/building-arm64-drivers)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-110">See [Building ARM64 Drivers with the WDK](https://docs.microsoft.com/en-us/windows-hardware/drivers/develop/building-arm64-drivers).</span></span> |
| <span data-ttu-id="bdfa4-111">アプリが x64 でしか使用できない。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-111">Your app is available only for x64.</span></span> | <span data-ttu-id="bdfa4-112">Microsoft Store 向けに開発する場合、ARM バージョンのアプリを提出します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-112">If you develop for Microsoft Store, submit an ARM version of your app.</span></span> <span data-ttu-id="bdfa4-113">詳しくは、「[アプリ パッケージのアーキテクチャ](../packaging/device-architecture.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-113">For more info, see [App package architectures](../packaging/device-architecture.md).</span></span> <span data-ttu-id="bdfa4-114">Win32 開発者の場合、x86 バージョンのアプリを配布します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-114">If you're a Win32 developer, distribute an x86 version of your app.</span></span> |
| <span data-ttu-id="bdfa4-115">アプリで OpenGL バージョン 1.1 以降が使用されているか、ハードウェア アクセラレータによる OpenGL を必要としている。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-115">Your app uses an OpenGL version later than 1.1 or requires hardware-accelerated OpenGL.</span></span> | <span data-ttu-id="bdfa4-116">利用可能な場合は、アプリの DirectX モードを使用します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-116">Use the DirectX mode of the app, if it's available.</span></span> <span data-ttu-id="bdfa4-117">DirectX 9、DirectX 10、DirectX 11、DirectX 12 を使う x86 アプリは ARM で動作します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-117">x86 apps that use DirectX 9, DirectX 10, DirectX 11, and DirectX 12 will work on ARM.</span></span> <span data-ttu-id="bdfa4-118">詳しくは、「[DirectX のグラフィックスとゲーミング](https://msdn.microsoft.com/en-us/library/windows/desktop/ee663274(v=vs.85).aspx)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-118">For more info, see [DirectX Graphics and Gaming](https://msdn.microsoft.com/en-us/library/windows/desktop/ee663274(v=vs.85).aspx).</span></span> |
| <span data-ttu-id="bdfa4-119">x86 アプリが期待どおりに動作しない。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-119">Your x86 app does not work as expected.</span></span> | <span data-ttu-id="bdfa4-120">「[プログラム互換性のトラブルシューティング ツール (ARM)](apps-on-arm-program-compat-troubleshooter.md)」のガイダンスに従って、互換性トラブルシューティング ツールを使ってみてください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-120">Try using the Compatibility Troubleshooter by following guidance from [Program Compatibility Troubleshooter on ARM](apps-on-arm-program-compat-troubleshooter.md).</span></span> <span data-ttu-id="bdfa4-121">その他のトラブルシューティング手順については、「[ARM における x86 アプリのトラブルシューティング](apps-on-arm-troubleshooting-x86.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-121">For some other troubleshooting steps, see the [Troubleshooting x86 apps on ARM](apps-on-arm-troubleshooting-x86.md) article.</span></span> |

## <a name="best-practices-for-wow"></a><span data-ttu-id="bdfa4-122">WOW のベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="bdfa4-122">Best practices for WOW</span></span>
<span data-ttu-id="bdfa4-123">アプリが WOW で実行されていることを検出するとある一般的な問題が発生し、x64 システムにあると想定します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-123">One common problem occurs when an app discovers that it's running under WOW and then assumes that it is on an x64 system.</span></span> <span data-ttu-id="bdfa4-124">この想定に基づいて、アプリは次の操作を行う可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-124">Having made this assumption, the app may do the following:</span></span>

- <span data-ttu-id="bdfa4-125">ARM でサポートされていない、アプリの x64 バージョンをインストールしようとします。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-125">Try to install the x64 version of itself, which isn't supported on ARM.</span></span>
- <span data-ttu-id="bdfa4-126">ネイティブ レジストリ ビューでその他のソフトウェアをチェックします。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-126">Check for other software under the native registry view.</span></span>
- <span data-ttu-id="bdfa4-127">64 ビット .NET Framework が利用できると想定します。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-127">Assume that a 64-bit .NET framework is available.</span></span>

<span data-ttu-id="bdfa4-128">一般に、アプリは WOW で実行されていると判断された場合、ホスト システムに関する想定を行いません。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-128">Generally, an app should not make assumptions about the host system when it is determined to run under WOW.</span></span> <span data-ttu-id="bdfa4-129">可能な限り OS のネイティブ コンポーネントを操作しないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-129">Avoid interacting with native components of the OS as much as possible.</span></span>

<span data-ttu-id="bdfa4-130">アプリは、ネイティブ レジストリ ビューにレジストリ キーを配置したり、WOW の存在に基づいて機能を実行したりする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-130">An app may place registry keys under the native registry view, or perform functions based on the presence of WOW.</span></span> <span data-ttu-id="bdfa4-131">元の **IsWow64Process** は、アプリが x64 コンピューターで実行されているかどうかのみ示しています。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-131">The original **IsWow64Process**  indicates only whether the app is running on an x64 machine.</span></span> <span data-ttu-id="bdfa4-132">アプリは [IsWow64Process2](https://msdn.microsoft.com/en-us/library/windows/desktop/mt804318(v=vs.85).aspx) を使って、WOW をサポートするシステムで実行されているかどうかを判断するようになりました。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-132">Apps should now use [IsWow64Process2](https://msdn.microsoft.com/en-us/library/windows/desktop/mt804318(v=vs.85).aspx) to determine whether they're running on a system with WOW support.</span></span> 

## <a name="drivers"></a><span data-ttu-id="bdfa4-133">ドライバー</span><span class="sxs-lookup"><span data-stu-id="bdfa4-133">Drivers</span></span> 
<span data-ttu-id="bdfa4-134">すべてのカーネル モード ドライバー、[ユーザー モード ドライバー フレームワーク (UMDF)](https://docs.microsoft.com/windows-hardware/drivers/wdf/overview-of-the-umdf) ドライバー、印刷ドライバーが OS のアーキテクチャと一致するようにコンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-134">All kernel-mode drivers, [User-Mode Driver Framework (UMDF)](https://docs.microsoft.com/windows-hardware/drivers/wdf/overview-of-the-umdf) drivers, and print drivers must be compiled to match the architecture of the OS.</span></span> <span data-ttu-id="bdfa4-135">x86 アプリにドライバーがある場合、そのドライバーを ARM64 用に再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-135">If an x86 app has a driver, then that driver must be recompiled for ARM64.</span></span> <span data-ttu-id="bdfa4-136">x86 アプリはエミュレーション下で適切に実行される可能性がありますが、そのドライバーは ARM64 用に再コンパイルする必要があり、ドライバーに依存するアプリ エクスペリエンスは利用できなくなります。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-136">The x86 app may run fine under emulation however, its driver will need to be recompiled for ARM64 and any app experience that depends on the driver will not be available.</span></span> <span data-ttu-id="bdfa4-137">ARM64 用ドライバーのコンパイルについて詳しくは、「[WDK を使った ARM64 ドライバーのビルド](https://docs.microsoft.com/windows-hardware/drivers/develop/building-arm64-drivers)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-137">For more info about compiling your driver for ARM64, see [Building ARM64 Drivers with the WDK](https://docs.microsoft.com/windows-hardware/drivers/develop/building-arm64-drivers).</span></span>

## <a name="shell-extensions"></a><span data-ttu-id="bdfa4-138">シェル拡張</span><span class="sxs-lookup"><span data-stu-id="bdfa4-138">Shell extensions</span></span> 
<span data-ttu-id="bdfa4-139">Windows コンポーネントをフックしたり、DLL を Windows プロセスに読み込んだりしようとするアプリは、それらの DLL を再コンパイルしてシステムのアーキテクチャ (つまり、ARM64) と一致させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-139">Apps that try to hook Windows components or load their DLLs into Windows processes will need to recompile those DLLs to match the architecture of the system; i.e. ARM64.</span></span> <span data-ttu-id="bdfa4-140">通常、これらは入力方式エディター (IME)、支援技術、シェル拡張アプリによって使用されます (例: エクスプローラーでクラウド記憶域アイコンを表示したり、コンテキスト メニューを右クリックしたりするなど)。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-140">Typically, these are used by input method editors (IMEs), assistive technologies, and shell extension apps (e.g. to show cloud storage icons in Explorer or a right click Context menu).</span></span> 

<span data-ttu-id="bdfa4-141">ARM64 Win32 SDK はまもなくサポートされる予定です。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-141">The ARM64 Win32 SDK support will be coming soon.</span></span> <span data-ttu-id="bdfa4-142">「[WDK を使った ARM64 ドライバーのビルド](https://docs.microsoft.com/windows-hardware/drivers/develop/building-arm64-drivers)」もご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-142">Also, see [Building ARM64 Drivers with the WDK](https://docs.microsoft.com/windows-hardware/drivers/develop/building-arm64-drivers).</span></span>

## <a name="debugging"></a><span data-ttu-id="bdfa4-143">デバッグ</span><span class="sxs-lookup"><span data-stu-id="bdfa4-143">Debugging</span></span>
<span data-ttu-id="bdfa4-144">アプリの動作をより詳しく調査するには、[ARM でのデバッグに関するページ](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugging-arm64)で、ARM でデバッグするためのツールと戦略についてご覧ください。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-144">To investigate your app's behavior in more depth, see [Debugging on ARM](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugging-arm64) to learn more about tools and strategies for debugging on ARM.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="bdfa4-145">仮想マシン</span><span class="sxs-lookup"><span data-stu-id="bdfa4-145">Virtual Machines</span></span>
<span data-ttu-id="bdfa4-146">Windows ハイパーバイザー プラットフォームは、Qualcomm の Snapdragon 835 モバイル PC プラットフォームでサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-146">The Windows Hypervisor platform is not supported on the Qualcomm Snapdragon 835 Mobile PC Platform.</span></span> <span data-ttu-id="bdfa4-147">したがって、Hyper-V を使った仮想マシンの実行は機能しません。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-147">Hence, running virtual machines using Hyper-V will not work.</span></span> <span data-ttu-id="bdfa4-148">将来の Qualcomm チップセットでは、これらのテクノロジへの投資が続けられます。</span><span class="sxs-lookup"><span data-stu-id="bdfa4-148">We continue to make investments in these technologies on future Qualcomm chipsets.</span></span> 