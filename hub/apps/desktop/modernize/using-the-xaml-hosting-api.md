---
description: この記事では、お客様のデスクトップ アプリケーションで UWP XAML の UI をホストする方法について説明します。
title: デスクトップ アプリケーションで API をホストしている UWP XAML を使用します。
ms.date: 04/16/2019
ms.topic: article
keywords: windows 10、uwp、windows フォーム、wpf、win32、xaml 諸島
ms.localizationpriority: medium
ms.custom: 19H1
ms.openlocfilehash: 9b318b922541180108dfdd053ba28ce98ad9ebcb
ms.sourcegitcommit: f0f933d5cf0be734373a7b03e338e65000cc3d80
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/21/2019
ms.locfileid: "65985012"
---
# <a name="using-the-uwp-xaml-hosting-api-in-a-desktop-application"></a><span data-ttu-id="2a5db-104">デスクトップ アプリケーションで API をホストしている UWP XAML を使用します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-104">Using the UWP XAML hosting API in a desktop application</span></span>

<span data-ttu-id="2a5db-105">以降では、Windows 10、バージョンが 1903、デスクトップ アプリケーションを UWP 以外 (WPF、Windows フォームなどとC++Win32 アプリケーション) を使用できます、 *API をホストしている UWP XAML*に関連付けられている任意の UI 要素に UWP コントロールをホストする、ウィンドウ ハンドル (HWND)。</span><span class="sxs-lookup"><span data-stu-id="2a5db-105">Starting in Windows 10, version 1903, non-UWP desktop applications (including WPF, Windows Forms, and C++ Win32 applications) can use the *UWP XAML hosting API* to host UWP controls in any UI element that is associated with a window handle (HWND).</span></span> <span data-ttu-id="2a5db-106">この API は、のみ UWP コントロールを使用して利用できる最新の Windows 10 の UI 機能を使用するデスクトップ アプリケーションを UWP 以外を使用できます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-106">This API enables non-UWP desktop applications to use the latest Windows 10 UI features that are only available via UWP controls.</span></span> <span data-ttu-id="2a5db-107">デスクトップ アプリケーションを UWP 以外が使用する UWP コントロールをホストするには、この API を使用するなど、 [Fluent Design System](/windows/uwp/design/fluent-design-system/index)サポートと[Windows インク](/windows/uwp/design/pen-and-stylus-interactions)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-107">For example, non-UWP desktop applications can use this API to host UWP controls that use the [Fluent Design System](/windows/uwp/design/fluent-design-system/index) and support [Windows Ink](/windows/uwp/design/pen-and-stylus-interactions).</span></span>

<span data-ttu-id="2a5db-108">API をホストしている UWP XAML では、開発者がデスクトップ アプリケーションを UWP 以外に Fluent UI を表示できるようにするコントロールの広範なセットの基盤を提供します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-108">The UWP XAML hosting API provides the foundation for a broader set of controls that we are providing to enable developers to bring Fluent UI to non-UWP desktop applications.</span></span> <span data-ttu-id="2a5db-109">この機能は呼*XAML 諸島*します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-109">This feature is called *XAML Islands*.</span></span> <span data-ttu-id="2a5db-110">この機能の概要については、次を参照してください。[デスクトップ アプリケーションでの UWP コントロール](xaml-islands.md)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-110">For an overview of this feature, see [UWP controls in desktop applications](xaml-islands.md).</span></span>

> [!NOTE]
> <span data-ttu-id="2a5db-111">XAML 諸島に関するフィードバックをした場合で新しい問題を作成、 [Microsoft.Toolkit.Win32 リポジトリ](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/issues)がコメントを残すとします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-111">If you have feedback about XAML Islands, create a new issue in the [Microsoft.Toolkit.Win32 repo](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/issues) and leave your comments there.</span></span> <span data-ttu-id="2a5db-112">プライベート フィードバックを送信する場合に送信できますXamlIslandsFeedback@microsoft.comします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-112">If you prefer to submit your feedback privately, you can send it to XamlIslandsFeedback@microsoft.com.</span></span> <span data-ttu-id="2a5db-113">Insights とシナリオは弊社にとって非常に重要です。</span><span class="sxs-lookup"><span data-stu-id="2a5db-113">Your insights and scenarios are critically important to us.</span></span>

## <a name="should-you-use-the-uwp-xaml-hosting-api"></a><span data-ttu-id="2a5db-114">API をホストしている UWP XAML を使用する必要がありますか。</span><span class="sxs-lookup"><span data-stu-id="2a5db-114">Should you use the UWP XAML hosting API?</span></span>

<span data-ttu-id="2a5db-115">API をホストしている UWP XAML は、デスクトップ アプリケーションでの UWP コントロールをホストするための低レベルのインフラストラクチャを提供します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-115">The UWP XAML hosting API provides the low-level infrastructure for hosting UWP controls in desktop applications.</span></span> <span data-ttu-id="2a5db-116">いくつかの種類のデスクトップ アプリケーションでは、代替方法でより便利な Api を使用して、この目標を達成するオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-116">Some types of desktop applications have the option of using alternative, more convenient APIs to accomplish this goal.</span></span>  

* <span data-ttu-id="2a5db-117">C++ Win32 デスクトップ アプリケーションがあり、アプリケーションで UWP コントロールをホストする場合は、API をホストしている UWP XAML を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-117">If you have a C++ Win32 desktop application and you want to host UWP controls in your application, you must use the UWP XAML hosting API.</span></span> <span data-ttu-id="2a5db-118">これらの種類のアプリケーションのための代替手段はありません。</span><span class="sxs-lookup"><span data-stu-id="2a5db-118">There are no alternatives for these types of applications.</span></span>

* <span data-ttu-id="2a5db-119">WPF と Windows フォーム アプリケーションでは、強くお勧めを使用すること、[コントロールをラップ](xaml-islands.md#wrapped-controls)と[ホスト コントロール](xaml-islands.md#host-controls)直接 API をホストしている UWP XAML を使用する代わりに Windows Community Toolkit にします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-119">For WPF and Windows Forms applications, we strongly recommend that you use the [wrapped controls](xaml-islands.md#wrapped-controls) and [host controls](xaml-islands.md#host-controls) in the Windows Community Toolkit instead of using the UWP XAML hosting API directly.</span></span> <span data-ttu-id="2a5db-120">これらのコントロールでは、内部的に API をホストしている UWP XAML を使用し、すべてのキーボード ナビゲーションとレイアウトの変更を含め、直接 API をホストしている UWP XAML を使用している場合、自分で処理する必要がなくなり、動作を実装します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-120">These controls use the UWP XAML hosting API internally and implement all of the behavior you would otherwise need to handle yourself if you used the UWP XAML hosting API directly, including keyboard navigation and layout changes.</span></span> <span data-ttu-id="2a5db-121">ただし、選択した場合、この種のアプリケーションで直接 API をホストする UWP XAML を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-121">However, you can use the UWP XAML hosting API directly in these types of applications if you choose.</span></span>

<span data-ttu-id="2a5db-122">この記事では、Windows コミュニティのツールキットで提供されるコントロールではなく、アプリケーションで直接 API をホストしている UWP XAML を使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-122">This article describes how to use the UWP XAML hosting API directly in your application instead of the controls provided by the Windows Community Toolkit.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="2a5db-123">前提条件</span><span class="sxs-lookup"><span data-stu-id="2a5db-123">Prerequisites</span></span>

<span data-ttu-id="2a5db-124">API をホストしている UWP XAML では、これらの前提条件があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-124">The UWP XAML hosting API has these prerequisites:</span></span>

* <span data-ttu-id="2a5db-125">Windows 10、バージョンが 1903 (またはそれ以降) と、対応する Windows SDK のビルドします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-125">Windows 10, version 1903 (or later) and the corresponding build of the Windows SDK.</span></span>
* <span data-ttu-id="2a5db-126">Windows ランタイム Api を使用し、次の XAML 諸島を有効にするプロジェクトを構成する[手順](xaml-islands.md#requirements)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-126">Configure your project to use Windows Runtime APIs and enable XAML Islands by following [these instructions](xaml-islands.md#requirements).</span></span>

## <a name="architecture-of-xaml-islands"></a><span data-ttu-id="2a5db-127">XAML 諸島のアーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="2a5db-127">Architecture of XAML Islands</span></span>

<span data-ttu-id="2a5db-128">API をホストしている UWP XAML には、これらのメインの Windows ランタイム型および COM インターフェイスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2a5db-128">The UWP XAML hosting API includes these main Windows Runtime types and COM interfaces:</span></span>

* <span data-ttu-id="2a5db-129">[**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-129">[**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager).</span></span> <span data-ttu-id="2a5db-130">このクラスは、UWP XAML フレームワークを表します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-130">This class represents the UWP XAML framework.</span></span> <span data-ttu-id="2a5db-131">このクラスは、単一の静的な[ **InitializeForCurrentThread** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread)デスクトップ アプリケーションでは、現在のスレッドで UWP XAML フレームワークを初期化するメソッド。</span><span class="sxs-lookup"><span data-stu-id="2a5db-131">This class provides a single static [**InitializeForCurrentThread**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread) method that initializes the UWP XAML framework on the current thread in the desktop application.</span></span>

* <span data-ttu-id="2a5db-132">[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-132">[**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource).</span></span> <span data-ttu-id="2a5db-133">このクラスは、お客様のデスクトップ アプリケーションでホストしている UWP XAML コンテンツのインスタンスを表します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-133">This class represents an instance of UWP XAML content that you are hosting in your desktop application.</span></span> <span data-ttu-id="2a5db-134">このクラスの最も重要なメンバーは、 [**コンテンツ**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="2a5db-134">The most important member of this class is the [**Content**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content) property.</span></span> <span data-ttu-id="2a5db-135">このプロパティに割り当てる、 [ **Windows.UI.Xaml.UIElement** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)をホストします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-135">You assign this property to a [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) that you want to host.</span></span> <span data-ttu-id="2a5db-136">このクラスには、ルーティングのキーボード フォーカスのナビゲーションに、および XAML 諸島からの他のメンバーもあります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-136">This class also has other members for routing keyboard focus navigation into and out of the XAML Islands.</span></span>

* <span data-ttu-id="2a5db-137">**IDesktopWindowXamlSourceNative**と**IDesktopWindowXamlSourceNative2** COM インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="2a5db-137">**IDesktopWindowXamlSourceNative** and **IDesktopWindowXamlSourceNative2** COM interfaces.</span></span> <span data-ttu-id="2a5db-138">**IDesktopWindowXamlSourceNative**提供、 **AttachToWindow**メソッドは、親の UI 要素に、アプリケーションで XAML の島をアタッチするために使用します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-138">**IDesktopWindowXamlSourceNative** provides the **AttachToWindow** method, which you use to attach a XAML Island in your application to a parent UI element.</span></span> <span data-ttu-id="2a5db-139">**IDesktopWindowXamlSourceNative2**提供、 **PreTranslateMessage**メソッドで、特定の Windows メッセージを正しく処理するため、UWP XAML フレームワークを使用します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-139">**IDesktopWindowXamlSourceNative2** provides the **PreTranslateMessage** method, which enables the UWP XAML framework to process certain Windows messages correctly.</span></span>
    > [!NOTE]
    > <span data-ttu-id="2a5db-140">これらのインターフェイスが宣言されている、 **windows.ui.xaml.hosting.desktopwindowxamlsource.h** Windows sdk ヘッダー ファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-140">These interfaces are declared in the **windows.ui.xaml.hosting.desktopwindowxamlsource.h** header file in the Windows SDK.</span></span> <span data-ttu-id="2a5db-141">既定では、このファイルは、%programfiles (x86) %\Windows Kits\10\Include で\\< ビルド番号\>\um します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-141">By default, this file is in %programfiles(x86)%\Windows Kits\10\Include\\<build number\>\um.</span></span> <span data-ttu-id="2a5db-142">C++ Win32 プロジェクトでは、このヘッダー ファイルを直接参照することができます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-142">In a C++ Win32 project, you can reference this header file directly.</span></span> <span data-ttu-id="2a5db-143">WPF や Windows フォーム プロジェクトでは、アプリケーション コードを使用してインターフェイスを宣言する必要があります、 [ **ComImport** ](https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.comimportattribute)属性。</span><span class="sxs-lookup"><span data-stu-id="2a5db-143">In a WPF or Windows Forms project, you'll need to declare the interfaces in your application code using the [**ComImport**](https://docs.microsoft.com/dotnet/api/system.runtime.interopservices.comimportattribute) attribute.</span></span> <span data-ttu-id="2a5db-144">インターフェイスの宣言内の宣言を正確に一致するかどうかを確認**windows.ui.xaml.hosting.desktopwindowxamlsource.h**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-144">Make sure your interface declarations exactly match the declarations in **windows.ui.xaml.hosting.desktopwindowxamlsource.h**.</span></span>

<span data-ttu-id="2a5db-145">次の図は、デスクトップ アプリケーションでホストされている XAML アイランド内のオブジェクトの階層を示します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-145">The following diagram illustrates the hierarchy of objects in a XAML Island that is hosted in a desktop application.</span></span>

![DesktopWindowXamlSource アーキテクチャ](images/xaml-islands/xaml-hosting-api-rev2.png)

* <span data-ttu-id="2a5db-147">基本レベルで XAML の島をホストするアプリケーションで UI 要素は、します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-147">At the base level is the UI element in your application where you want to host the XAML Island.</span></span> <span data-ttu-id="2a5db-148">この UI 要素には、ウィンドウ ハンドル (HWND) が必要です。</span><span class="sxs-lookup"><span data-stu-id="2a5db-148">This UI element must have a window handle (HWND).</span></span> <span data-ttu-id="2a5db-149">XAML の島をホストできる UI 要素の例として、 [ **System.Windows.Interop.HwndHost** ](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) WPF アプリケーション、 [ **System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) Windows フォーム アプリケーションの場合、[ウィンドウ](https://docs.microsoft.com/windows/desktop/winmsg/about-windows)のC++Win32 アプリケーション。</span><span class="sxs-lookup"><span data-stu-id="2a5db-149">Examples of UI elements in which you can host a XAML Island include [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) for WPF applications, [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) for Windows Forms applications, and a [window](https://docs.microsoft.com/windows/desktop/winmsg/about-windows) for C++ Win32 applications.</span></span>

* <span data-ttu-id="2a5db-150">レベルは、次を**DesktopWindowXamlSource**オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="2a5db-150">At the next level is a **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="2a5db-151">このオブジェクトは、XAML の島をホストするためのインフラストラクチャを提供します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-151">This object provides the infrastructure for hosting the XAML Island.</span></span> <span data-ttu-id="2a5db-152">コードは、このオブジェクトを作成し、親の UI 要素にアタッチします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-152">Your code is responsible for creating this object and attaching it to the parent UI element.</span></span>

* <span data-ttu-id="2a5db-153">作成するときに、 **DesktopWindowXamlSource**、このオブジェクトは、UWP コントロールをホストするネイティブの子ウィンドウを自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-153">When you create a **DesktopWindowXamlSource**, this object automatically creates a native child window to host your UWP control.</span></span> <span data-ttu-id="2a5db-154">このネイティブ子ウィンドウはほとんどの場合、コードから抽象化されていますが、そのハンドル (HWND) に必要な場合にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-154">This native child window is mostly abstracted away from your code, but you can access its handle (HWND) if necessary.</span></span>

* <span data-ttu-id="2a5db-155">最後に、最上位レベルでは、デスクトップ アプリケーションをホストする UWP コントロールです。</span><span class="sxs-lookup"><span data-stu-id="2a5db-155">Finally, at the top level is the UWP control you want to host in your desktop application.</span></span> <span data-ttu-id="2a5db-156">これは、任意の UWP オブジェクトから派生した[ **Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)など、UWP、Windows SDK によって提供されるだけではなくカスタム ユーザー コントロール。</span><span class="sxs-lookup"><span data-stu-id="2a5db-156">This can be any UWP object that derives from [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement), including any UWP control provided by the Windows SDK as well as custom user controls.</span></span>

## <a name="related-samples"></a><span data-ttu-id="2a5db-157">関連するサンプル</span><span class="sxs-lookup"><span data-stu-id="2a5db-157">Related samples</span></span>

<span data-ttu-id="2a5db-158">コードで API をホストしている UWP XAML を使用する方法は、アプリケーション、およびその他の要因のデザイン、アプリケーションの種類によって異なります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-158">The way you use the UWP XAML hosting API in your code depends on your application type, the design of your application, and other factors.</span></span> <span data-ttu-id="2a5db-159">この記事では、完全なアプリケーションのコンテキストでこの API を使用する方法を説明するには、次のサンプルからコードを指します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-159">To help illustrate how to use this API in the context of a complete application, this article refers to code from the following samples.</span></span>

### <a name="c-win32"></a><span data-ttu-id="2a5db-160">C++ Win32</span><span class="sxs-lookup"><span data-stu-id="2a5db-160">C++ Win32</span></span>

<span data-ttu-id="2a5db-161">[C++Win32 サンプル](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-161">[C++ Win32 Sample](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island).</span></span> <span data-ttu-id="2a5db-162">このサンプルでは、パッケージ化されていないで UWP ユーザー コントロールのホストの完全な実装C++Win32 アプリケーション (つまり、MSIX パッケージに組み込まれていないアプリケーション)。</span><span class="sxs-lookup"><span data-stu-id="2a5db-162">This sample demonstrates a complete implementation of hosting a UWP user control in an unpackaged C++ Win32 application (that is, an application that is not built into an MSIX package).</span></span>

### <a name="wpf-and-windows-forms"></a><span data-ttu-id="2a5db-163">WPF と Windows フォーム</span><span class="sxs-lookup"><span data-stu-id="2a5db-163">WPF and Windows Forms</span></span>

<span data-ttu-id="2a5db-164">[WindowsXamlHost](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) Windows の Community Toolkit のコントロールは、UWP、WPF、Windows フォーム アプリケーションでのホスティング API を使用するための参照をサンプルとして機能します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-164">The [WindowsXamlHost](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost) control in the Windows Community Toolkit acts as a reference sample for using the UWP hosting API in WPF and Windows Forms applications.</span></span> <span data-ttu-id="2a5db-165">ソース コードは、次の場所には。</span><span class="sxs-lookup"><span data-stu-id="2a5db-165">The source code is available at the following locations:</span></span>

  * <span data-ttu-id="2a5db-166">コントロールの WPF バージョン[ここに移動して](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Wpf.UI.XamlHost)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-166">For the WPF version of the control, [go here](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Wpf.UI.XamlHost).</span></span> <span data-ttu-id="2a5db-167">派生した WPF バージョン[ **System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-167">The WPF version derives from [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost).</span></span>

  * <span data-ttu-id="2a5db-168">コントロールの Windows フォーム バージョン[ここに移動して](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Forms.UI.XamlHost)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-168">For the Windows Forms version of the control, [go here](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/tree/master/Microsoft.Toolkit.Forms.UI.XamlHost).</span></span> <span data-ttu-id="2a5db-169">派生した Windows フォーム バージョン[ **System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-169">The Windows Forms version derives from [**System.Windows.Forms.Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control).</span></span>

## <a name="host-uwp-xaml-controls"></a><span data-ttu-id="2a5db-170">ホストの UWP XAML コントロールします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-170">Host UWP XAML controls</span></span>

<span data-ttu-id="2a5db-171">API をホストしている UWP XAML を使用して、アプリケーションでの UWP コントロールをホストする主な手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-171">Here are the main steps for using the UWP XAML hosting API to host a UWP control in your application.</span></span>

1. <span data-ttu-id="2a5db-172">いずれかのアプリケーションを作成する前に、現在のスレッドの UWP XAML フレームワークを初期化、 [ **Windows.UI.Xaml.UIElement** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)でホストするオブジェクト、 [ **DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-172">Initialize the UWP XAML framework for the current thread before your application creates any of the [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) objects that it will host in the [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource).</span></span>

    * <span data-ttu-id="2a5db-173">アプリケーションを作成する場合、 **DesktopWindowXamlSource**オブジェクトのいずれかの作成前に、 **Windows.UI.Xaml.UIElement**オブジェクトの場合、このフレームワークは、インスタンス化するときの初期化は、**DesktopWindowXamlSource**オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="2a5db-173">If your application creates the **DesktopWindowXamlSource** object before it creates any of the **Windows.UI.Xaml.UIElement** objects, this framework will be initialized for you when you instantiate the **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="2a5db-174">このシナリオでは、フレームワークを初期化するために独自のコードを追加する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="2a5db-174">In this scenario, you don't need to add any code of your own to initialize the framework.</span></span>

    * <span data-ttu-id="2a5db-175">ただし、アプリケーションを作成する場合、 **Windows.UI.Xaml.UIElement**オブジェクトを作成する前に、 **DesktopWindowXamlSource**オブジェクト、それらをホストするアプリケーションは、静的なを呼び出す必要があります[**WindowsXamlManager.InitializeForCurrentThread** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread)メソッドの前に、UWP XAML フレームワークを明示的に初期化するために、 **Windows.UI.Xaml.UIElement**オブジェクトは、インスタンス化します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-175">However, if your application creates the **Windows.UI.Xaml.UIElement** objects before it creates the **DesktopWindowXamlSource** object that will host them, your application must call the static [**WindowsXamlManager.InitializeForCurrentThread**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager.initializeforcurrentthread) method to explicitly initialize the UWP XAML framework before the **Windows.UI.Xaml.UIElement** objects are instantiated.</span></span> <span data-ttu-id="2a5db-176">親の UI 要素をホストするときに、アプリケーションはこのメソッドを呼び出す通常必要があります、 **DesktopWindowXamlSource**インスタンス化されます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-176">Your application should typically call this method when the parent UI element that hosts the **DesktopWindowXamlSource** is instantiated.</span></span>

    ```cppwinrt
    Windows::UI::Xaml::Hosting::WindowsXamlManager windowsXamlManager =
        Windows::UI::Xaml::Hosting::WindowsXamlManager::InitializeForCurrentThread();
    ```

    ```csharp
    global::Windows.UI.Xaml.Hosting.WindowsXamlManager windowsXamlManager =
        global::Windows.UI.Xaml.Hosting.WindowsXamlManager.InitializeForCurrentThread();
    ```

    > [!NOTE]
    > <span data-ttu-id="2a5db-177">このメソッドが戻る、 [ **WindowsXamlManager** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) UWP XAML フレームワークへの参照を格納しているオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="2a5db-177">This method returns a [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) object that contains a reference to the UWP XAML framework.</span></span> <span data-ttu-id="2a5db-178">数だけ作成できます**WindowsXamlManager**オブジェクトを特定のスレッド上でどのようにします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-178">You can create as many **WindowsXamlManager** objects as you want on a given thread.</span></span> <span data-ttu-id="2a5db-179">ただし、各オブジェクトは、UWP XAML フレームワークへの参照を保持しているために、XAML リソースが最終的に解放されることを確認するオブジェクトを破棄する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-179">However, because each object holds a reference to the UWP XAML framework, you should dispose the objects to ensure that XAML resources are eventually released.</span></span>

2. <span data-ttu-id="2a5db-180">作成、 [ **DesktopWindowXamlSource** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)オブジェクトし、親ウィンドウ ハンドルに関連付けられているアプリケーションの UI 要素にアタッチします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-180">Create a [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) object and attach it to a parent UI element in your application that is associated with a window handle.</span></span>

    <span data-ttu-id="2a5db-181">これを行うには、これらの手順に従う必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-181">To do this, you'll need to follow these steps:</span></span>

    1. <span data-ttu-id="2a5db-182">作成、 **DesktopWindowXamlSource**オブジェクトおよびにキャスト、 **IDesktopWindowXamlSourceNative**または**IDesktopWindowXamlSourceNative2** COM インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="2a5db-182">Create a **DesktopWindowXamlSource** object and cast it to the **IDesktopWindowXamlSourceNative** or **IDesktopWindowXamlSourceNative2** COM interface.</span></span>

    2. <span data-ttu-id="2a5db-183">呼び出す、 **AttachToWindow**のメソッド、 **IDesktopWindowXamlSourceNative**または**IDesktopWindowXamlSourceNative2**インターフェイスし、のウィンドウ ハンドルを渡す、アプリケーションの UI 要素を親。</span><span class="sxs-lookup"><span data-stu-id="2a5db-183">Call the **AttachToWindow** method of the **IDesktopWindowXamlSourceNative** or **IDesktopWindowXamlSourceNative2** interface, and pass in the window handle of the parent UI element in your application.</span></span>

    3. <span data-ttu-id="2a5db-184">含まれる内部の子ウィンドウの初期サイズを設定、 **DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-184">Set the initial size of the internal child window contained in the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="2a5db-185">既定では、この内部の子ウィンドウは、幅と高さが 0 に設定されます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-185">By default, this internal child window is set to a width and height of 0.</span></span> <span data-ttu-id="2a5db-186">追加するすべての UWP コントロール、ウィンドウのサイズを設定していない場合、 **DesktopWindowXamlSource**は表示されません。</span><span class="sxs-lookup"><span data-stu-id="2a5db-186">If you don't set the size of the window, any UWP controls you add to the **DesktopWindowXamlSource** will not be visible.</span></span> <span data-ttu-id="2a5db-187">内部の子ウィンドウにアクセスする、 **DesktopWindowXamlSource**を使用して、 **WindowHandle**のプロパティ、 **IDesktopWindowXamlSourceNative**または**IDesktopWindowXamlSourceNative2**インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="2a5db-187">To access the internal child window in the **DesktopWindowXamlSource**, use the **WindowHandle** property of the **IDesktopWindowXamlSourceNative** or **IDesktopWindowXamlSourceNative2** interface.</span></span> <span data-ttu-id="2a5db-188">次の例を使用して、 [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos)ウィンドウのサイズを設定します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-188">The following examples use the [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to set the size of the window.</span></span>

    <span data-ttu-id="2a5db-189">このプロセスを示すいくつかのコード例を示します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-189">Here are some code examples that demonstrate this process.</span></span>

    ```cppwinrt
    // This example assumes you already have an HWND variable named 'parentHwnd' that
    // contains the handle of the parent window.
    Windows::UI::Xaml::Hosting::DesktopWindowXamlSource desktopWindowXamlSource;
    auto interop = desktopWindowXamlSource.as<IDesktopWindowXamlSourceNative>();
    check_hresult(interop->AttachToWindow(parentHwnd));

    HWND childInteropHwnd = nullptr;
    interop->get_WindowHandle(&childInteropHwnd);

    SetWindowPos(childInteropHwnd, 0, 0, 0, 300, 300, SWP_SHOWWINDOW);
    ```

    ```csharp
    // This WPF example assumes you already have an HwndHost named 'parentHwndHost'
    // that will act as the parent UI element for your XAML Island. It also assumes
    // you have used the DllImport attribute to import SetWindowPos from user32.dll
    // as a static method into a class named NativeMethods.
    Windows.UI.Xaml.Hosting.DesktopWindowXamlSource desktopWindowXamlSource =
        new Windows.UI.Xaml.Hosting.DesktopWindowXamlSource();

    IntPtr iUnknownPtr = System.Runtime.InteropServices.Marshal.GetIUnknownForObject(
        desktopWindowXamlSource);
    IDesktopWindowXamlSourceNative desktopWindowXamlSourceNative =
        System.Runtime.InteropServices.Marshal.Marshal.GetTypedObjectForIUnknown(
            iUnknownPtr, typeof(IDesktopWindowXamlSourceNative))
            as IDesktopWindowXamlSourceNative;

    desktopWindowXamlSourceNative.AttachToWindow(parentHwndHost.Handle);

    var childInteropHwnd = desktopWindowXamlSourceNative.WindowHandle;
    NativeMethods.SetWindowPos(childInteropHwnd, HWND_TOP, 0, 0, 300, 300, SWP_SHOWWINDOW);
    ```

3. <span data-ttu-id="2a5db-190">設定、 **Windows.UI.Xaml.UIElement**をホストする、 [**コンテンツ**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content)のプロパティ、 **DesktopWindowXamlSource**オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="2a5db-190">Set the **Windows.UI.Xaml.UIElement** you want to host to the [**Content**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.content) property of your **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="2a5db-191">次の例のセットを[ **Windows.UI.Xaml.Controls.Grid** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid)という```myGrid```を**コンテンツ**プロパティ。</span><span class="sxs-lookup"><span data-stu-id="2a5db-191">The following example sets a [**Windows.UI.Xaml.Controls.Grid**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.controls.grid) named ```myGrid``` to the **Content** property.</span></span>

   ```cppwinrt
   desktopWindowXamlSource.Content(myGrid);
   ```

   ```csharp
   desktopWindowXamlSource.Content = myGrid;
   ```

<span data-ttu-id="2a5db-192">実際のサンプル アプリケーションのコンテキストでこれらのタスクを示す完全な例では、次のコード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a5db-192">For complete examples that demonstrate these tasks in the context of a working sample application, see the following code files:</span></span>

  * <span data-ttu-id="2a5db-193">**C++ Win32:** 参照してください、 [XamlBridge.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/SampleCppApp/XamlBridge.cpp)ファイル、 [ C++ Win32 サンプル](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-193">**C++ Win32:** See the [XamlBridge.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/SampleCppApp/XamlBridge.cpp) file in the [C++ Win32 sample](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island).</span></span>

  * <span data-ttu-id="2a5db-194">**WPF:** 参照してください、 [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.cs)と[WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHost.cs) Windows コミュニティ ツールキット内のファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-194">**WPF:** See the [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.cs) and  [WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHost.cs) files in the Windows Community Toolkit.</span></span>  

  * <span data-ttu-id="2a5db-195">**Windows フォーム:** 参照してください、 [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.cs)と[WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHost.cs) Windows コミュニティ ツールキット内のファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-195">**Windows Forms:** See the [WindowsXamlHostBase.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.cs) and  [WindowsXamlHost.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHost.cs) files in the Windows Community Toolkit.</span></span>

## <a name="handle-keyboard-input-and-focus-navigation"></a><span data-ttu-id="2a5db-196">キーボードの入力とフォーカスのナビゲーションを処理します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-196">Handle keyboard input and focus navigation</span></span>

<span data-ttu-id="2a5db-197">アプリで XAML 諸島をホストするときに、キーボードの入力とフォーカスのナビゲーションを正しく処理するために必要ないくつかの点があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-197">There are several things your app needs to do to properly handle keyboard input and focus navigation when it hosts XAML Islands.</span></span>

### <a name="keyboard-input"></a><span data-ttu-id="2a5db-198">キーボード入力</span><span class="sxs-lookup"><span data-stu-id="2a5db-198">Keyboard input</span></span>

<span data-ttu-id="2a5db-199">各 XAML 島のキーボード入力を正しく処理するには、アプリケーションは特定のメッセージを正しく処理できるように、UWP XAML フレームワークにすべての Windows メッセージを渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-199">To properly handle keyboard input for each XAML Island, your application must pass all Windows messages to the UWP XAML framework so that certain messages can be processed correctly.</span></span> <span data-ttu-id="2a5db-200">メッセージ ループがアクセスできるアプリケーション内の場所、キャスト、 **DesktopWindowXamlSource**オブジェクトの各 XAML 島、 **IDesktopWindowXamlSourceNative2** COM インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="2a5db-200">To do this, in some place in your application that can access the message loop, cast the **DesktopWindowXamlSource** object for each XAML Island to an **IDesktopWindowXamlSourceNative2** COM interface.</span></span> <span data-ttu-id="2a5db-201">次に呼び出す、 **PreTranslateMessage**メソッドのこのインターフェイスと現在のメッセージを渡します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-201">Then, call the **PreTranslateMessage** method of this interface and pass in the current message.</span></span>

  * <span data-ttu-id="2a5db-202">A C++ Win32 アプリケーションで呼び出すことができます**PreTranslateMessage**メイン メッセージ ループで直接します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-202">A C++ Win32 application can call **PreTranslateMessage** directly in its main message loop.</span></span> <span data-ttu-id="2a5db-203">例については、次を参照してください。、 [SampleApp.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/SampleCppApp/SampleApp.cpp#L61)でコード ファイル、 [ C++ Win32 サンプル](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-203">For an example, see the [SampleApp.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/SampleCppApp/SampleApp.cpp#L61) code file in the [C++ Win32 sample](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island).</span></span>

  * <span data-ttu-id="2a5db-204">WPF アプリケーションを呼び出すことができます**PreTranslateMessage**のイベント ハンドラーから、 [ **ComponentDispatcher.ThreadFilterMessage** ](https://docs.microsoft.com/dotnet/api/system.windows.interop.componentdispatcher.threadfiltermessage?view=netframework-4.7.2)イベント。</span><span class="sxs-lookup"><span data-stu-id="2a5db-204">A WPF application can call **PreTranslateMessage** from the event handler for the [**ComponentDispatcher.ThreadFilterMessage**](https://docs.microsoft.com/dotnet/api/system.windows.interop.componentdispatcher.threadfiltermessage?view=netframework-4.7.2) event.</span></span> <span data-ttu-id="2a5db-205">例については、次を参照してください。、 [WindowsXamlHostBase.Focus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs#L177) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-205">For an example, see the [WindowsXamlHostBase.Focus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs#L177) file in the Windows Community Toolkit.</span></span>

  * <span data-ttu-id="2a5db-206">Windows フォーム アプリケーションを呼び出すことができます**PreTranslateMessage**のオーバーライドから、 [ **Control.PreprocessMessage** ](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.preprocessmessage?view=netframework-4.7.2)メソッド。</span><span class="sxs-lookup"><span data-stu-id="2a5db-206">A Windows Forms application can call **PreTranslateMessage** from an override for the [**Control.PreprocessMessage**](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.control.preprocessmessage?view=netframework-4.7.2) method.</span></span> <span data-ttu-id="2a5db-207">例については、次を参照してください。、 [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs#L100) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-207">For an example, see the [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs#L100) file in the Windows Community Toolkit.</span></span>

### <a name="keyboard-focus-navigation"></a><span data-ttu-id="2a5db-208">キーボード フォーカスのナビゲーション</span><span class="sxs-lookup"><span data-stu-id="2a5db-208">Keyboard focus navigation</span></span>

<span data-ttu-id="2a5db-209">キーボードを使用して、アプリケーションで UI 要素を通じて、ユーザーが移動したときに (たとえば、キーを押して**タブ**または方向/矢印キー)、プログラムでの入出力にフォーカスを移動する必要があります、 **DesktopWindowXamlSource**オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="2a5db-209">When the user navigates through the UI elements in your application using the keyboard (for example, by pressing **Tab** or direction/arrow key), you'll need to programmatically move focus into and out of the **DesktopWindowXamlSource** object.</span></span> <span data-ttu-id="2a5db-210">ユーザーのキーボード ナビゲーションが達したとき、 **DesktopWindowXamlSource**、最初にフォーカスを移動[ **Windows.UI.Xaml.UIElement** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement)ナビゲーション順でのオブジェクト次にフォーカスを移動、ui では、引き続き**Windows.UI.Xaml.UIElement**オブジェクトとして、ユーザーが要素をサイクルしバックアップ フォーカスの移動、 **DesktopWindowXamlSource**と親の UI 要素にします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-210">When the user's keyboard navigation reaches the **DesktopWindowXamlSource**, move focus into the first [**Windows.UI.Xaml.UIElement**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement) object in the navigation order for your UI, continue to move focus to the following **Windows.UI.Xaml.UIElement** objects as the user cycles through the elements, and then move focus back out of the **DesktopWindowXamlSource** and into the parent UI element.</span></span>  

<span data-ttu-id="2a5db-211">API をホストしている UWP XAML では、これらのタスクを達成するために、いくつかの型とメンバーを提供します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-211">The UWP XAML hosting API provides several types and members to help you accomplish these tasks.</span></span>

* <span data-ttu-id="2a5db-212">キーボード ナビゲーションが入力した場合、 **DesktopWindowXamlSource**、 [ **GotFocus** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.gotfocus)イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-212">When the keyboard navigation enters your **DesktopWindowXamlSource**, the [**GotFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.gotfocus) event is raised.</span></span> <span data-ttu-id="2a5db-213">このイベントを処理し、最初にフォーカスを移動プログラムでホストされている**Windows.UI.Xaml.UIElement**を使用して、 [ **NavigateFocus** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.navigatefocus)メソッド。</span><span class="sxs-lookup"><span data-stu-id="2a5db-213">Handle this event and programmatically move focus to the first hosted **Windows.UI.Xaml.UIElement** by using the [**NavigateFocus**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.navigatefocus) method.</span></span>

* <span data-ttu-id="2a5db-214">フォーカスを設定できる最後の要素で、ユーザーの場合、 **DesktopWindowXamlSource**を押すと、**タブ**キーまたは方向キー、 [ **TakeFocusRequested**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.takefocusrequested)イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-214">When the user is on the last focusable element in your **DesktopWindowXamlSource** and presses the **Tab** key or an arrow key, the [**TakeFocusRequested**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource.takefocusrequested) event is raised.</span></span> <span data-ttu-id="2a5db-215">このイベントを処理し、プログラムによって、ホスト アプリケーションにフォーカスを設定できる次の要素にフォーカスを移動します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-215">Handle this event and programmatically move focus to the next focusable element in the host application.</span></span> <span data-ttu-id="2a5db-216">たとえば、WPF アプリケーションで場所、 **DesktopWindowXamlSource**でホストされている、 [ **System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)、使用することができます、 [ **MoveFocus** ](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.movefocus)ホスト アプリケーションにフォーカスを設定できる次の要素にフォーカスを転送する方法。</span><span class="sxs-lookup"><span data-stu-id="2a5db-216">For example, in a WPF application where the **DesktopWindowXamlSource** is hosted in a [**System.Windows.Interop.HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost), you can use the [**MoveFocus**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.movefocus) method to transfer focus to the next focusable element in the host application.</span></span>

<span data-ttu-id="2a5db-217">これは実際のサンプル アプリケーションのコンテキストで実行する方法を示す例については、次のコード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a5db-217">For examples that demonstrate how to do this in the context of a working sample application, see the following code files:</span></span>

  * <span data-ttu-id="2a5db-218">**WPF:** 参照してください、 [WindowsXamlHostBase.Focus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-218">**WPF:** See the [WindowsXamlHostBase.Focus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Focus.cs) file in the Windows Community Toolkit.</span></span>  

  * <span data-ttu-id="2a5db-219">**Windows フォーム:** 参照してください、 [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-219">**Windows Forms:** See the [WindowsXamlHostBase.KeyboardFocus.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.KeyboardFocus.cs) file in the Windows Community Toolkit.</span></span>

## <a name="handle-layout-changes"></a><span data-ttu-id="2a5db-220">レイアウトの変更を処理します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-220">Handle layout changes</span></span>

<span data-ttu-id="2a5db-221">ユーザーが親の UI 要素のサイズを変更した UWP コントロールが期待どおりに表示していることを確認するために必要なレイアウト変更を処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-221">When the user changes the size of the parent UI element, you'll need to handle any necessary layout changes to make sure your UWP controls display as you expect.</span></span> <span data-ttu-id="2a5db-222">考慮すべき重要なシナリオを以下に示します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-222">Here are some important scenarios to consider.</span></span>

* <span data-ttu-id="2a5db-223">C++ Win32 アプリケーション、アプリケーションを使用してホストされている XAML 島を再配置できますが、WM_SIZE メッセージを処理する際に、 [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos)関数。</span><span class="sxs-lookup"><span data-stu-id="2a5db-223">In a C++ Win32 application, when your application handles the WM_SIZE message it can reposition the hosted XAML Island by using the [SetWindowPos](https://docs.microsoft.com/windows/desktop/api/winuser/nf-winuser-setwindowpos) function.</span></span> <span data-ttu-id="2a5db-224">例については、次を参照してください。、 [SampleApp.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/SampleCppApp/SampleApp.cpp#L191)でコード ファイル、 [ C++ Win32 サンプル](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-224">For an example, see the [SampleApp.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/SampleCppApp/SampleApp.cpp#L191) code file in the [C++ Win32 sample](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island).</span></span>

* <span data-ttu-id="2a5db-225">親の UI 要素が収まる四角形領域のサイズを取得する必要がある場合、 **Windows.UI.Xaml.UIElement**でホストしている、 **DesktopWindowXamlSource**を呼び出し、 [**メジャー** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.measure)のメソッド、 **Windows.UI.Xaml.UIElement**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-225">When the parent UI element needs to get the size of the rectangular area needed to fit the **Windows.UI.Xaml.UIElement** that you are hosting on the **DesktopWindowXamlSource**, call the [**Measure**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.measure) method of the **Windows.UI.Xaml.UIElement**.</span></span> <span data-ttu-id="2a5db-226">次に、例を示します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-226">For example:</span></span>

    * <span data-ttu-id="2a5db-227">WPF アプリケーションでこれから行うことがあります、 [ **MeasureOverride** ](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride)のメソッド、 [ **HwndHost** ](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost)をホストする、 **DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-227">In a WPF application you might do this from the [**MeasureOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.measureoverride) method of the [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) that hosts the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="2a5db-228">例については、次を参照してください。、 [WindowsXamlHostBase.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-228">For an example, see the [WindowsXamlHostBase.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>

    * <span data-ttu-id="2a5db-229">Windows フォーム アプリケーションでこれから行うことがあります、 [ **GetPreferredSize** ](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.getpreferredsize)のメソッド、 [**コントロール**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) をホストする**DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-229">In a Windows Forms application you might do this from the [**GetPreferredSize**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.getpreferredsize) method of the [**Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) that hosts the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="2a5db-230">例については、次を参照してください。、 [WindowsXamlHostBase.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-230">For an example, see the [WindowsXamlHostBase.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>

* <span data-ttu-id="2a5db-231">親の UI 要素のサイズが変更されたときに呼び出す、 [**配置**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.arrange)ルートのメソッド**Windows.UI.Xaml.UIElement**でホストしている、 **DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-231">When the size of the parent UI element changes, call the [**Arrange**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.uielement.arrange) method of the root **Windows.UI.Xaml.UIElement** that you are hosting on the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="2a5db-232">次に、例を示します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-232">For example:</span></span>

    * <span data-ttu-id="2a5db-233">WPF アプリケーションでこれから行うことがあります、 [ **ArrangeOverride** ](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride)のメソッド、 [ **HwndHost** ](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) をホストしているオブジェクト**DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-233">In a WPF application you might do this from the [**ArrangeOverride**](https://docs.microsoft.com/dotnet/api/system.windows.frameworkelement.arrangeoverride) method of the [**HwndHost**](https://docs.microsoft.com/dotnet/api/system.windows.interop.hwndhost) object that hosts the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="2a5db-234">例については、次を参照してください。、 [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-234">For an example, see the [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Wpf.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>

    * <span data-ttu-id="2a5db-235">Windows フォーム アプリケーションでこれを行いますのハンドラーから、 [ **SizeChanged** ](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.sizechanged)のイベント、 [**コントロール**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control)をホストする、**DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-235">In a Windows Forms application you might do this from the handler for the [**SizeChanged**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control.sizechanged) event of the [**Control**](https://docs.microsoft.com/dotnet/api/system.windows.forms.control) that hosts the **DesktopWindowXamlSource**.</span></span> <span data-ttu-id="2a5db-236">例については、次を参照してください。、 [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) Windows コミュニティのツールキットでのファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-236">For an example, see the [WindowsXamlHost.Layout.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Forms.UI.XamlHost/WindowsXamlHostBase.Layout.cs) file in the Windows Community Toolkit.</span></span>

## <a name="handle-dpi-changes"></a><span data-ttu-id="2a5db-237">DPI 変更を処理します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-237">Handle DPI changes</span></span>

<span data-ttu-id="2a5db-238">UWP XAML フレームワークは、(たとえば、さまざまな画面の DPI のモニター間でウィンドウを出た) ときに自動的にホストされている UWP コントロールの DPI 変更を処理します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-238">The UWP XAML framework handles DPI changes for hosted UWP controls automatically (for example, when the user drags the window between monitors with different screen DPI).</span></span> <span data-ttu-id="2a5db-239">最良の結果をお勧めする、Windows フォーム、WPF、またはC++モニターごとの DPI に対応する Win32 アプリケーションを構成します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-239">For the best experience, we recommend that your Windows Forms, WPF, or C++ Win32 application is configured to be per-monitor DPI aware.</span></span>

<span data-ttu-id="2a5db-240">モニターごとの DPI に対応するアプリケーションを構成するには追加、[サイド バイ サイド アセンブリ マニフェスト](https://docs.microsoft.com/windows/desktop/SbsCs/application-manifests)にプロジェクトを設定し```<dpiAwareness>```要素を```PerMonitorV2```します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-240">To configure your application to be per-monitor DPI aware, add a [side-by-side assembly manifest](https://docs.microsoft.com/windows/desktop/SbsCs/application-manifests) to your project and set ```<dpiAwareness>``` element to ```PerMonitorV2```.</span></span> <span data-ttu-id="2a5db-241">この値の詳細については、の説明を参照してください。 [ **DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2**](https://docs.microsoft.com/windows/desktop/hidpi/dpi-awareness-context)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-241">For more information about this value, see the description for [**DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2**](https://docs.microsoft.com/windows/desktop/hidpi/dpi-awareness-context).</span></span>

```xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <application xmlns="urn:schemas-microsoft-com:asm.v3">
        <windowsSettings>
            <dpiAwareness xmlns="http://schemas.microsoft.com/SMI/2016/WindowsSettings">PerMonitorV2</dpiAwareness>
        </windowsSettings>
    </application>
</assembly>
```

## <a name="host-custom-uwp-xaml-controls"></a><span data-ttu-id="2a5db-242">UWP XAML のカスタム ホストを制御します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-242">Host custom UWP XAML controls</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2a5db-243">カスタムの UWP XAML コントロールをホストするには、それに対して、アプリケーションでコンパイルするために、コントロールのソース コードが必要です。</span><span class="sxs-lookup"><span data-stu-id="2a5db-243">To host a custom UWP XAML control, you must have the source code for the control so you can compile against it in your application.</span></span>

<span data-ttu-id="2a5db-244">説明されているプロセスに加え、次の追加タスクを実行する必要があります (ユーザー定義コントロールまたはサード パーティによって提供されるコントロール) に、カスタム UWP XAML コントロールをホストする場合、[前のセクション](#host-uwp-xaml-controls)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-244">If you want to host a custom UWP XAML control (either a control you define yourself or a control provided by a 3rd party), you must perform the following additional tasks in addition to the process described in the [previous section](#host-uwp-xaml-controls).</span></span>

1. <span data-ttu-id="2a5db-245">派生したカスタム型を定義する[ **Windows.UI.Xaml.Application** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application)も実装[ **IXamlMetadataProvider**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-245">Define a custom type that derives from [**Windows.UI.Xaml.Application**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.application) and also implements [**IXamlMetadataProvider**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider).</span></span> <span data-ttu-id="2a5db-246">この型は、アプリケーションの現在のディレクトリのアセンブリ内でカスタムの UWP XAML 型のメタデータの読み込みをルートのメタデータ プロバイダーとして機能します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-246">This type acts as a root metadata provider for loading metadata for custom UWP XAML types in assemblies in the current directory of your application.</span></span>

2. <span data-ttu-id="2a5db-247">呼び出す、 [ **GetXamlType** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider.getxamltype) UWP XAML コントロールの型名が割り当てられている場合は、ルートのメタデータのプロバイダーのメソッド (この、実行時にコードに割り当てることがまたは、これを有効にすることもできます。割り当てられている Visual Studio のプロパティ ウィンドウで)。</span><span class="sxs-lookup"><span data-stu-id="2a5db-247">Call the [**GetXamlType**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.markup.ixamlmetadataprovider.getxamltype) method of your root metadata provider when the type name of the UWP XAML control is assigned (this could be assigned in code at run time, or you might choose to enable this to be assigned in the Visual Studio Properties window).</span></span>

    <span data-ttu-id="2a5db-248">例については、次のコード ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="2a5db-248">For examples, see the following code files:</span></span>
      * <span data-ttu-id="2a5db-249">**C++ Win32:** 参照してください、 [XamlApplication.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/Microsoft.UI.Xaml.Markup/XamlApplication.cpp)でコード ファイル、 [ C++ Win32 サンプル](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-249">**C++ Win32:** See the [XamlApplication.cpp](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island/Microsoft.UI.Xaml.Markup/XamlApplication.cpp) code file in the [C++ Win32 sample](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island).</span></span>

      * <span data-ttu-id="2a5db-250">**WPF と Windows フォーム**:参照してください、 [XamlApplication.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/XamlApplication.cs)と[UWPTypeFactory.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/UWPTypeFactory.cs)コードでは、Windows の Community Toolkit ファイル。</span><span class="sxs-lookup"><span data-stu-id="2a5db-250">**WPF and Windows Forms**: See the [XamlApplication.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/XamlApplication.cs) and [UWPTypeFactory.cs](https://github.com/windows-toolkit/Microsoft.Toolkit.Win32/blob/master/Microsoft.Toolkit.Win32.UI.XamlHost/UWPTypeFactory.cs) code files in the Windows Community Toolkit.</span></span> <span data-ttu-id="2a5db-251">これらのファイルの共有の実装の一部である、 **WindowsXamlHost** WPF と Windows フォームは、これらの種類のアプリで API をホストしている UWP XAML を使用する方法を示すためのクラス。</span><span class="sxs-lookup"><span data-stu-id="2a5db-251">These files are part of the shared implementation of the **WindowsXamlHost** classes for WPF and Windows Forms, which help illustrate how to use the UWP XAML hosting API in those types of apps.</span></span>

3. <span data-ttu-id="2a5db-252">ホスト アプリケーションのソリューションにカスタムの UWP XAML コントロールのソース コードを統合、カスタムのコントロールをビルドおよびアプリケーションで使用します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-252">Integrate the source code for the custom UWP XAML control into your host application solution, build the custom control, and use it in your application.</span></span> <span data-ttu-id="2a5db-253">WPF や Windows フォーム アプリケーションの手順については、次を参照してください。[手順](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost#add-a-custom-uwp-control)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-253">For instructions for a WPF or Windows Forms application, see [these instructions](https://docs.microsoft.com/windows/communitytoolkit/controls/wpf-winforms/windowsxamlhost#add-a-custom-uwp-control).</span></span> <span data-ttu-id="2a5db-254">例については、 C++ Win32 アプリケーションを参照してください、 [Microsoft.UI.Xaml.Markup](https://github.com/marb2000/XamlIslands/tree/master/19H1_Insider_Samples/CppWin32App_With_Island/Microsoft.UI.Xaml.Markup)と[MyApp](https://github.com/marb2000/XamlIslands/tree/master/19H1_Insider_Samples/CppWin32App_With_Island/MyApp)プロジェクトで、 [ C++ Win32 サンプル](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-254">For an example for a C++ Win32 application, see the [Microsoft.UI.Xaml.Markup](https://github.com/marb2000/XamlIslands/tree/master/19H1_Insider_Samples/CppWin32App_With_Island/Microsoft.UI.Xaml.Markup) and [MyApp](https://github.com/marb2000/XamlIslands/tree/master/19H1_Insider_Samples/CppWin32App_With_Island/MyApp) projects in the [C++ Win32 sample](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="2a5db-255">トラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="2a5db-255">Troubleshooting</span></span>

### <a name="error-using-uwp-xaml-hosting-api-in-a-uwp-app"></a><span data-ttu-id="2a5db-256">UWP アプリで API をホストしている UWP XAML を使用してエラー</span><span class="sxs-lookup"><span data-stu-id="2a5db-256">Error using UWP XAML hosting API in a UWP app</span></span>

| <span data-ttu-id="2a5db-257">問題</span><span class="sxs-lookup"><span data-stu-id="2a5db-257">Issue</span></span> | <span data-ttu-id="2a5db-258">解決方法</span><span class="sxs-lookup"><span data-stu-id="2a5db-258">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="2a5db-259">アプリが受け取る、 **COMException**次のメッセージ。"DesktopWindowXamlSource をアクティブ化できません。</span><span class="sxs-lookup"><span data-stu-id="2a5db-259">Your app receives a **COMException** with the following message: "Cannot activate DesktopWindowXamlSource.</span></span> <span data-ttu-id="2a5db-260">この型では使用できません、UWP アプリです。"</span><span class="sxs-lookup"><span data-stu-id="2a5db-260">This type cannot be used in a UWP app."</span></span> <span data-ttu-id="2a5db-261">または、"WindowsXamlManager をアクティブ化できません。</span><span class="sxs-lookup"><span data-stu-id="2a5db-261">or "Cannot activate WindowsXamlManager.</span></span> <span data-ttu-id="2a5db-262">この型では使用できません、UWP アプリです。"</span><span class="sxs-lookup"><span data-stu-id="2a5db-262">This type cannot be used in a UWP app."</span></span> | <span data-ttu-id="2a5db-263">このエラーは、API をホストしている UWP XAML を使用しようとしていることを示します (具体的には、インスタンスを作成しようとしてには、 [ **DesktopWindowXamlSource** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)または[ **WindowsXamlManager** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager)型) で UWP アプリです。</span><span class="sxs-lookup"><span data-stu-id="2a5db-263">This error indicates you are trying to use the UWP XAML hosting API (specifically, you are trying to instantiate the [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) or [**WindowsXamlManager**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.windowsxamlmanager) types) in a UWP app.</span></span> <span data-ttu-id="2a5db-264">API をホストしている UWP XAML の目的はのみ、非 UWP のデスクトップ アプリ、WPF、Windows フォーム、および C++ の Win32 アプリケーションで使用します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-264">The UWP XAML hosting API is only intended to be used in non-UWP desktop apps, such as WPF, Windows Forms, and C++ Win32 applications.</span></span> |

### <a name="error-attaching-to-a-window-on-a-different-thread"></a><span data-ttu-id="2a5db-265">別のスレッドで、ウィンドウへのアタッチ エラー</span><span class="sxs-lookup"><span data-stu-id="2a5db-265">Error attaching to a window on a different thread</span></span>

| <span data-ttu-id="2a5db-266">問題</span><span class="sxs-lookup"><span data-stu-id="2a5db-266">Issue</span></span> | <span data-ttu-id="2a5db-267">解決方法</span><span class="sxs-lookup"><span data-stu-id="2a5db-267">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="2a5db-268">アプリが受け取る、 **COMException**次のメッセージ。「AttachToWindow メソッドは、別のスレッドで、指定した HWND が作成されたために失敗しました」。</span><span class="sxs-lookup"><span data-stu-id="2a5db-268">Your app receives a **COMException** with the following message: "AttachToWindow method failed because the specified HWND was created on a different thread."</span></span> | <span data-ttu-id="2a5db-269">このエラーは、アプリケーションと呼ばれることを示します、 **IDesktopWindowXamlSourceNative::AttachToWindow**メソッド別のスレッドが作成されているウィンドウの HWND が渡されます。</span><span class="sxs-lookup"><span data-stu-id="2a5db-269">This error indicates that your application called the **IDesktopWindowXamlSourceNative::AttachToWindow** method and passed it the HWND of a window that was created on a different thread.</span></span> <span data-ttu-id="2a5db-270">このメソッドにコードのメソッドを呼び出すことと同じスレッドが作成されているウィンドウの HWND を渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a5db-270">You must pass this method the HWND of a window that was created on the same thread as the code from which you are calling the method.</span></span> |

### <a name="error-attaching-to-a-window-on-a-different-top-level-window"></a><span data-ttu-id="2a5db-271">別の最上位ウィンドウ上のウィンドウへのアタッチ エラー</span><span class="sxs-lookup"><span data-stu-id="2a5db-271">Error attaching to a window on a different top-level window</span></span>

| <span data-ttu-id="2a5db-272">問題</span><span class="sxs-lookup"><span data-stu-id="2a5db-272">Issue</span></span> | <span data-ttu-id="2a5db-273">解決方法</span><span class="sxs-lookup"><span data-stu-id="2a5db-273">Resolution</span></span> |
|-------|------------|
| <span data-ttu-id="2a5db-274">アプリが受け取る、 **COMException**次のメッセージ。「AttachToWindow メソッドは、同じスレッドで、AttachToWindow に渡された以前 HWND よりも、別の最上位ウィンドウから、指定した HWND が降下ために失敗しました」。</span><span class="sxs-lookup"><span data-stu-id="2a5db-274">Your app receives a **COMException** with the following  message: "AttachToWindow method failed because the specified HWND descends from a different top-level window than the HWND that was previously passed to AttachToWindow on the same thread."</span></span> | <span data-ttu-id="2a5db-275">このエラーは、アプリケーションと呼ばれることを示します、 **IDesktopWindowXamlSourceNative::AttachToWindow**メソッドで指定した期間よりも、別の最上位ウィンドウから下降ウィンドウの HWND を渡し、同じスレッドでは、このメソッドの呼び出し前です。</span><span class="sxs-lookup"><span data-stu-id="2a5db-275">This error indicates that your application called the **IDesktopWindowXamlSourceNative::AttachToWindow** method and passed it the HWND of a window that descends from a different top-level window than a window you specified in a previous call to this method on the same thread.</span></span></p></p><span data-ttu-id="2a5db-276">アプリケーションの呼び出し後**IDesktopWindowXamlSourceNative::AttachToWindow**特定のスレッドで他のすべての[ **DesktopWindowXamlSource** ](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource)同じオブジェクトスレッドは、最初の呼び出しで渡された同じトップレベル ウィンドウの子孫である windows にのみアタッチできます**IDesktopWindowXamlSourceNative::AttachToWindow**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-276">After your application calls **IDesktopWindowXamlSourceNative::AttachToWindow** on a particular thread, all other [**DesktopWindowXamlSource**](https://docs.microsoft.com/uwp/api/windows.ui.xaml.hosting.desktopwindowxamlsource) objects on the same thread can only attach to windows that are descendants of the same top-level window that was passed in the first call to **IDesktopWindowXamlSourceNative::AttachToWindow**.</span></span> <span data-ttu-id="2a5db-277">ときにすべて、 **DesktopWindowXamlSource**オブジェクトは特定のスレッドで、[次へ] を閉じる**DesktopWindowXamlSource**は無料で任意のウィンドウを再度アタッチします。</span><span class="sxs-lookup"><span data-stu-id="2a5db-277">When all the **DesktopWindowXamlSource** objects are closed for a particular thread, the next **DesktopWindowXamlSource** is then free to attach to any window again.</span></span></p></p><span data-ttu-id="2a5db-278">この問題を解決するには、いずれかを閉じますすべて**DesktopWindowXamlSource**このスレッドで他の最上位ウィンドウにバインドされているか、この新しいスレッドを作成するオブジェクト**DesktopWindowXamlSource**します。</span><span class="sxs-lookup"><span data-stu-id="2a5db-278">To resolve this issue, either close all **DesktopWindowXamlSource** objects that are bound to other top-level windows on this thread, or create a new thread for this **DesktopWindowXamlSource**.</span></span> |

## <a name="related-topics"></a><span data-ttu-id="2a5db-279">関連トピック</span><span class="sxs-lookup"><span data-stu-id="2a5db-279">Related topics</span></span>

* [<span data-ttu-id="2a5db-280">デスクトップ アプリケーションでの UWP コントロール</span><span class="sxs-lookup"><span data-stu-id="2a5db-280">UWP controls in desktop applications</span></span>](xaml-islands.md)
* [<span data-ttu-id="2a5db-281">C++Win32 XAML 諸島サンプル</span><span class="sxs-lookup"><span data-stu-id="2a5db-281">C++ Win32 XAML Islands sample</span></span>](https://github.com/marb2000/XamlIslands/blob/master/19H1_Insider_Samples/CppWin32App_With_Island)
